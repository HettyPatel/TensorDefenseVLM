2025-04-20 10:28:18,008 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:28:18,027 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:28:18,031 - tensor_defense - INFO - Loading model: clip vit-b/32
2025-04-20 10:28:18,031 - tensor_defense - ERROR - Error loading model clip vit-b/32: Incorrect path_or_model_id: 'openai/clip-vit-b/32'. Please provide either the path to a local folder or the repo_id of a model on the Hub.
2025-04-20 10:30:53,039 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:30:53,060 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:30:53,063 - tensor_defense - INFO - Loading model: clip vit-b-32
2025-04-20 10:30:53,241 - tensor_defense - ERROR - Error loading model clip vit-b-32: openai/clip-vit-b-32 is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `huggingface-cli login` or by passing `token=<your_token>`
2025-04-20 10:34:44,668 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:34:44,689 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:34:44,692 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:34:47,794 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:34:47,794 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:34:52,460 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:34:52,460 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=2, step_size=0.0235294
2025-04-20 10:34:52,460 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=2
2025-04-20 10:34:52,460 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:34:52,460 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:34:59,896 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:35:00,251 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:35:00,589 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:35:00,951 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:35:01,306 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:35:01,307 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:35:01,591 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:35:01,591 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,591 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,591 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 0.9688
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,592 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,592 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,593 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:35:01,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:01,594 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:01,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,819 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:01,819 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,819 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,820 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,820 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,821 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:35:01,821 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:35:01,821 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:35:01,821 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,821 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,977 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:01,977 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,977 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9844
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Improvement: -1.56%
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,978 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,978 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,978 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:35:01,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:35:01,978 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:35:01,979 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,979 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,103 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,103 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,103 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,103 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,104 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,104 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,105 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,105 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:35:02,105 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,105 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,105 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,105 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,392 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,392 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,392 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,393 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,393 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,393 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:35:02,393 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,393 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,394 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:35:02,394 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,535 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:35:02,535 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,535 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,535 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.9688
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,536 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,536 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,537 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,537 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:35:02,537 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,537 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,537 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:35:02,537 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,671 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:35:02,671 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.9688
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,671 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,672 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,672 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,672 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:35:02,673 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,673 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,673 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:35:02,673 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,817 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,817 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.9688
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,817 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,818 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,818 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,818 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:35:02,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,819 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:35:02,819 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,987 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,988 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.9688
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,988 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,989 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,989 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,989 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:35:02,990 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,232 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:35:03,232 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.9688
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,232 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,233 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,482 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:35:03,836 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:35:03,837 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:35:03,851 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:35:03,852 - tensor_defense - INFO - Experiment completed
2025-04-20 10:38:52,985 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:38:53,006 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:38:53,009 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:38:54,463 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:38:54,464 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:38:55,969 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:38:55,969 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 10:38:55,969 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 10:38:55,969 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:38:55,969 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:39:04,255 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:39:04,592 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:39:04,933 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:39:05,278 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:39:05,624 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:39:05,624 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:39:05,867 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:39:05,867 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Adversarial (With No Defense): 0.9844
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,868 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,868 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:39:05,869 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,869 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,869 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:39:05,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:05,870 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:05,870 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,064 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,064 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,065 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,065 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,066 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,066 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,066 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:39:06,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:39:06,066 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:39:06,066 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,066 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,209 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,209 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,210 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,210 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,211 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,211 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:39:06,211 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:39:06,211 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:39:06,211 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,211 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,348 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,348 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,349 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,349 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,350 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,350 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:39:06,350 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,350 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,350 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,350 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,611 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,613 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,613 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:39:06,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:39:06,613 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,758 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:39:06,758 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,758 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.9688
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Improvement: -1.59%
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,759 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,760 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,760 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,760 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:39:06,760 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,760 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:39:06,761 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,905 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:39:06,905 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.9844
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,906 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,906 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,907 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,907 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:39:06,907 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,907 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,907 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:39:06,908 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,019 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:39:07,019 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.9844
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,019 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,020 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,020 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,020 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:39:07,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:07,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:07,020 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:39:07,020 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,189 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:39:07,189 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.9844
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,190 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,190 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,191 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,191 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:07,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:39:07,191 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,414 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:39:07,415 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.9531
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Improvement: -3.17%
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,415 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,416 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,416 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,416 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,641 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:39:07,998 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:39:07,998 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:39:08,013 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:39:08,015 - tensor_defense - INFO - Experiment completed
2025-04-20 10:43:02,389 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:43:02,403 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:43:02,405 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:43:03,821 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:43:03,821 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:43:05,691 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:43:05,691 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 10:43:05,691 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 10:43:05,691 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:43:05,691 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:43:14,003 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:43:14,345 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:43:14,683 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:43:15,030 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:43:15,396 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:43:15,397 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:43:15,620 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:43:15,620 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,621 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,621 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 10:43:15,622 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,622 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,622 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:43:15,623 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:15,623 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:15,623 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,810 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:15,810 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,810 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:15,811 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:15,812 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:15,813 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:15,813 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,813 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:43:15,813 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:43:15,813 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:43:15,813 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,813 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,977 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:15,977 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:15,978 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 10:43:15,979 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 10:43:15,980 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,980 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:43:15,980 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:43:15,980 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:43:15,980 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,980 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,106 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,106 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:16,107 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2812
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Performance Recovery: 4.44% of the adversarial drop
2025-04-20 10:43:16,108 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 10:43:16,109 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,109 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:43:16,109 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,109 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,109 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,109 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,374 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,374 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,374 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,374 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,375 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 10:43:16,375 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,376 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,376 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:43:16,376 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,376 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,376 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:43:16,376 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,516 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:43:16,516 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:16,516 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,517 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,518 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,518 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:43:16,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,518 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,518 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:43:16,519 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,653 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:43:16,653 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,654 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.3125
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 10:43:16,654 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 10:43:16,655 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,655 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,655 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,655 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:43:16,655 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,655 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,655 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:43:16,655 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,769 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,769 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.2031
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:16,770 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,771 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,771 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,771 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:43:16,771 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,771 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,772 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:43:16,772 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,945 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,945 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,946 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3438
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,946 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,947 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,947 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:43:16,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:43:16,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:43:16,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,948 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:43:16,948 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,210 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:43:17,210 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:17,210 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 10:43:17,211 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3594
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Improvement: 43.75%
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Performance Recovery: 15.56% of the adversarial drop
2025-04-20 10:43:17,212 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,429 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:43:17,788 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:43:17,788 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:43:17,804 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:43:17,805 - tensor_defense - INFO - Experiment completed
2025-04-20 11:10:59,388 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:10:59,403 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:10:59,405 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:11:01,426 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:11:01,426 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:11:02,804 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:11:02,805 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:11:02,805 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:11:02,805 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:11:02,805 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:11:11,133 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:11:11,479 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:11:11,825 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:11:12,178 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:11:12,518 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:11:12,518 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:11:12,716 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:11:12,716 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,716 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,717 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,717 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:11:12,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:12,718 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:12,719 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:12,898 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:12,899 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:12,899 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:12,900 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:11:12,901 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:12,901 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:12,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:12,901 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:11:12,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:11:12,901 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:11:12,901 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:12,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,052 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,052 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:11:13,053 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:11:13,053 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 11:11:13,054 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:11:13,054 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:11:13,054 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,054 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:11:13,054 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:11:13,054 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:11:13,054 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:13,054 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,179 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,179 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,179 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,179 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:13,180 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2969
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:11:13,181 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:11:13,182 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,182 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:11:13,182 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,182 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,182 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:13,182 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,459 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,460 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,461 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:11:13,461 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:11:13,462 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,462 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,462 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,462 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:11:13,462 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,462 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,462 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:11:13,462 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,605 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:11:13,605 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:11:13,605 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:13,606 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,607 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,607 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:11:13,607 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,607 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,607 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:11:13,608 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,746 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:11:13,746 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,747 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.3125
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:11:13,748 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,749 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,749 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,749 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:11:13,749 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,749 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,749 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:11:13,749 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,860 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,860 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,860 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,861 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:13,861 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,862 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,862 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:11:13,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,862 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:11:13,862 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,036 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:11:14,036 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:14,037 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3438
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:14,038 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:14,038 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,039 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:14,039 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:11:14,040 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,268 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:11:14,269 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:11:14,269 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3750
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Improvement: 50.00%
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Performance Recovery: 17.78% of the adversarial drop
2025-04-20 11:11:14,270 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:11:14,271 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:11:14,271 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,493 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:11:14,850 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:11:14,850 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:11:14,864 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:11:14,865 - tensor_defense - INFO - Experiment completed
2025-04-20 11:26:29,636 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:26:29,650 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:26:29,653 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:26:31,074 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:26:31,075 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:26:32,692 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:26:32,693 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:26:32,693 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:26:32,693 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:26:32,693 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:26:41,062 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:26:41,398 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:26:41,733 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:26:42,084 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:26:42,423 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:26:42,424 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:26:42,648 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:26:42,648 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,648 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,649 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,649 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:26:42,650 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:42,650 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:42,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:42,835 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:42,835 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:42,835 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3281
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:26:42,836 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:42,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:42,837 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:26:42,837 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:26:42,837 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:26:42,837 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:42,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:42,999 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:42,999 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,999 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:26:43,000 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:26:43,001 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:26:43,001 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,001 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:26:43,001 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:26:43,002 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:26:43,002 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:43,002 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,133 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,133 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,133 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,133 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:43,134 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2969
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:26:43,135 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:26:43,135 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,135 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:26:43,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,136 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:43,136 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,419 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,419 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,419 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:26:43,420 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,420 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,420 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:26:43,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,421 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,421 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:26:43,421 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,569 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:26:43,569 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2188
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:26:43,570 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:26:43,570 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,571 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,571 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:26:43,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,571 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,572 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:26:43,572 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,712 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:26:43,712 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,713 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.2969
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:26:43,714 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,715 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,715 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:26:43,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,715 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,715 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:26:43,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,821 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,822 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,822 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:26:43,823 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,823 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,823 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:26:43,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,823 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,824 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:26:43,824 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,997 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,997 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,997 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,998 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3281
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:26:43,999 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,999 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,999 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:26:44,000 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,229 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:26:44,230 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:26:44,230 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3750
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Improvement: 50.00%
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Performance Recovery: 17.78% of the adversarial drop
2025-04-20 11:26:44,231 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:26:44,231 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,453 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:26:44,816 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:26:44,816 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:26:44,831 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:26:44,832 - tensor_defense - INFO - Experiment completed
2025-04-20 11:41:03,221 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:41:03,235 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:41:03,237 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:41:05,334 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:41:05,334 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:41:06,922 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:41:06,922 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:41:06,922 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:41:06,922 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:41:06,923 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:41:15,250 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:41:15,589 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:41:15,934 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:41:16,284 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:41:16,626 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:41:16,626 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:41:16,751 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:41:16,751 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:16,751 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:16,752 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:16,752 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:41:16,753 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:16,753 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:16,753 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:16,923 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:16,924 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:16,924 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:41:16,925 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:16,925 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:16,926 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:41:16,926 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:41:16,926 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:41:16,926 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:16,926 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,075 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,075 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:41:17,076 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:41:17,076 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.3906
2025-04-20 11:41:17,077 - tensor_defense - INFO -     Improvement: 4.17%
2025-04-20 11:41:17,077 - tensor_defense - INFO -     Performance Recovery: 2.50% of the adversarial drop
2025-04-20 11:41:17,077 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,077 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:41:17,077 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:41:17,077 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:41:17,077 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:17,077 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,231 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,232 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:17,233 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2812
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Performance Recovery: 4.44% of the adversarial drop
2025-04-20 11:41:17,233 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:41:17,234 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:41:17,234 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,234 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:41:17,234 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,234 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,234 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:17,234 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,496 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,496 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,496 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:17,497 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:41:17,497 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,498 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,498 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:41:17,498 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,498 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,498 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:41:17,498 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,638 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:41:17,638 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:41:17,639 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:41:17,639 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:41:17,640 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,640 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,640 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,640 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:41:17,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,640 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,640 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:41:17,640 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,770 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:41:17,770 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,770 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:17,771 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.2969
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:41:17,772 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,772 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,772 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:41:17,772 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,773 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,773 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:41:17,773 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,889 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,889 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,889 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:17,890 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:41:17,890 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,891 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:41:17,891 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,891 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,891 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,891 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:41:17,891 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,891 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,891 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:41:17,891 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,060 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:41:18,060 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:18,060 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:18,061 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3281
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:41:18,062 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:18,062 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,062 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:41:18,062 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:18,063 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:18,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:18,063 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:41:18,063 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:41:18,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:18,063 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:41:18,063 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,297 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:41:18,298 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2031
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:41:18,298 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3594
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Improvement: 43.75%
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Performance Recovery: 15.56% of the adversarial drop
2025-04-20 11:41:18,299 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:41:18,299 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,299 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,300 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,300 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:41:18,300 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,533 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:41:18,893 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:41:18,894 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:41:18,908 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:41:18,909 - tensor_defense - INFO - Experiment completed
2025-04-20 11:44:21,922 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:44:21,936 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:44:21,939 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:44:23,544 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:44:23,544 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:44:24,998 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:44:24,998 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:44:24,999 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:44:24,999 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:44:24,999 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:47:04,936 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:47:04,968 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:47:04,971 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:47:06,868 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:47:06,868 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:47:10,410 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:47:10,411 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:47:10,411 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:47:10,411 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:47:10,411 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:48:16,778 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:48:16,794 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:48:16,796 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:48:18,732 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:48:18,733 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:48:20,296 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:48:20,297 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:48:20,297 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:48:20,297 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:48:20,297 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:56:37,107 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:56:37,122 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:56:37,124 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:56:38,572 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:56:38,573 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:56:40,641 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:56:40,641 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:56:40,641 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:56:40,641 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:56:40,641 - tensor_defense - INFO - Processing batches...
2025-04-20 11:56:45,090 - tensor_defense - INFO - Processing batch 1/32
2025-04-20 11:56:47,258 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:56:47,602 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:56:47,945 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:56:48,335 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:56:48,688 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:56:48,688 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:56:49,426 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:49,426 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:49,427 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,667 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,668 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:49,668 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:49,668 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,789 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,789 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:49,790 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:49,790 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,790 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,891 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,892 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:49,892 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:49,892 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,892 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,161 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,161 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,162 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,162 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:50,162 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,283 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,283 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,283 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:50,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,402 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,402 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,402 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,402 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:50,402 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,539 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,540 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:50,540 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,680 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,680 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,680 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:50,680 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:50,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:50,681 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:50,681 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:50,681 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,900 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,900 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,900 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,901 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:50,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,941 - tensor_defense - INFO - Processing batch 2/32
2025-04-20 11:56:51,986 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:51,986 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:51,986 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:51,986 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:52,109 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,109 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:52,109 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:52,109 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:52,109 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,235 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,235 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:52,236 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:52,236 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:52,236 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,369 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,369 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,369 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:52,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,569 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,569 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,569 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,570 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:52,570 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,692 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,692 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,692 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,692 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:52,692 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,804 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,805 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,805 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,805 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:52,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,898 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,898 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,898 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,898 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:52,898 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,037 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,037 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:53,038 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:53,038 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:53,038 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:53,038 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:53,038 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:53,038 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:53,038 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,277 - tensor_defense - INFO - Processing batch 3/32
2025-04-20 11:56:54,391 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:54,391 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:54,391 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,391 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:54,514 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,514 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:54,514 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:54,514 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,514 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,629 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,629 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:54,629 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:54,629 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,629 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,739 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:54,739 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:54,739 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,941 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,941 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:54,941 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:54,941 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:54,941 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,071 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,071 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,071 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,071 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:55,071 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,189 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,189 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,189 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,189 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:55,189 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,281 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,281 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,282 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:55,282 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,423 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,424 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,424 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:55,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:55,424 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:55,424 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:55,424 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:55,424 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,662 - tensor_defense - INFO - Processing batch 4/32
2025-04-20 11:56:56,704 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:56,704 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:56,704 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:56,704 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:56,827 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:56,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:56,828 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:56,828 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:56,828 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:56,947 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:56,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:56,947 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:56,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:56,947 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,062 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,063 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,063 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:57,063 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,265 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,265 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,265 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:57,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,388 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,388 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,388 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,388 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:57,388 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,511 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,511 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,511 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,511 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:57,511 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,611 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,611 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,611 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,612 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:57,612 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,751 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,751 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,751 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,751 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:57,752 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:57,752 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:57,752 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:57,752 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:57,752 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:58,010 - tensor_defense - INFO - Processing batch 5/32
2025-04-20 11:56:59,081 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,081 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,081 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,081 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:59,201 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,202 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:59,202 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:59,202 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,202 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,321 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,321 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:59,321 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:59,322 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,322 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,434 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,434 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,435 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,435 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,435 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,636 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,636 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,637 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,637 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:59,637 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,754 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,755 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,755 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:59,755 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,879 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,879 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,879 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,879 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:59,879 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,978 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,978 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,979 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:59,979 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,121 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,121 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:00,121 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:00,121 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:00,121 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:00,122 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:00,122 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:00,122 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:00,122 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:00,339 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,370 - tensor_defense - INFO - Processing batch 6/32
2025-04-20 11:57:01,374 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:01,374 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:01,374 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,374 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:01,497 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,497 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:01,497 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:01,497 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,497 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:01,618 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:01,618 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,728 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,729 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:01,729 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:01,729 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,729 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,930 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:01,931 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:01,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:01,931 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,060 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,060 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:02,060 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,199 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,200 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,200 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:02,200 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,311 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,311 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,311 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,311 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:02,312 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,448 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,448 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,449 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,449 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:02,449 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:02,449 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:02,449 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:02,449 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:02,449 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,720 - tensor_defense - INFO - Processing batch 7/32
2025-04-20 11:57:03,768 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:03,768 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:03,768 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:03,769 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:03,895 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:03,895 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:03,895 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:03,895 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:03,896 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,014 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,014 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:04,014 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:04,014 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,015 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,124 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,124 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,124 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,125 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,125 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,326 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,326 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,326 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:04,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,446 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:04,447 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,566 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,566 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,566 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,566 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:04,567 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,676 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,676 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,677 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,677 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:04,677 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,818 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,818 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:04,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:04,819 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,819 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:04,819 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,049 - tensor_defense - INFO - Processing batch 8/32
2025-04-20 11:57:06,091 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,092 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,092 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,092 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:06,214 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,214 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:06,214 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:06,215 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,215 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,308 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,308 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:06,308 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:06,308 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,308 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,410 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,410 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,410 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,410 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,411 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,616 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,616 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,616 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,616 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:06,617 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,735 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,736 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,736 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,736 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:06,736 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,858 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,858 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,859 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,859 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:06,859 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,948 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,948 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:06,949 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,094 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,094 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:07,094 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:07,094 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:07,095 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:07,095 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:07,095 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:07,095 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:07,095 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,310 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,310 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,310 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,311 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:07,311 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,371 - tensor_defense - INFO - Processing batch 9/32
2025-04-20 11:57:08,380 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:08,380 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:08,380 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,380 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:08,506 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,507 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:08,507 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:08,507 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,507 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,631 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,631 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:08,632 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:08,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,632 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,744 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,744 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:08,744 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:08,745 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,745 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,944 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,944 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:08,945 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:08,945 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:08,945 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,065 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,065 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,065 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,065 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:09,066 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,186 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,186 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:09,186 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,286 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,286 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,286 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:09,287 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,430 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,430 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,430 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,430 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:09,430 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:09,431 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:09,431 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:09,431 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:09,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,669 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:09,669 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,695 - tensor_defense - INFO - Processing batch 10/32
2025-04-20 11:57:10,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:10,706 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:10,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:10,706 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:10,827 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:10,827 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:10,827 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:10,827 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:10,827 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:10,942 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:10,942 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:10,942 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:10,942 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:10,943 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,080 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,081 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,081 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,081 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:11,081 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,280 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,281 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,281 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,281 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:11,281 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,397 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:11,398 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,518 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,519 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,519 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:11,519 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,618 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,618 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:11,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,775 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:11,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:11,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:11,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:11,776 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:11,776 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:11,994 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:12,009 - tensor_defense - INFO - Processing batch 11/32
2025-04-20 11:57:12,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:12,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:12,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:12,990 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:13,111 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,112 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:13,112 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:13,112 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:13,112 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,231 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,231 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:13,232 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:13,232 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:13,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,326 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,326 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,326 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:13,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,529 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,530 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,530 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,530 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:13,530 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,653 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,653 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,653 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,653 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:13,654 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,775 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,775 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,776 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:13,776 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,861 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,861 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:13,861 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,006 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,006 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:14,007 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:14,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:14,007 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:14,007 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:14,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:14,007 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:14,007 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,225 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,239 - tensor_defense - INFO - Processing batch 12/32
2025-04-20 11:57:15,221 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,221 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,221 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,221 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:15,344 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,344 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:15,345 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:15,345 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,345 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,468 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,469 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:15,469 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:15,469 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,469 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,578 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,578 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,579 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,579 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,579 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,779 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,779 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,779 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:15,780 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,901 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,901 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:15,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,021 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,021 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:16,021 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:16,021 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:16,021 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,119 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,119 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:16,119 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:16,119 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:16,119 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,262 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,262 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:16,263 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:16,263 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:16,263 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:16,263 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:16,263 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:16,263 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:16,263 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:16,483 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,537 - tensor_defense - INFO - Processing batch 13/32
2025-04-20 11:57:17,530 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:17,531 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:17,531 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,531 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:17,660 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,660 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:17,660 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:17,660 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,661 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,782 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:17,783 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:17,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,783 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,887 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,887 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:17,887 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:17,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,887 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,093 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,094 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,094 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,094 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:18,094 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,213 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,213 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,214 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,214 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:18,214 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,336 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,336 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,336 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,336 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:18,337 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,444 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,444 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,444 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,444 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:18,445 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,584 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,584 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:18,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:18,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:18,585 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:18,585 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:18,585 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,804 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,830 - tensor_defense - INFO - Processing batch 14/32
2025-04-20 11:57:19,881 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:19,882 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:19,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:19,882 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:20,002 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,003 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:20,003 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:20,003 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,003 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,131 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,132 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:20,132 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:20,132 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,132 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,235 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,235 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,235 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,235 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,235 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,434 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,435 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,435 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,435 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:20,435 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,579 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,579 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,579 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,579 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:20,579 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,698 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,698 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,698 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,698 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:20,699 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,790 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,790 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,790 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,790 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:20,790 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,930 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,930 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,930 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:20,931 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:20,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,931 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:20,931 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:21,148 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,166 - tensor_defense - INFO - Processing batch 15/32
2025-04-20 11:57:22,244 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,244 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,244 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,244 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:22,363 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:22,364 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:22,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,364 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,487 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:22,487 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:22,487 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,596 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,596 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,596 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,596 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,596 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,796 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,797 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:22,797 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,920 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,920 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,920 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,920 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:22,920 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,046 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:23,046 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:23,046 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:23,047 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,143 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,144 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:23,144 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:23,144 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:23,144 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,281 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,281 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:23,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:23,282 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:23,282 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:23,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:23,282 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:23,282 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:23,282 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,517 - tensor_defense - INFO - Processing batch 16/32
2025-04-20 11:57:24,490 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:24,490 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:24,490 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,490 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:24,615 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,616 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:24,616 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:24,616 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,616 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,739 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:24,739 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:24,739 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:24,850 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:24,850 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,850 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,051 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,051 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,051 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,051 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:25,051 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,171 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,171 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,171 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,172 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:25,172 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,287 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,287 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:25,287 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,385 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,385 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,385 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,385 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:25,385 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,527 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,527 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,527 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,527 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:25,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:25,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:25,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:25,528 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:25,528 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,744 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,744 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,745 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,745 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:25,745 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,800 - tensor_defense - INFO - Processing batch 17/32
2025-04-20 11:57:26,796 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:26,797 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:26,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:26,797 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:26,923 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:26,923 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:26,923 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:26,923 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:26,923 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,047 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,047 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:27,048 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:27,048 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,048 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,155 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,156 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,156 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,156 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,156 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,364 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,364 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,364 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:27,364 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,487 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,488 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,488 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:27,488 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,607 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,607 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,607 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,607 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:27,607 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,715 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,716 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:27,716 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,858 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,858 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,858 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,858 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,858 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:27,858 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:27,858 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,858 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:27,858 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,103 - tensor_defense - INFO - Processing batch 18/32
2025-04-20 11:57:29,119 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,119 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,119 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,119 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:29,246 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,246 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:29,246 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:29,247 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,247 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,368 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,369 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:29,369 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:29,369 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,480 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,481 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,481 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,481 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,481 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,686 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,686 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,686 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,686 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:29,687 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,810 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,810 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,810 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,810 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:29,811 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,926 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,927 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,927 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,927 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:29,927 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,021 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,021 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:30,021 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:30,021 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:30,022 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,159 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,159 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:30,159 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:30,159 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:30,160 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:30,160 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:30,160 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:30,160 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:30,160 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,387 - tensor_defense - INFO - Processing batch 19/32
2025-04-20 11:57:31,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:31,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:31,465 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,465 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:31,593 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,593 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:31,594 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:31,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,594 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,710 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,710 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:31,710 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:31,710 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,710 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,812 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:31,812 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:31,812 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,010 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,010 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,010 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,010 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:32,010 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,127 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,127 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,127 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,127 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:32,127 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,251 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,251 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,251 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,251 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:32,251 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,350 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,351 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,351 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,351 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:32,351 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,488 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,489 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,489 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,489 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:32,489 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:32,489 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:32,489 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:32,489 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:32,489 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,722 - tensor_defense - INFO - Processing batch 20/32
2025-04-20 11:57:33,716 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:33,716 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:33,716 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:33,716 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:33,842 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:33,842 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:33,842 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:33,842 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:33,842 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:33,949 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:33,949 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:33,949 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:33,949 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:33,949 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,051 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,052 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,052 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,052 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:34,052 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,251 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,252 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,252 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,252 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:34,252 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,366 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,367 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,367 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,367 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:34,367 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,487 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,487 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,487 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:34,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,601 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,602 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,602 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:34,602 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,743 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,743 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,743 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,743 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:34,743 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:34,743 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:34,743 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:34,743 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:34,743 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:35,012 - tensor_defense - INFO - Processing batch 21/32
2025-04-20 11:57:36,017 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,017 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,017 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,017 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:36,136 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:36,136 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:36,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,137 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,257 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,257 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:36,257 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:36,258 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,368 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,368 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,368 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,368 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,569 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,569 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,569 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,569 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:36,569 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,691 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,691 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,691 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:36,691 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,814 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,814 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,814 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,814 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:36,814 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,912 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,912 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,913 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,913 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:36,913 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,063 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,063 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:37,063 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:37,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:37,064 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:37,064 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:37,064 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:37,064 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:37,064 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,306 - tensor_defense - INFO - Processing batch 22/32
2025-04-20 11:57:38,317 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,317 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,317 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,317 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:38,437 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,437 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:38,438 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:38,438 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,438 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,559 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,560 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:38,560 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:38,560 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,560 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,670 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,671 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,671 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,671 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,870 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,870 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,871 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:38,871 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,989 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:38,990 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,110 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,110 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:39,110 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:39,110 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:39,110 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,217 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,218 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:39,218 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:39,218 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:39,218 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,378 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,378 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:39,379 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:39,379 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:39,379 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:39,379 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:39,379 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:39,379 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:39,379 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,602 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:39,602 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,618 - tensor_defense - INFO - Processing batch 23/32
2025-04-20 11:57:40,634 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:40,634 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:40,634 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,634 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:40,757 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,757 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:40,757 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:40,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,757 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,880 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,880 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:40,880 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:40,880 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,880 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,991 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,991 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:40,991 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:40,991 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,991 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:41,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,313 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,313 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,314 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,314 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:41,314 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,433 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,433 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,433 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,434 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:41,434 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,547 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,547 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,547 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,547 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:41,547 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,690 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,690 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,690 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:41,691 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:41,691 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:41,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:41,691 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:41,691 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,908 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,924 - tensor_defense - INFO - Processing batch 24/32
2025-04-20 11:57:42,942 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:42,943 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:42,943 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:42,943 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:43,068 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,068 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:43,068 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:43,068 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,068 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,195 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,195 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:43,195 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:43,195 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,196 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,294 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,294 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,294 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,294 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,499 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,499 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,499 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:43,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,619 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,619 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,619 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,619 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:43,619 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,748 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,748 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,748 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,748 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:43,748 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,844 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,845 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,845 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,845 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:43,845 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,988 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,988 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:43,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:43,989 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,989 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:43,989 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,264 - tensor_defense - INFO - Processing batch 25/32
2025-04-20 11:57:45,274 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,275 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,275 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,275 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:45,401 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,401 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:45,401 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:45,401 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,401 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,511 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,511 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:45,511 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:45,511 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,512 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,639 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,639 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,639 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,639 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,639 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,846 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,846 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,846 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,846 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:45,846 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,974 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,974 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,974 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,974 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:45,974 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,092 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,092 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:46,092 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:46,092 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:46,092 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,190 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,190 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:46,190 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:46,190 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:46,190 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,327 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,328 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:46,328 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:46,328 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:46,328 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:46,328 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:46,328 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:46,328 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:46,328 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,573 - tensor_defense - INFO - Processing batch 26/32
2025-04-20 11:57:47,592 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:47,593 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:47,593 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,593 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:47,718 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,719 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:47,719 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:47,719 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,719 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,837 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:47,837 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:47,837 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,838 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,940 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,940 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:47,941 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:47,941 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,941 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:48,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,261 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,261 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,261 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,261 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:48,261 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,383 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,384 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,384 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,384 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:48,384 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,493 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,493 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,493 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,494 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:48,494 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,632 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:48,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:48,633 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:48,633 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:48,633 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:48,633 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,865 - tensor_defense - INFO - Processing batch 27/32
2025-04-20 11:57:49,920 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:49,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:49,921 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:49,921 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:50,041 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,042 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:50,042 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:50,042 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,042 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,164 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,164 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:50,164 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:50,164 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,164 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,265 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,265 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,265 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,469 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,470 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,470 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:50,470 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,591 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,591 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,591 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,591 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:50,591 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,715 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,716 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:50,716 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,811 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,812 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,812 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,812 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:50,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,947 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:50,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:50,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,947 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:50,948 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,182 - tensor_defense - INFO - Processing batch 28/32
2025-04-20 11:57:52,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,186 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,186 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:52,305 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,305 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:52,305 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:52,305 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,305 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,422 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,423 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:52,423 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:52,423 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,423 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,528 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,528 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,528 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,731 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,731 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,732 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,732 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:52,732 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,849 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,850 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:52,850 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,966 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,966 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,966 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,966 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:52,966 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,064 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,064 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:53,064 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:53,065 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:53,065 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,206 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:53,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:53,207 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:53,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:53,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:53,207 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:53,207 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:53,207 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,468 - tensor_defense - INFO - Processing batch 29/32
2025-04-20 11:57:54,515 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:54,516 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:54,516 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,516 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:54,637 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:54,638 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:54,638 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,638 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,758 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:54,759 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:54,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,759 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,870 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:54,870 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:54,870 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,870 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,073 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,073 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,073 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,073 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:55,073 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:55,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,319 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,319 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,319 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,319 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:55,319 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,411 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,411 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,411 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:55,411 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,552 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,553 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,553 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,553 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:55,553 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:55,553 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:55,553 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:55,553 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:55,553 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,797 - tensor_defense - INFO - Processing batch 30/32
2025-04-20 11:57:56,784 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:56,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:56,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:56,785 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:56,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:56,909 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:56,909 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:56,909 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:56,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,029 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,030 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:57,030 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:57,030 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,030 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,125 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,125 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,125 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,125 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,125 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,329 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,329 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,329 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,329 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:57,329 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,454 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,454 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,454 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,454 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:57,454 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,566 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,566 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,566 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,566 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:57,566 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,669 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,670 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,670 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:57,670 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,811 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,811 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,811 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:57,811 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:57,811 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,812 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:57,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,028 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,028 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,029 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,029 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:58,029 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,046 - tensor_defense - INFO - Processing batch 31/32
2025-04-20 11:57:59,106 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,106 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,106 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,106 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:59,230 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,230 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:59,230 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:59,230 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,230 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,355 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:59,355 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:59,355 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,355 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,470 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,470 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,470 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,470 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,674 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,674 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,674 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,675 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:59,675 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,801 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:59,801 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,936 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,936 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,936 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,936 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:59,936 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,050 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,050 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:00,050 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:00,050 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:58:00,050 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,192 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,192 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:00,192 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:00,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,193 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:58:00,193 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:58:00,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,193 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:58:00,193 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,427 - tensor_defense - INFO - Processing batch 32/32
2025-04-20 11:58:00,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:00,828 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:00,828 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,829 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:58:00,954 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,954 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:58:00,954 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:58:00,954 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,954 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,035 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,035 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:58:01,035 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:58:01,035 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,035 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,142 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,240 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,240 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,240 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,240 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:58:01,240 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,345 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,345 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,345 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,345 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:58:01,345 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,448 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,448 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,448 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,448 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:58:01,448 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,550 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,551 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,551 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,551 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:58:01,551 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,675 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,675 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,675 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,675 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,675 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:58:01,675 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:58:01,675 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,675 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:58:01,675 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:02,577 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 11:58:02,735 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:06,335 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:00:06,351 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:00:06,353 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:00:07,887 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:00:07,887 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 12:00:09,873 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 12:00:09,874 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:00:09,874 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:00:09,874 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:00:09,874 - tensor_defense - INFO - Processing batches...
2025-04-20 12:00:14,183 - tensor_defense - INFO - Processing batch 1/32
2025-04-20 12:00:15,973 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:00:16,316 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:00:16,663 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:00:17,018 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:00:17,366 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:00:17,367 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:00:17,441 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:17,442 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:17,442 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,615 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:17,616 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:17,616 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,616 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,746 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,746 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:17,746 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:17,746 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,746 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,857 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,857 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:17,857 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:17,857 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,857 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,066 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,067 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:18,067 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,187 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,187 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,187 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,187 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:18,187 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,305 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,306 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,306 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:18,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,410 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,410 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,410 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:18,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,547 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:18,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:18,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:18,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:18,548 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:18,548 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,828 - tensor_defense - INFO - Processing batch 2/32
2025-04-20 12:00:19,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:19,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:19,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:19,861 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:19,986 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:19,987 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:19,987 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:19,987 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:19,987 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,106 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:20,106 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:20,106 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,211 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,211 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,211 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,411 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,411 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:20,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,527 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,527 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,527 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:20,527 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,649 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,650 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,650 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:20,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,753 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,753 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,753 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,753 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:20,753 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,892 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,893 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,893 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:20,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:20,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,893 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:20,893 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,122 - tensor_defense - INFO - Processing batch 3/32
2025-04-20 12:00:22,241 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,241 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,241 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,241 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:22,378 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,378 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:22,378 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:22,378 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,378 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,495 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,495 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:22,495 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:22,495 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,495 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,599 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,599 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,600 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,600 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,600 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,800 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:22,801 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,923 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,923 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,923 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,923 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:22,923 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,043 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,043 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:23,044 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:23,044 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:23,044 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,146 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,146 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:23,146 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:23,146 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:23,146 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,285 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,285 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:23,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:23,286 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:23,286 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:23,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:23,286 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:23,286 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:23,286 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,516 - tensor_defense - INFO - Processing batch 4/32
2025-04-20 12:00:24,545 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:24,545 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:24,545 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,545 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:24,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:24,670 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:24,670 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,777 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:24,777 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:24,777 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,887 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:24,887 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:24,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,087 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,087 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,088 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,088 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:25,088 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,211 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,211 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,211 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:25,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,329 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,329 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,329 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,329 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:25,329 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,431 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,432 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,432 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,432 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:25,432 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,571 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,571 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,571 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:25,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:25,572 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:25,572 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:25,572 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:25,572 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,789 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,789 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,790 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,790 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:25,790 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,812 - tensor_defense - INFO - Processing batch 5/32
2025-04-20 12:00:26,891 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:26,891 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:26,891 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:26,891 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:27,013 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,013 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:27,013 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:27,013 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,014 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,136 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:27,136 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:27,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,137 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,241 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,241 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,241 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,241 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,242 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,445 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,446 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,446 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,446 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:27,446 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,567 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,567 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,568 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,568 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:27,568 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,681 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,681 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,681 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,681 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:27,681 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,775 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:27,775 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,917 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,917 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,917 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,917 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,917 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:27,917 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:27,917 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,918 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:27,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:28,163 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,222 - tensor_defense - INFO - Processing batch 6/32
2025-04-20 12:00:29,210 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,210 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,210 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,210 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:29,332 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,332 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:29,333 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:29,333 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,333 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:29,447 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:29,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,552 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,552 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,552 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,552 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,758 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,758 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,758 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,758 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:29,759 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,880 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,881 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,881 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,881 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:29,881 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,008 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,008 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:30,009 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:30,009 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:30,009 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,100 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:30,100 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:30,100 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:30,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,240 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:30,240 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:30,240 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:30,241 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:30,241 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:30,241 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:30,241 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:30,241 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,452 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,452 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,452 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,453 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:30,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,469 - tensor_defense - INFO - Processing batch 7/32
2025-04-20 12:00:31,513 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:31,513 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:31,513 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,513 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:31,636 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,636 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:31,637 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:31,637 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,637 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,759 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:31,760 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:31,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,760 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,872 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,872 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:31,872 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:31,872 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,872 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,074 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,075 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,075 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,075 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:32,075 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,193 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,193 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,193 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:32,193 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,311 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,311 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,311 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,311 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:32,311 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,410 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,410 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,410 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:32,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,549 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,549 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,549 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,549 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:32,549 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:32,550 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:32,550 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:32,550 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:32,550 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,776 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,804 - tensor_defense - INFO - Processing batch 8/32
2025-04-20 12:00:33,836 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:33,836 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:33,836 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:33,836 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:33,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:33,957 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:33,958 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:33,958 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:33,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,069 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,069 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:34,069 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:34,069 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,070 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,170 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,170 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,170 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,372 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,372 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,372 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,372 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:34,372 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,490 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,490 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,490 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,490 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:34,491 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,610 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,611 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,611 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,611 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:34,611 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,718 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,718 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,718 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:34,718 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,862 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:34,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:34,862 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,862 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:34,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,072 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,090 - tensor_defense - INFO - Processing batch 9/32
2025-04-20 12:00:36,102 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,103 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,103 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,103 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:36,224 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,224 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:36,224 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:36,224 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,224 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,341 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,341 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:36,342 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:36,342 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,342 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,450 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,450 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,450 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,450 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,450 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,654 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,654 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,654 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:36,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,774 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:36,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,896 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,896 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,896 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,896 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:36,896 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,990 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:36,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,133 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,133 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:37,133 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:37,133 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:37,134 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:37,134 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:37,134 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:37,134 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:37,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,440 - tensor_defense - INFO - Processing batch 10/32
2025-04-20 12:00:38,444 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:38,445 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:38,445 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,445 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:38,566 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,566 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:38,566 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:38,566 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,566 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,692 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,692 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:38,692 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:38,692 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,692 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,797 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:38,797 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:38,798 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,798 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,999 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,999 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:38,999 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:38,999 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:39,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,114 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,115 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:39,115 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,236 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,236 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,236 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,236 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:39,236 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,341 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,341 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,342 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,342 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:39,342 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,500 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,500 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,500 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,500 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:39,501 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:39,501 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:39,501 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:39,501 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:39,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,738 - tensor_defense - INFO - Processing batch 11/32
2025-04-20 12:00:40,720 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:40,720 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:40,720 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:40,720 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:40,843 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:40,843 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:40,843 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:40,843 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:40,843 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:40,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:40,962 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:40,962 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:40,962 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:40,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,086 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,086 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,086 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,086 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:41,086 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,288 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:41,288 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,409 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,409 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:41,409 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,528 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:41,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,624 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,625 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,625 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,625 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:41,625 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,762 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,762 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,762 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,762 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:41,762 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:41,762 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:41,763 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:41,763 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:41,763 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,970 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,994 - tensor_defense - INFO - Processing batch 12/32
2025-04-20 12:00:42,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:42,975 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:42,975 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:42,975 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:43,098 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,098 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:43,098 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:43,098 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:43,098 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,219 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,220 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:43,220 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:43,220 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:43,220 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,314 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,314 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,315 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,315 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:43,315 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,513 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,513 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,513 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,514 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:43,514 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,629 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,629 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,629 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,630 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:43,630 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,754 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,755 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,755 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:43,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,859 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,859 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,859 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:43,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,999 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:44,000 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:44,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,229 - tensor_defense - INFO - Processing batch 13/32
2025-04-20 12:00:45,227 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,227 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,227 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,227 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:45,349 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,349 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:45,349 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:45,349 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,349 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,470 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,471 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:45,471 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:45,471 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,471 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,593 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,593 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,594 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,594 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,798 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,798 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,799 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,799 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:45,799 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:45,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,040 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,040 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:46,040 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:46,041 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:46,041 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,141 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:46,141 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:46,141 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:46,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,280 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,280 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:46,280 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:46,280 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:46,280 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:46,281 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:46,281 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:46,281 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:46,281 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,482 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,482 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,483 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,483 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:46,483 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,535 - tensor_defense - INFO - Processing batch 14/32
2025-04-20 12:00:47,578 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:47,578 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:47,578 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,578 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:47,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:47,706 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:47,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,817 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,817 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:47,817 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:47,817 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,817 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:47,916 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:47,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,118 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,119 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,119 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,119 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:48,119 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,237 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,237 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,237 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:48,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,355 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,356 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:48,356 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,448 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,448 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:48,448 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,586 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:48,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:48,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:48,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:48,587 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:48,587 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,826 - tensor_defense - INFO - Processing batch 15/32
2025-04-20 12:00:49,898 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:49,898 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:49,898 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:49,898 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:50,020 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:50,021 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:50,021 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,021 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,139 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,139 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:50,139 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:50,139 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,139 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,243 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,243 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,243 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,243 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,243 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:50,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,568 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,568 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,569 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,569 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:50,569 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,694 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,694 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,694 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,694 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:50,694 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,786 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,786 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,786 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,787 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:50,787 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,934 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,934 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:50,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:50,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,934 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:50,934 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,176 - tensor_defense - INFO - Processing batch 16/32
2025-04-20 12:00:52,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,147 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,147 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:52,269 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,269 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:52,269 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:52,270 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,270 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,390 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,390 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:52,390 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:52,390 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,391 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,500 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,500 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,500 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,500 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,705 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,706 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:52,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,825 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,825 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,825 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,825 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:52,825 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,945 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,945 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,945 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,945 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:52,945 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,051 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,051 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:53,051 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:53,051 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:53,051 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,192 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,192 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:53,192 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:53,192 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:53,192 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:53,193 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:53,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:53,193 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:53,193 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,400 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,413 - tensor_defense - INFO - Processing batch 17/32
2025-04-20 12:00:54,416 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:54,416 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:54,416 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,416 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:54,546 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,547 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:54,547 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:54,547 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,547 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:54,670 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:54,670 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:54,779 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:54,779 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,980 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,980 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:54,980 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:54,980 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:54,980 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,117 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,118 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,118 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,118 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:55,118 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,239 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,239 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,239 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,239 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:55,239 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,339 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,339 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,339 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,339 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:55,339 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,475 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,475 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,476 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:55,476 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:55,476 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:55,476 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:55,476 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:55,476 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,758 - tensor_defense - INFO - Processing batch 18/32
2025-04-20 12:00:56,765 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:56,765 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:56,765 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:56,765 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:56,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:56,887 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:56,887 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:56,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:56,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,007 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,007 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:57,007 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:57,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,007 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,109 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,109 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,109 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,109 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,109 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,312 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,312 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,312 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,313 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:57,313 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,431 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,432 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,432 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,432 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:57,432 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,546 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,547 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,547 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,547 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:57,547 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,645 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,645 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,645 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:57,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,791 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,791 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,791 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,791 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,792 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:57,792 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:57,792 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,792 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:57,792 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,010 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,010 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,010 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,011 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:58,011 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,026 - tensor_defense - INFO - Processing batch 19/32
2025-04-20 12:00:59,103 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,103 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,104 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,104 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:59,231 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,231 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:59,231 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:59,231 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,231 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,354 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:59,355 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:59,355 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,474 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,474 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,474 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,474 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,474 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,676 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,676 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,676 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,676 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:59,676 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:59,801 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,920 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,921 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,921 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:59,921 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,011 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,011 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:00,012 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:00,012 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:00,012 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,154 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:00,155 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:00,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:00,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:00,155 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:00,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:00,155 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:00,155 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,416 - tensor_defense - INFO - Processing batch 20/32
2025-04-20 12:01:01,402 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:01,403 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:01,403 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,403 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:01,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,526 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:01,526 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:01,526 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,650 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:01,650 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:01,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:01,757 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:01,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,757 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,953 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,953 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:01,954 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:01,954 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:01,954 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,070 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,070 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,070 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,070 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:02,070 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,189 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,190 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,190 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,190 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:02,190 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,290 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,290 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:02,291 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,429 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,429 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,429 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,429 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:02,430 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:02,430 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:02,430 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:02,430 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:02,430 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,671 - tensor_defense - INFO - Processing batch 21/32
2025-04-20 12:01:03,681 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:03,681 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:03,681 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:03,681 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:03,812 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:03,813 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:03,813 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:03,813 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:03,813 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:03,924 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:03,924 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:03,924 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:03,924 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:03,925 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,040 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,040 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,040 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,041 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:04,041 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,246 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,246 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:04,246 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,363 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,363 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:04,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,485 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,485 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,485 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:04,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,589 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,589 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,589 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:04,589 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,726 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,726 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,727 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,727 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:04,727 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:04,727 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:04,727 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:04,727 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:04,727 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:04,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:05,017 - tensor_defense - INFO - Processing batch 22/32
2025-04-20 12:01:06,026 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,027 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,027 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,027 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:06,148 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,149 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:06,149 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:06,149 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,268 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,268 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:06,269 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:06,269 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,269 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,380 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,380 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,380 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,380 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,380 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,582 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,582 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,583 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,583 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:06,583 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,702 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,702 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,702 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,702 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:06,702 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,815 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,816 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,816 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:06,816 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,909 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,909 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,909 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:06,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,042 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,042 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:07,042 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:07,042 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:07,043 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:07,043 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:07,043 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:07,043 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:07,043 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,271 - tensor_defense - INFO - Processing batch 23/32
2025-04-20 12:01:08,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,290 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,290 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:08,406 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,407 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:08,407 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:08,407 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,407 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,523 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,524 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:08,524 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:08,524 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,626 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,626 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,626 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,626 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,627 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,832 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,832 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,832 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,833 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:08,833 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,947 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:08,948 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,066 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,067 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:09,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:09,067 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:09,067 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,168 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,169 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:09,169 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:09,169 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:09,169 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,310 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,310 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:09,310 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:09,310 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:09,310 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:09,310 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:09,310 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:09,310 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:09,311 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,549 - tensor_defense - INFO - Processing batch 24/32
2025-04-20 12:01:10,559 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:10,559 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:10,559 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,559 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:10,686 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,686 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:10,686 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:10,686 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,686 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,806 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:10,807 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:10,807 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,807 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,911 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,912 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:10,912 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:10,912 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,912 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,113 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,114 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,114 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:11,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,234 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,234 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,235 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,235 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:11,235 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,353 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,353 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,353 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,353 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:11,354 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,447 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:11,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,587 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:11,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:11,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:11,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:11,587 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:11,587 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,805 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,820 - tensor_defense - INFO - Processing batch 25/32
2025-04-20 12:01:12,840 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:12,840 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:12,840 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:12,840 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:12,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:12,958 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:12,958 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:12,958 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:12,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,080 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,080 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:13,080 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:13,080 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,081 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,209 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,209 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,209 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,209 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,209 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,414 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,414 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,414 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,414 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:13,414 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:13,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,686 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,687 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,687 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,687 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:13,687 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,779 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,779 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:13,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,918 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,918 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,918 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,918 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:13,918 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:13,918 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,918 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:13,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,186 - tensor_defense - INFO - Processing batch 26/32
2025-04-20 12:01:15,196 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,196 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,197 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,197 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:15,320 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,320 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:15,320 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:15,320 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,320 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,438 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,438 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:15,438 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:15,438 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,438 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,533 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,534 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,534 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,534 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,534 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,737 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,738 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,738 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,738 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:15,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:15,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,985 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,985 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,986 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,986 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:15,986 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,079 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,080 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:16,080 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:16,080 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:16,080 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,218 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,218 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:16,218 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:16,218 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:16,218 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:16,219 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:16,219 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:16,219 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:16,219 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,427 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,442 - tensor_defense - INFO - Processing batch 27/32
2025-04-20 12:01:17,496 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:17,496 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:17,496 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,497 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:17,616 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,617 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:17,617 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:17,617 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,617 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,738 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:17,738 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:17,738 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,853 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,853 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:17,853 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:17,853 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,853 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,056 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,056 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,056 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,056 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:18,057 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,179 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,179 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,179 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,179 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:18,179 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,302 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,302 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,303 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,303 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:18,303 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,404 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,404 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,404 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,404 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:18,404 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,544 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,544 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,544 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,544 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:18,544 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:18,544 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:18,545 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:18,545 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:18,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,785 - tensor_defense - INFO - Processing batch 28/32
2025-04-20 12:01:19,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:19,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:19,774 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:19,774 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:19,898 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:19,898 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:19,898 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:19,898 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:19,898 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,018 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,019 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:20,019 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:20,019 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,019 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,122 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,122 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,122 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,122 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,122 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,325 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,326 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,326 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,326 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:20,326 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,440 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,440 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,440 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,441 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:20,441 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,554 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,554 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,554 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,554 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:20,554 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,643 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,643 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,643 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:20,643 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,782 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,782 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:20,783 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:20,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,783 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:20,783 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:21,010 - tensor_defense - INFO - Processing batch 29/32
2025-04-20 12:01:22,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,060 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,060 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:22,184 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,184 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:22,184 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:22,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,184 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:22,306 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:22,306 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,420 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,420 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,420 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,420 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,624 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,625 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,625 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,625 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:22,625 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,738 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,738 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,738 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:22,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,862 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:22,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,962 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,962 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,962 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:22,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,111 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,111 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:23,111 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:23,111 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:23,111 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:23,111 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:23,112 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:23,112 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:23,112 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,382 - tensor_defense - INFO - Processing batch 30/32
2025-04-20 12:01:24,377 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:24,377 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:24,377 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,377 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:24,518 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:24,518 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:24,518 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,518 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,645 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:24,645 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:24,645 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:24,756 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:24,756 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,961 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,961 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:24,961 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:24,962 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:24,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,079 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,079 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,080 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,080 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:25,080 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,203 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,203 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,203 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,203 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:25,204 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,316 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,316 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,316 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:25,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,453 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,453 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,453 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:25,453 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:25,453 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:25,453 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:25,454 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:25,454 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:25,662 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,677 - tensor_defense - INFO - Processing batch 31/32
2025-04-20 12:01:26,740 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:26,740 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:26,740 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:26,740 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:26,866 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:26,867 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:26,867 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:26,867 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:26,867 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:26,986 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:26,987 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:26,987 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:26,987 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:26,987 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,100 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,101 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,101 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:27,101 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,303 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,304 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,304 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,304 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:27,304 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,424 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,424 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,424 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:27,425 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,538 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,538 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,538 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,538 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:27,538 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,640 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,641 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,641 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:27,641 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,783 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:27,784 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:27,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:27,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:27,784 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:27,784 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,999 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,021 - tensor_defense - INFO - Processing batch 32/32
2025-04-20 12:01:28,398 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,398 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,398 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,399 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:28,507 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,507 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:28,507 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:28,507 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,508 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,593 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,593 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:28,593 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:28,593 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,593 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,700 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,700 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,701 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,701 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,800 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,800 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:28,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,909 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,909 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,909 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:28,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,016 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:29,016 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:29,016 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:29,016 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,117 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,117 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:29,117 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:29,117 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:29,117 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:29,245 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:29,245 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:29,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:29,245 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:29,245 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:29,245 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:29,246 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:30,162 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:01:30,334 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:55,222 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:01:55,238 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:01:55,241 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:01:57,413 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:01:57,413 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:01:58,895 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:01:58,895 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:01:58,896 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:01:58,896 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:01:58,896 - tensor_defense - INFO - Processing batches...
2025-04-20 12:02:03,455 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:02:05,306 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:02:05,649 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:02:05,991 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:02:06,345 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:02:06,690 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:02:06,691 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:02:06,766 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:06,766 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:06,766 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:06,932 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:06,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:06,933 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:06,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:06,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,061 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,062 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:07,062 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:07,062 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,062 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,167 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,167 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,167 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,167 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,377 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,377 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,377 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,378 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:07,378 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,492 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,493 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,493 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,493 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:07,493 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,614 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,615 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,615 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,615 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:07,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,722 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,722 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,722 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,722 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:07,722 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,865 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,866 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,866 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,866 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,866 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:07,866 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:07,866 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,866 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:07,867 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,083 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,120 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:02:09,152 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,152 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,153 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:09,275 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,275 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:09,275 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:09,276 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,276 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,394 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,394 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:09,394 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:09,394 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,394 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,507 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,507 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,507 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,507 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,507 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,711 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,711 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,711 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,711 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:09,711 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,829 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,829 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,829 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,829 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:09,830 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,950 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,950 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,950 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,951 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:09,951 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,054 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,054 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:10,054 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:10,054 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:10,055 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,198 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,198 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:10,198 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:10,198 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:10,199 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:10,199 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:10,199 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:10,199 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:10,199 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,417 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,417 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,418 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,418 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:10,418 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,433 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:02:11,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:11,552 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:11,552 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,552 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:11,673 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,673 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:11,673 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:11,673 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,673 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,797 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:11,797 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:11,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,797 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,915 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:11,916 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:11,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,115 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,115 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:12,115 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,237 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,237 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,237 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:12,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,384 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,385 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,385 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,385 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:12,385 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,475 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,475 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,475 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:12,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,612 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:12,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:12,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:12,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:12,613 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:12,614 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,850 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:02:13,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,201 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,201 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,201 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:13,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:13,306 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:13,306 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,307 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,361 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,361 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:13,361 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:13,362 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,362 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,475 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,475 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,475 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,476 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,548 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:13,548 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,651 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,651 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:13,651 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,756 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,756 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:13,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,849 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,850 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,850 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:13,850 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,971 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,971 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,971 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,971 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:13,971 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:13,971 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,971 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:13,972 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,884 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:02:15,061 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:40,549 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:02:40,565 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:02:40,568 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:02:42,191 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:02:42,191 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:02:45,168 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:02:45,168 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:02:45,169 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:02:45,169 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:02:45,169 - tensor_defense - INFO - Processing batches...
2025-04-20 12:02:49,697 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:02:51,544 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:02:51,889 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:02:52,229 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:02:52,588 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:02:52,937 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:02:52,938 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:02:53,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,016 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,016 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,194 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,194 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:53,194 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:53,194 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,194 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,327 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,327 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:53,328 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:53,328 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,328 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,446 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,447 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,660 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,660 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,660 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,660 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:53,660 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,782 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:53,783 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,901 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,902 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,902 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:53,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,002 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,002 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:54,002 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:54,002 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:54,002 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:54,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:54,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:54,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:54,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:54,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:54,142 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:54,142 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,367 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,382 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:02:55,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:55,420 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:55,420 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,420 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:55,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,545 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:55,546 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:55,546 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,546 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,665 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,665 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:55,665 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:55,665 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,665 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:55,774 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:55,774 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,975 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:55,976 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:55,976 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:55,976 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,095 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,096 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,096 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,096 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:56,096 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,220 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,220 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,220 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,220 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:56,220 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,316 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,316 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,316 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:56,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,457 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,457 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,457 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,457 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:56,457 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:56,457 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:56,458 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:56,458 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:56,458 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,678 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,695 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:02:57,806 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:57,807 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:57,807 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:57,807 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:57,927 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:57,928 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:57,928 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:57,928 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:57,928 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,046 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:58,046 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:58,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,046 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,147 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,148 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,148 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,148 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,347 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,348 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,348 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,348 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:58,348 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,472 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,473 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,473 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,473 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:58,473 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,591 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,591 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,591 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,591 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:58,591 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,679 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,680 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:58,680 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,819 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,819 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,819 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,819 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,820 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:58,820 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:58,820 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,820 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:58,820 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,059 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:02:59,396 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,397 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:59,500 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,500 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:59,501 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:59,501 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,550 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,550 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:59,551 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:59,551 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,551 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,653 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,654 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,654 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,654 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,714 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,714 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,714 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:59,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,823 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:59,824 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,930 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,931 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,931 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:59,931 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,025 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,026 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:00,026 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:00,026 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:00,026 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,151 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,151 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:00,151 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:00,151 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:00,151 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:00,151 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:00,151 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:00,152 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:00,152 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:01,084 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:03:01,257 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:39,915 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:03:39,929 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:03:39,931 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:03:41,352 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:03:41,352 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:03:42,914 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:03:42,915 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:03:42,915 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:03:42,915 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:03:42,915 - tensor_defense - INFO - Processing batches...
2025-04-20 12:03:47,266 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:03:49,084 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:03:49,429 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:03:49,776 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:03:50,126 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:03:50,472 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:03:50,473 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:03:50,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:50,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:50,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,715 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:50,715 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:50,715 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,716 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,834 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,834 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:50,834 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:50,834 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,834 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,946 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,946 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:50,946 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:50,946 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,947 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,154 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,154 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,154 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,154 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:51,154 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,274 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,274 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,274 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,274 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:51,274 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,395 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,396 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,396 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,396 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:51,396 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,501 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,501 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,501 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:51,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,641 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,641 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,642 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,642 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:51,642 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:51,642 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:51,642 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:51,642 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:51,642 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,875 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:03:52,900 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:52,900 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:52,900 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:52,900 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:53,019 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,019 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:53,019 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:53,020 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,020 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,137 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,138 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:53,138 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:53,138 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,138 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,246 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,246 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,246 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,246 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,453 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,453 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,453 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:53,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,575 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,575 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,575 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,575 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:53,575 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,694 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,695 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,695 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,695 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:53,695 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,810 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,811 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,811 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:53,811 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,947 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:53,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:53,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,948 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:53,948 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,191 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:03:55,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,290 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,291 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:55,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,412 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:55,412 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:55,412 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,412 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,534 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,534 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:55,534 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:55,535 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,535 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,643 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,643 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,643 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,844 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,844 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,845 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,845 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:55,845 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,966 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,966 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,966 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,967 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:55,967 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,091 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,091 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,091 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,091 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:56,091 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,187 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,188 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,188 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,188 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:56,188 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,330 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,330 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,330 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,330 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,330 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:56,330 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:56,331 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,331 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:56,331 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,552 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:03:56,892 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,893 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:56,994 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,995 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:56,995 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:56,995 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,995 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,052 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,052 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:57,052 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:57,052 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,052 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,155 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,155 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,155 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,214 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,214 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,214 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,214 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:57,215 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,319 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,320 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,320 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,320 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:57,320 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,422 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,422 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,422 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:57,422 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,515 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,515 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,515 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:57,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,640 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,640 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,640 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,641 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:57,641 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:57,641 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,641 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:57,641 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:58,553 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:03:58,643 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:03:58,656 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:58,657 - tensor_defense - INFO - Experiment completed
2025-04-20 12:04:53,622 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:04:53,637 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:04:53,639 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:04:55,082 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:04:55,082 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:04:56,726 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:04:56,727 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:04:56,727 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:04:56,727 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:04:56,727 - tensor_defense - INFO - Processing batches...
2025-04-20 12:05:01,108 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:05:02,893 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:05:03,233 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:05:03,578 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:05:03,930 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:05:04,275 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:05:04,276 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:05:04,350 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:04,350 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:04,350 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,525 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,526 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:04,526 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:04,526 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,647 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,648 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:04,648 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:04,648 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,648 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,764 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,764 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:04,764 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:04,764 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,764 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,971 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:04,971 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:04,971 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:04,972 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,088 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,088 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,088 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,088 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:05,088 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,207 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,208 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:05,208 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,322 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,322 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,322 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,322 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:05,322 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,486 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,486 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,486 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:05,486 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:05,486 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:05,486 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:05,486 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:05,487 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,731 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:05:06,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:06,760 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:06,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:06,760 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:06,872 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:06,872 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:06,873 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:06,873 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:06,873 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:06,989 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:06,989 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:06,989 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:06,989 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:06,989 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,101 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,101 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,102 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,102 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:07,102 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,299 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,300 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,300 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,300 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:07,300 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,411 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,412 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:07,412 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,531 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,531 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,531 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:07,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,630 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,630 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,630 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,630 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:07,630 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,776 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:07,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:07,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:07,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:07,777 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:07,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:08,001 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,018 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:05:09,120 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,121 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,121 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,121 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:09,241 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,242 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:09,242 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:09,242 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,242 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:09,363 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:09,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,460 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,460 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,460 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,461 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,461 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,662 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,662 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,662 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,662 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:09,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,782 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,782 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:09,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,903 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,903 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:09,903 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,997 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,997 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,997 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:09,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:10,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:10,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:10,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:10,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,142 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:10,142 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:10,352 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,369 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:05:10,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:10,706 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:10,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,706 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:10,805 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,806 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:10,806 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:10,806 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,859 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:10,860 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:10,860 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,964 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:10,964 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:10,964 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,022 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,022 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,022 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,022 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:11,022 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,130 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,130 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,130 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,130 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:11,130 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,235 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,236 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,236 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,236 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:11,236 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,336 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,337 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,337 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,337 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:11,337 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,463 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,464 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:11,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:11,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:11,464 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:11,464 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:11,465 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,660 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:12,373 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:05:12,374 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:05:12,374 - tensor_defense - INFO - 
clean:
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,377 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,377 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,377 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:05:12,462 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:05:12,475 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:12,476 - tensor_defense - INFO - Experiment completed
2025-04-20 12:06:08,267 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:06:08,282 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:06:08,284 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:06:10,030 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:06:10,031 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:06:11,608 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:06:11,609 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:06:11,609 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:06:11,609 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:06:11,609 - tensor_defense - INFO - Processing batches...
2025-04-20 12:06:16,144 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:06:17,978 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:06:18,322 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:06:18,668 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:06:19,019 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:06:19,368 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:06:19,368 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:06:19,537 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:19,538 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:19,538 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,718 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:19,719 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:19,719 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,719 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:19,861 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:19,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,989 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:19,990 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:19,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,200 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,200 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,200 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:20,200 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,319 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,319 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,319 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,319 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:20,319 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,436 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,437 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,437 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,437 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:20,437 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,541 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,542 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,542 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,542 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:20,542 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,682 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,682 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,683 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,683 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:20,683 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:20,683 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:20,683 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:20,683 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:20,683 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,901 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,941 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:06:21,965 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:21,965 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:21,965 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:21,965 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:22,092 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,092 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:22,092 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:22,092 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:22,092 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,217 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:22,217 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:22,217 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:22,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,340 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,341 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,341 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,341 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:22,341 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,540 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:22,540 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,663 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,663 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,664 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:22,664 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,780 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,781 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,781 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,781 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:22,781 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,876 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,876 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,876 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,877 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:22,877 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,019 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,019 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:23,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:23,020 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:23,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:23,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:23,020 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:23,020 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:23,020 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,239 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,259 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:06:24,369 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:24,369 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:24,369 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,369 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:24,497 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,497 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:24,498 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:24,498 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,498 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,614 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,614 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:24,615 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:24,615 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,734 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,734 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:24,735 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:24,735 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,735 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:24,933 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:24,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:24,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,052 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,053 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,053 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,053 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:25,053 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,173 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,174 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,174 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,174 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:25,174 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,283 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,283 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,284 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,284 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:25,284 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,424 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,425 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,425 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:25,425 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:25,425 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:25,425 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:25,425 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:25,425 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,650 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:25,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,670 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:06:26,002 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,002 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,003 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,003 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:26,107 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,108 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:26,108 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:26,108 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,108 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,162 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:26,162 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:26,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,163 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,264 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,264 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,264 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,265 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,265 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,324 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,324 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,324 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,324 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:26,325 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,427 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,427 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,427 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,427 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:26,427 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,525 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,525 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,525 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,525 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:26,525 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,615 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,615 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,616 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:26,616 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,735 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,736 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,736 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,736 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,736 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:26,736 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:26,736 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,736 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:26,736 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,939 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:27,655 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:06:27,655 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:06:27,655 - tensor_defense - INFO - 
clean:
2025-04-20 12:06:27,655 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:06:27,655 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@5: 0.2734
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.3516
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:06:27,658 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,658 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@5: 0.3359
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 12:06:27,658 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:06:27,743 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:06:27,756 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:27,757 - tensor_defense - INFO - Experiment completed
2025-04-20 12:07:58,762 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:07:58,787 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:07:58,789 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:08:00,391 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:08:00,392 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:08:02,206 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:08:02,206 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:08:02,206 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:08:02,206 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:08:02,206 - tensor_defense - INFO - Processing batches...
2025-04-20 12:08:06,718 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:08:08,585 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:08:08,926 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:08:09,267 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:08:09,622 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:08:09,968 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:08:09,968 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:08:10,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,210 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,210 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:10,210 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:10,210 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,210 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,336 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,337 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:10,337 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:10,337 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,337 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,444 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,444 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,444 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,661 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,661 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,661 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:10,662 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,779 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,779 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:10,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,907 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,907 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,908 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,908 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:10,908 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,004 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,005 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:11,005 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:11,005 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:11,005 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,146 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,146 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:11,147 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:11,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:11,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:11,147 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:11,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:11,147 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:11,147 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,378 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:08:12,415 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:12,415 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:12,415 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,415 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:12,539 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:12,539 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:12,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,539 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,663 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:12,663 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:12,663 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:12,801 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:12,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,801 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,002 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,003 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,003 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,003 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:13,003 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,127 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,128 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,128 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,128 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:13,128 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,253 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,253 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,253 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,253 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:13,254 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,356 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,356 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:13,356 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,494 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,495 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,495 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,495 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:13,495 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:13,495 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:13,495 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:13,495 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:13,495 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,730 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:08:14,847 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:14,847 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:14,848 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:14,848 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:14,973 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:14,973 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:14,974 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:14,974 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:14,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,103 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,104 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:15,104 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:15,104 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,104 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,216 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,216 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,216 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,216 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,216 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,421 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,422 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,422 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:15,422 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,545 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,545 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,545 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:15,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,670 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,670 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:15,671 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,774 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:15,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,915 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,915 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,915 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,915 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:15,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:15,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,916 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:15,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,140 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,159 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:08:16,491 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,491 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,492 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,492 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:16,618 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,619 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:16,619 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:16,619 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,619 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,649 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:16,649 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:16,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,754 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,755 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,755 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,814 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,815 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,815 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,815 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:16,815 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,921 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,921 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,921 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:16,922 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,024 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,024 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:17,024 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:17,024 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:17,024 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,115 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,115 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:17,115 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:17,115 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,243 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,244 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:17,244 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:17,244 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:17,244 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:17,244 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:17,244 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:17,245 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:17,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:17,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:18,164 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:08:18,164 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:08:18,164 - tensor_defense - INFO - 
clean:
2025-04-20 12:08:18,164 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:08:18,164 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:08:18,164 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2500
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,167 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 12:08:18,167 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:08:18,254 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:08:18,266 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:18,267 - tensor_defense - INFO - Experiment completed
2025-04-20 12:12:20,244 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:12:20,259 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:12:20,262 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:12:21,705 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:12:21,706 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:12:23,259 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:12:23,259 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:12:23,260 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:12:23,260 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:12:23,260 - tensor_defense - INFO - Processing batches...
2025-04-20 12:12:27,793 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:12:29,670 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:12:30,013 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:12:30,359 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:12:30,709 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:12:31,052 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:12:31,053 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:12:31,219 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,219 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,219 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,401 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:31,401 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:31,401 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,538 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,538 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:31,538 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:31,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,539 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,671 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,671 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,671 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,879 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,879 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,879 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,879 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:31,879 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,997 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,997 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,997 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:31,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:32,114 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:32,114 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:32,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,212 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,213 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:32,213 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:32,213 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:32,213 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:32,363 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:32,363 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:32,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:32,364 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:32,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:32,364 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:32,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,619 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:12:33,730 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:33,731 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:33,731 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:33,731 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:33,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:33,859 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:33,860 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:33,860 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:33,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:33,976 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:33,977 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:33,977 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:33,977 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:33,977 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,083 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,084 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,084 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,084 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:34,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,286 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,287 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:34,287 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,418 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,419 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,419 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,419 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:34,419 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,536 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,536 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,536 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,536 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:34,536 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,618 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,618 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,618 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:34,618 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,756 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,756 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:34,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:34,757 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:34,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:34,757 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:34,757 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:34,975 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,990 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:12:36,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,187 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,187 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:36,321 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,321 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:36,321 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:36,321 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,322 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,445 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:36,445 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:36,445 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,445 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,557 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,557 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,557 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,558 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,558 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,758 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,759 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:36,759 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,882 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,882 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,882 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:36,882 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,014 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,014 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,015 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,015 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:37,015 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,107 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,108 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,108 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,108 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:37,108 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,248 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,248 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,248 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,248 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,248 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:37,248 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:37,249 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,249 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:37,249 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,490 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:12:37,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,816 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,816 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,817 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:37,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,919 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:37,919 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:37,919 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,919 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,964 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:37,964 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:37,964 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,068 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,069 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,069 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,069 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:38,069 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,125 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,125 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,125 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,126 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:38,126 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,225 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,225 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,225 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,225 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:38,226 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,334 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,334 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,335 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,335 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:38,335 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,434 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,435 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,435 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,435 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:38,435 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,558 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,558 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,558 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,559 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:38,559 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:38,559 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:38,559 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:38,559 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:38,559 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,752 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,752 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,752 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,753 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:38,753 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:39,474 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:12:39,474 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:12:39,474 - tensor_defense - INFO - 
clean:
2025-04-20 12:12:39,474 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:12:39,475 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:12:39,475 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:12:39,475 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 12:12:39,476 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:12:39,476 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:12:39,476 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:12:39,478 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 12:12:39,478 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 12:12:39,478 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 12:12:39,478 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:12:39,564 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:12:39,577 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:39,578 - tensor_defense - INFO - Experiment completed
