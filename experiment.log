2025-04-20 10:28:18,008 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:28:18,027 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:28:18,031 - tensor_defense - INFO - Loading model: clip vit-b/32
2025-04-20 10:28:18,031 - tensor_defense - ERROR - Error loading model clip vit-b/32: Incorrect path_or_model_id: 'openai/clip-vit-b/32'. Please provide either the path to a local folder or the repo_id of a model on the Hub.
2025-04-20 10:30:53,039 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:30:53,060 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:30:53,063 - tensor_defense - INFO - Loading model: clip vit-b-32
2025-04-20 10:30:53,241 - tensor_defense - ERROR - Error loading model clip vit-b-32: openai/clip-vit-b-32 is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `huggingface-cli login` or by passing `token=<your_token>`
2025-04-20 10:34:44,668 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:34:44,689 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:34:44,692 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:34:47,794 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:34:47,794 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:34:52,460 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:34:52,460 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=2, step_size=0.0235294
2025-04-20 10:34:52,460 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=2
2025-04-20 10:34:52,460 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:34:52,460 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:34:59,896 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:35:00,251 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:35:00,589 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:35:00,951 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:35:01,306 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:35:01,307 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:35:01,591 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:35:01,591 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,591 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,591 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 0.9688
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,592 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,592 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,593 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:35:01,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:01,594 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:01,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,819 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:01,819 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,819 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,820 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,820 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,821 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:35:01,821 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:35:01,821 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:35:01,821 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,821 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,977 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:01,977 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,977 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9844
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Improvement: -1.56%
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,978 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,978 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,978 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:35:01,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:35:01,978 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:35:01,979 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,979 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,103 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,103 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,103 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,103 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,104 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,104 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,105 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,105 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:35:02,105 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,105 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,105 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,105 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,392 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,392 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,392 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,393 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,393 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,393 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:35:02,393 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,393 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,394 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:35:02,394 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,535 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:35:02,535 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,535 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,535 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.9688
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,536 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,536 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,537 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,537 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:35:02,537 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,537 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,537 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:35:02,537 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,671 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:35:02,671 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.9688
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,671 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,672 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,672 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,672 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:35:02,673 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,673 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,673 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:35:02,673 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,817 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,817 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.9688
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,817 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,818 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,818 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,818 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:35:02,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,819 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:35:02,819 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,987 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,988 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.9688
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,988 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,989 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,989 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,989 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:35:02,990 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,232 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:35:03,232 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.9688
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,232 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,233 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,482 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:35:03,836 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:35:03,837 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:35:03,851 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:35:03,852 - tensor_defense - INFO - Experiment completed
2025-04-20 10:38:52,985 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:38:53,006 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:38:53,009 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:38:54,463 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:38:54,464 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:38:55,969 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:38:55,969 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 10:38:55,969 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 10:38:55,969 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:38:55,969 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:39:04,255 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:39:04,592 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:39:04,933 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:39:05,278 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:39:05,624 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:39:05,624 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:39:05,867 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:39:05,867 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Adversarial (With No Defense): 0.9844
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,868 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,868 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:39:05,869 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,869 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,869 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:39:05,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:05,870 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:05,870 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,064 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,064 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,065 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,065 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,066 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,066 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,066 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:39:06,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:39:06,066 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:39:06,066 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,066 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,209 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,209 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,210 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,210 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,211 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,211 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:39:06,211 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:39:06,211 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:39:06,211 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,211 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,348 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,348 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,349 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,349 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,350 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,350 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:39:06,350 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,350 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,350 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,350 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,611 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,613 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,613 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:39:06,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:39:06,613 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,758 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:39:06,758 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,758 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.9688
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Improvement: -1.59%
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,759 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,760 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,760 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,760 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:39:06,760 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,760 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:39:06,761 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,905 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:39:06,905 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.9844
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,906 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,906 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,907 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,907 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:39:06,907 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,907 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,907 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:39:06,908 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,019 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:39:07,019 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.9844
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,019 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,020 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,020 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,020 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:39:07,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:07,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:07,020 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:39:07,020 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,189 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:39:07,189 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.9844
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,190 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,190 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,191 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,191 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:07,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:39:07,191 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,414 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:39:07,415 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.9531
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Improvement: -3.17%
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,415 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,416 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,416 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,416 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,641 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:39:07,998 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:39:07,998 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:39:08,013 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:39:08,015 - tensor_defense - INFO - Experiment completed
2025-04-20 10:43:02,389 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:43:02,403 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:43:02,405 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:43:03,821 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:43:03,821 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:43:05,691 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:43:05,691 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 10:43:05,691 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 10:43:05,691 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:43:05,691 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:43:14,003 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:43:14,345 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:43:14,683 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:43:15,030 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:43:15,396 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:43:15,397 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:43:15,620 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:43:15,620 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,621 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,621 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 10:43:15,622 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,622 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,622 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:43:15,623 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:15,623 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:15,623 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,810 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:15,810 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,810 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:15,811 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:15,812 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:15,813 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:15,813 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,813 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:43:15,813 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:43:15,813 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:43:15,813 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,813 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,977 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:15,977 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:15,978 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 10:43:15,979 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 10:43:15,980 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,980 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:43:15,980 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:43:15,980 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:43:15,980 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,980 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,106 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,106 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:16,107 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2812
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Performance Recovery: 4.44% of the adversarial drop
2025-04-20 10:43:16,108 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 10:43:16,109 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,109 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:43:16,109 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,109 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,109 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,109 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,374 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,374 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,374 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,374 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,375 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 10:43:16,375 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,376 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,376 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:43:16,376 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,376 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,376 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:43:16,376 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,516 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:43:16,516 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:16,516 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,517 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,518 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,518 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:43:16,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,518 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,518 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:43:16,519 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,653 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:43:16,653 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,654 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.3125
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 10:43:16,654 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 10:43:16,655 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,655 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,655 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,655 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:43:16,655 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,655 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,655 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:43:16,655 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,769 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,769 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.2031
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:16,770 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,771 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,771 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,771 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:43:16,771 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,771 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,772 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:43:16,772 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,945 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,945 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,946 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3438
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,946 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,947 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,947 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:43:16,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:43:16,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:43:16,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,948 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:43:16,948 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,210 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:43:17,210 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:17,210 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 10:43:17,211 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3594
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Improvement: 43.75%
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Performance Recovery: 15.56% of the adversarial drop
2025-04-20 10:43:17,212 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,429 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:43:17,788 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:43:17,788 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:43:17,804 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:43:17,805 - tensor_defense - INFO - Experiment completed
2025-04-20 11:10:59,388 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:10:59,403 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:10:59,405 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:11:01,426 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:11:01,426 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:11:02,804 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:11:02,805 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:11:02,805 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:11:02,805 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:11:02,805 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:11:11,133 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:11:11,479 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:11:11,825 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:11:12,178 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:11:12,518 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:11:12,518 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:11:12,716 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:11:12,716 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,716 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,717 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,717 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:11:12,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:12,718 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:12,719 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:12,898 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:12,899 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:12,899 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:12,900 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:11:12,901 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:12,901 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:12,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:12,901 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:11:12,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:11:12,901 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:11:12,901 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:12,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,052 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,052 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:11:13,053 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:11:13,053 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 11:11:13,054 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:11:13,054 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:11:13,054 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,054 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:11:13,054 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:11:13,054 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:11:13,054 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:13,054 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,179 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,179 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,179 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,179 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:13,180 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2969
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:11:13,181 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:11:13,182 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,182 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:11:13,182 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,182 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,182 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:13,182 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,459 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,460 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,461 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:11:13,461 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:11:13,462 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,462 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,462 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,462 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:11:13,462 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,462 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,462 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:11:13,462 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,605 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:11:13,605 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:11:13,605 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:13,606 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,607 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,607 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:11:13,607 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,607 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,607 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:11:13,608 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,746 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:11:13,746 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,747 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.3125
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:11:13,748 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,749 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,749 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,749 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:11:13,749 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,749 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,749 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:11:13,749 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,860 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,860 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,860 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,861 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:13,861 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,862 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,862 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:11:13,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,862 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:11:13,862 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,036 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:11:14,036 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:14,037 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3438
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:14,038 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:14,038 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,039 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:14,039 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:11:14,040 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,268 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:11:14,269 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:11:14,269 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3750
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Improvement: 50.00%
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Performance Recovery: 17.78% of the adversarial drop
2025-04-20 11:11:14,270 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:11:14,271 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:11:14,271 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,493 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:11:14,850 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:11:14,850 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:11:14,864 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:11:14,865 - tensor_defense - INFO - Experiment completed
2025-04-20 11:26:29,636 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:26:29,650 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:26:29,653 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:26:31,074 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:26:31,075 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:26:32,692 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:26:32,693 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:26:32,693 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:26:32,693 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:26:32,693 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:26:41,062 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:26:41,398 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:26:41,733 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:26:42,084 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:26:42,423 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:26:42,424 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:26:42,648 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:26:42,648 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,648 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,649 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,649 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:26:42,650 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:42,650 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:42,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:42,835 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:42,835 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:42,835 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3281
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:26:42,836 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:42,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:42,837 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:26:42,837 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:26:42,837 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:26:42,837 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:42,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:42,999 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:42,999 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,999 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:26:43,000 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:26:43,001 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:26:43,001 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,001 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:26:43,001 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:26:43,002 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:26:43,002 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:43,002 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,133 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,133 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,133 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,133 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:43,134 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2969
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:26:43,135 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:26:43,135 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,135 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:26:43,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,136 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:43,136 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,419 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,419 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,419 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:26:43,420 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,420 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,420 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:26:43,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,421 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,421 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:26:43,421 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,569 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:26:43,569 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2188
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:26:43,570 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:26:43,570 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,571 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,571 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:26:43,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,571 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,572 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:26:43,572 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,712 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:26:43,712 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,713 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.2969
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:26:43,714 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,715 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,715 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:26:43,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,715 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,715 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:26:43,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,821 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,822 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,822 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:26:43,823 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,823 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,823 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:26:43,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,823 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,824 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:26:43,824 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,997 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,997 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,997 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,998 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3281
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:26:43,999 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,999 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,999 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:26:44,000 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,229 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:26:44,230 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:26:44,230 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3750
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Improvement: 50.00%
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Performance Recovery: 17.78% of the adversarial drop
2025-04-20 11:26:44,231 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:26:44,231 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,453 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:26:44,816 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:26:44,816 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:26:44,831 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:26:44,832 - tensor_defense - INFO - Experiment completed
