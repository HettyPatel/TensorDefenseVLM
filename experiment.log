2025-04-20 10:28:18,008 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:28:18,027 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:28:18,031 - tensor_defense - INFO - Loading model: clip vit-b/32
2025-04-20 10:28:18,031 - tensor_defense - ERROR - Error loading model clip vit-b/32: Incorrect path_or_model_id: 'openai/clip-vit-b/32'. Please provide either the path to a local folder or the repo_id of a model on the Hub.
2025-04-20 10:30:53,039 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:30:53,060 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:30:53,063 - tensor_defense - INFO - Loading model: clip vit-b-32
2025-04-20 10:30:53,241 - tensor_defense - ERROR - Error loading model clip vit-b-32: openai/clip-vit-b-32 is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `huggingface-cli login` or by passing `token=<your_token>`
2025-04-20 10:34:44,668 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:34:44,689 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:34:44,692 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:34:47,794 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:34:47,794 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:34:52,460 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:34:52,460 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=2, step_size=0.0235294
2025-04-20 10:34:52,460 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=2
2025-04-20 10:34:52,460 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:34:52,460 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:34:59,896 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:35:00,251 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:35:00,589 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:35:00,951 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:35:01,306 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:35:01,307 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:35:01,591 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:35:01,591 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,591 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,591 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 0.9688
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,592 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,592 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,592 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,593 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:35:01,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:01,594 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:01,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,819 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:01,819 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,819 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,819 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,820 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,820 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,820 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,821 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:35:01,821 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:35:01,821 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:35:01,821 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,821 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,977 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:01,977 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,977 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:01,977 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9844
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Improvement: -1.56%
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,978 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:01,978 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:01,978 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:01,978 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:35:01,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:35:01,978 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:35:01,979 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:01,979 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,103 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,103 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,103 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,103 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,104 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,104 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,104 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,105 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,105 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,105 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:35:02,105 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,105 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,105 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,105 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,392 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,392 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.9688
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,392 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,392 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,393 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,393 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,393 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,393 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:35:02,393 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,393 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,394 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:35:02,394 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,535 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:35:02,535 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,535 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,535 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.9688
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,536 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,536 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,536 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,537 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,537 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,537 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:35:02,537 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,537 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,537 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:35:02,537 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,671 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:35:02,671 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.9688
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,671 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,671 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,672 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,672 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,672 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,672 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:35:02,673 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,673 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,673 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:35:02,673 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,817 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,817 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.9688
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,817 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,817 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,818 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,818 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,818 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,818 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:35:02,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,819 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:35:02,819 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,987 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:35:02,988 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.9688
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,988 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:02,988 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,989 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:02,989 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:02,989 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:02,989 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:35:02,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:35:02,990 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:35:02,990 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,232 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:35:03,232 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Adversarial (No Defense): 0.9688
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.9688
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,232 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,232 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,233 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:35:03,233 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:35:03,234 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:35:03,234 - tensor_defense - INFO - All hooks removed
2025-04-20 10:35:03,482 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:35:03,836 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:35:03,837 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:35:03,851 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:35:03,852 - tensor_defense - INFO - Experiment completed
2025-04-20 10:38:52,985 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:38:53,006 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:38:53,009 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:38:54,463 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:38:54,464 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:38:55,969 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:38:55,969 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 10:38:55,969 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 10:38:55,969 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:38:55,969 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:39:04,255 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:39:04,592 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:39:04,933 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:39:05,278 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:39:05,624 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:39:05,624 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:39:05,867 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:39:05,867 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Adversarial (With No Defense): 0.9844
2025-04-20 10:39:05,867 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,868 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,868 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:05,868 - tensor_defense - INFO -     Adversarial (With No Defense): 1.0000
2025-04-20 10:39:05,869 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:05,869 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:05,869 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:39:05,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:05,870 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:05,870 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,064 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,064 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,064 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,065 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,065 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,065 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,066 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,066 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,066 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:39:06,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:39:06,066 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:39:06,066 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,066 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,209 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,209 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,209 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,210 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,210 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,210 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,211 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,211 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,211 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:39:06,211 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:39:06,211 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:39:06,211 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,211 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,348 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,348 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,348 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,349 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,349 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,349 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,350 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,350 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,350 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:39:06,350 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,350 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,350 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:06,350 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,611 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.9844
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,612 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,612 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 1.0000
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,613 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,613 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,613 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:39:06,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:39:06,613 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,758 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:39:06,758 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,758 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.9688
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Improvement: -1.59%
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,759 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,759 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,760 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 1.0000
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,760 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,760 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,760 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:39:06,760 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,760 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:39:06,761 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,905 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:39:06,905 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.9844
2025-04-20 10:39:06,905 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,906 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,906 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:06,906 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 1.0000
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:06,907 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:06,907 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:06,907 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:39:06,907 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:06,907 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:06,907 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:39:06,908 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,019 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:39:07,019 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.9844
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,019 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,019 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,020 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 1.0000
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,020 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,020 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,020 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:39:07,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:07,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:07,020 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:39:07,020 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,189 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:39:07,189 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.9844
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,189 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,190 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,190 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 1.0000
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,190 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,191 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,191 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:07,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:39:07,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:39:07,191 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:39:07,191 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,414 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:39:07,415 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (No Defense): 0.9844
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.9531
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Improvement: -3.17%
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,415 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:39:07,415 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,416 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (No Defense): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 1.0000
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:39:07,416 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:39:07,416 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,416 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:39:07,417 - tensor_defense - INFO - All hooks removed
2025-04-20 10:39:07,641 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:39:07,998 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:39:07,998 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:39:08,013 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:39:08,015 - tensor_defense - INFO - Experiment completed
2025-04-20 10:43:02,389 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 10:43:02,403 - tensor_defense - INFO - Using device: cuda
2025-04-20 10:43:02,405 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 10:43:03,821 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 10:43:03,821 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 10:43:05,691 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 10:43:05,691 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 10:43:05,691 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 10:43:05,691 - root - INFO - Random start: True, Targeted: False
2025-04-20 10:43:05,691 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 10:43:14,003 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 10:43:14,345 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 10:43:14,683 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 10:43:15,030 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 10:43:15,396 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 10:43:15,397 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 10:43:15,620 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 10:43:15,620 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,620 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,621 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,621 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,621 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 10:43:15,622 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:15,622 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:15,622 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 10:43:15,623 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:15,623 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:15,623 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,810 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:15,810 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,810 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:15,811 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,811 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:15,812 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 10:43:15,812 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:15,813 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:15,813 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,813 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 10:43:15,813 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 10:43:15,813 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 10:43:15,813 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,813 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,977 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:15,977 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:15,978 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:15,978 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 10:43:15,979 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 10:43:15,979 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 10:43:15,980 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:15,980 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 10:43:15,980 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 10:43:15,980 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 10:43:15,980 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:15,980 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,106 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,106 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 10:43:16,107 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,107 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2812
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Performance Recovery: 4.44% of the adversarial drop
2025-04-20 10:43:16,108 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 10:43:16,108 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 10:43:16,109 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,109 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 10:43:16,109 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,109 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,109 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,109 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,374 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,374 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,374 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,374 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,375 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 10:43:16,375 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 10:43:16,375 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,376 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,376 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,376 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 10:43:16,376 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,376 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,376 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 10:43:16,376 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,516 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 10:43:16,516 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:16,516 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:16,516 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,517 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,517 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,518 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,518 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,518 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 10:43:16,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,518 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,518 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 10:43:16,519 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,653 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 10:43:16,653 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,653 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,654 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.3125
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 10:43:16,654 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,654 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 10:43:16,655 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,655 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,655 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,655 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 10:43:16,655 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,655 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,655 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 10:43:16,655 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,769 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,769 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.2031
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 10:43:16,770 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 10:43:16,770 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,771 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,771 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,771 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,771 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 10:43:16,771 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,771 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,772 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 10:43:16,772 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,945 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 10:43:16,945 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 10:43:16,945 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 10:43:16,946 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3438
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 10:43:16,946 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:16,946 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 10:43:16,947 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 10:43:16,947 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:16,947 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 10:43:16,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 10:43:16,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 10:43:16,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 10:43:16,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 10:43:16,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 10:43:16,948 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 10:43:16,948 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,210 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 10:43:17,210 - tensor_defense - INFO -   Recall@1:
2025-04-20 10:43:17,210 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 10:43:17,211 - tensor_defense - INFO -   Recall@5:
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3594
2025-04-20 10:43:17,211 - tensor_defense - INFO -     Improvement: 43.75%
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Performance Recovery: 15.56% of the adversarial drop
2025-04-20 10:43:17,212 - tensor_defense - INFO -   Recall@10:
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 10:43:17,212 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:43:17,212 - tensor_defense - INFO - All hooks removed
2025-04-20 10:43:17,429 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 10:43:17,788 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 10:43:17,788 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 10:43:17,804 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 10:43:17,805 - tensor_defense - INFO - Experiment completed
2025-04-20 11:10:59,388 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:10:59,403 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:10:59,405 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:11:01,426 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:11:01,426 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:11:02,804 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:11:02,805 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:11:02,805 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:11:02,805 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:11:02,805 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:11:11,133 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:11:11,479 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:11:11,825 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:11:12,178 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:11:12,518 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:11:12,518 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:11:12,716 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:11:12,716 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,716 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:12,716 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,717 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:12,717 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:12,717 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:11:12,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:12,718 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:12,719 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:12,898 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:12,899 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:12,899 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:12,899 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:12,900 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:12,900 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:11:12,901 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:12,901 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:12,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:12,901 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:11:12,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:11:12,901 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:11:12,901 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:12,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,052 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,052 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:11:13,052 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:11:13,053 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:11:13,053 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,053 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 11:11:13,054 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:11:13,054 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:11:13,054 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,054 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:11:13,054 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:11:13,054 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:11:13,054 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:13,054 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,179 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,179 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,179 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,179 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:11:13,180 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2969
2025-04-20 11:11:13,180 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:11:13,181 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:11:13,181 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:11:13,182 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,182 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:11:13,182 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,182 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,182 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:13,182 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,459 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,460 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:11:13,460 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,461 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:11:13,461 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,461 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:11:13,462 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,462 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,462 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,462 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:11:13,462 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,462 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,462 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:11:13,462 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,605 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:11:13,605 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:11:13,605 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:11:13,605 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:13,606 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,606 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,607 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,607 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,607 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:11:13,607 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,607 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,607 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:11:13,608 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,746 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:11:13,746 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,747 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,747 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.3125
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:11:13,748 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:11:13,748 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,749 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,749 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,749 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:11:13,749 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,749 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,749 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:11:13,749 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,860 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:11:13,860 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:13,860 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:13,861 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:13,861 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:13,861 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:13,862 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:13,862 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:13,862 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:11:13,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:13,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:13,862 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:11:13,862 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,036 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:11:14,036 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:11:14,037 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:14,037 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3438
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:11:14,038 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:11:14,038 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:11:14,038 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,039 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:14,039 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:11:14,039 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:11:14,039 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:11:14,040 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,268 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:11:14,269 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:11:14,269 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:11:14,269 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3750
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Improvement: 50.00%
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Performance Recovery: 17.78% of the adversarial drop
2025-04-20 11:11:14,270 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:11:14,270 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:11:14,271 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:11:14,271 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:11:14,271 - tensor_defense - INFO - All hooks removed
2025-04-20 11:11:14,493 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:11:14,850 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:11:14,850 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:11:14,864 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:11:14,865 - tensor_defense - INFO - Experiment completed
2025-04-20 11:26:29,636 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:26:29,650 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:26:29,653 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:26:31,074 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:26:31,075 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:26:32,692 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:26:32,693 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:26:32,693 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:26:32,693 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:26:32,693 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:26:41,062 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:26:41,398 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:26:41,733 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:26:42,084 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:26:42,423 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:26:42,424 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:26:42,648 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:26:42,648 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,648 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,648 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,649 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:42,649 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:42,649 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:26:42,650 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:42,650 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:42,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:42,835 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:42,835 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:42,835 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:42,835 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3281
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:26:42,836 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:42,836 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:42,837 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:42,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:42,837 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:26:42,837 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:26:42,837 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:26:42,837 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:42,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:42,999 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:42,999 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:42,999 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:26:43,000 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:26:43,000 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:26:43,001 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.4062
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:26:43,001 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:26:43,001 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,001 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:26:43,001 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:26:43,002 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:26:43,002 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:43,002 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,133 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,133 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,133 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,133 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:26:43,134 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,134 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2969
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:26:43,135 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:26:43,135 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:26:43,135 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,135 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:26:43,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,136 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:43,136 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,419 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,419 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,419 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,419 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:26:43,420 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,420 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,420 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,420 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:26:43,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,421 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,421 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:26:43,421 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,569 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:26:43,569 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,569 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2188
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:26:43,570 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:26:43,570 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:26:43,570 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,571 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,571 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,571 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:26:43,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,571 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,572 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:26:43,572 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,712 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:26:43,712 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,713 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,713 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.2969
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:26:43,714 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:26:43,714 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,715 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,715 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:26:43,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,715 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,715 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:26:43,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,821 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,822 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,822 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,822 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:26:43,823 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,823 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,823 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,823 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:26:43,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:43,823 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:43,824 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:26:43,824 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,997 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:26:43,997 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:43,997 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:26:43,998 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:43,998 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3281
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:26:43,999 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:26:43,999 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:26:43,999 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:43,999 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:26:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:26:44,000 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:26:44,000 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,229 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:26:44,230 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2188
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Improvement: 27.27%
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Performance Recovery: 6.38% of the adversarial drop
2025-04-20 11:26:44,230 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:26:44,230 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3750
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Improvement: 50.00%
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Performance Recovery: 17.78% of the adversarial drop
2025-04-20 11:26:44,231 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:26:44,231 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:26:44,231 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:26:44,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:26:44,453 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:26:44,816 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:26:44,816 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:26:44,831 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:26:44,832 - tensor_defense - INFO - Experiment completed
2025-04-20 11:41:03,221 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:41:03,235 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:41:03,237 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:41:05,334 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:41:05,334 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:41:06,922 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:41:06,922 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:41:06,922 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:41:06,922 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:41:06,923 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:41:15,250 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:41:15,589 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:41:15,934 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:41:16,284 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:41:16,626 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:41:16,626 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:41:16,751 - tensor_defense - INFO - 
No Defense Evaluation Results:
2025-04-20 11:41:16,751 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Adversarial (With No Defense): 0.1719
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:16,751 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:16,751 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Adversarial (With No Defense): 0.2500
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:16,752 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Adversarial (With No Defense): 0.3750
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:16,752 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:16,752 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.5)
2025-04-20 11:41:16,753 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:16,753 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:16,753 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:16,923 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:16,924 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:16,924 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:16,924 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.3438
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:41:16,925 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:16,925 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:16,925 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:16,926 - tensor_defense - INFO - Evaluating defense: CP Attention (R=64, alpha=0.5)
2025-04-20 11:41:16,926 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:41:16,926 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:41:16,926 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:16,926 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,075 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,075 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2031
2025-04-20 11:41:17,075 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:41:17,076 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.2656
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Improvement: 6.25%
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Performance Recovery: 2.22% of the adversarial drop
2025-04-20 11:41:17,076 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,076 - tensor_defense - INFO -     Adversarial (With CP Attention (R=64, alpha=0.5)): 0.3906
2025-04-20 11:41:17,077 - tensor_defense - INFO -     Improvement: 4.17%
2025-04-20 11:41:17,077 - tensor_defense - INFO -     Performance Recovery: 2.50% of the adversarial drop
2025-04-20 11:41:17,077 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,077 - tensor_defense - INFO - Evaluating defense: CP MLP (R=64, alpha=0.5)
2025-04-20 11:41:17,077 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:41:17,077 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:41:17,077 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:17,077 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,231 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,232 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.1719
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Improvement: 0.00%
2025-04-20 11:41:17,232 - tensor_defense - INFO -     Performance Recovery: 0.00% of the adversarial drop
2025-04-20 11:41:17,233 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.2812
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Performance Recovery: 4.44% of the adversarial drop
2025-04-20 11:41:17,233 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Adversarial (With CP MLP (R=64, alpha=0.5)): 0.4062
2025-04-20 11:41:17,233 - tensor_defense - INFO -     Improvement: 8.33%
2025-04-20 11:41:17,234 - tensor_defense - INFO -     Performance Recovery: 5.00% of the adversarial drop
2025-04-20 11:41:17,234 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,234 - tensor_defense - INFO - Evaluating defense: Tucker Final Norm (R=64, alpha=0.5)
2025-04-20 11:41:17,234 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,234 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,234 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:17,234 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,496 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,496 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,496 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.1875
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:17,497 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.3125
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Improvement: 25.00%
2025-04-20 11:41:17,497 - tensor_defense - INFO -     Performance Recovery: 8.89% of the adversarial drop
2025-04-20 11:41:17,497 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Adversarial (With Tucker Final Norm (R=64, alpha=0.5)): 0.4219
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,498 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,498 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,498 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.3)
2025-04-20 11:41:17,498 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,498 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,498 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:41:17,498 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,638 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3) Evaluation Results:
2025-04-20 11:41:17,638 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.2031
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:41:17,638 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:41:17,639 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.3438
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:41:17,639 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,639 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.3)): 0.4219
2025-04-20 11:41:17,640 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,640 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,640 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,640 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=64, alpha=0.7)
2025-04-20 11:41:17,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,640 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,640 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:41:17,640 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,770 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7) Evaluation Results:
2025-04-20 11:41:17,770 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,770 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,770 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.1875
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:17,771 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.2969
2025-04-20 11:41:17,771 - tensor_defense - INFO -     Improvement: 18.75%
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Performance Recovery: 6.67% of the adversarial drop
2025-04-20 11:41:17,772 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=64, alpha=0.7)): 0.4219
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,772 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,772 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,772 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=32, alpha=0.5)
2025-04-20 11:41:17,772 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,773 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,773 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:41:17,773 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,889 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5) Evaluation Results:
2025-04-20 11:41:17,889 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:17,889 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.1875
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:17,890 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.3438
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Improvement: 37.50%
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Performance Recovery: 13.33% of the adversarial drop
2025-04-20 11:41:17,890 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:17,890 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:17,891 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=32, alpha=0.5)): 0.4219
2025-04-20 11:41:17,891 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:17,891 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:17,891 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:17,891 - tensor_defense - INFO - Evaluating defense: CP Final Norm (R=128, alpha=0.5)
2025-04-20 11:41:17,891 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:17,891 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:17,891 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:41:17,891 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,060 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5) Evaluation Results:
2025-04-20 11:41:18,060 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:18,060 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.1875
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Improvement: 9.09%
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Performance Recovery: 2.13% of the adversarial drop
2025-04-20 11:41:18,061 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.3281
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Improvement: 31.25%
2025-04-20 11:41:18,061 - tensor_defense - INFO -     Performance Recovery: 11.11% of the adversarial drop
2025-04-20 11:41:18,062 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Adversarial (With CP Final Norm (R=128, alpha=0.5)): 0.4219
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Improvement: 12.50%
2025-04-20 11:41:18,062 - tensor_defense - INFO -     Performance Recovery: 7.50% of the adversarial drop
2025-04-20 11:41:18,062 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,062 - tensor_defense - INFO - Evaluating defense: CP Multi-Layer (2 Layers)
2025-04-20 11:41:18,062 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:41:18,063 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:41:18,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:18,063 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:41:18,063 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:41:18,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:41:18,063 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:41:18,063 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,297 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers) Evaluation Results:
2025-04-20 11:41:18,298 - tensor_defense - INFO -   Recall@1:
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Clean: 0.9062
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Adversarial (No Defense): 0.1719
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.2031
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Improvement: 18.18%
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Performance Recovery: 4.26% of the adversarial drop
2025-04-20 11:41:18,298 - tensor_defense - INFO -   Recall@5:
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Clean: 0.9531
2025-04-20 11:41:18,298 - tensor_defense - INFO -     Adversarial (No Defense): 0.2500
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.3594
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Improvement: 43.75%
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Performance Recovery: 15.56% of the adversarial drop
2025-04-20 11:41:18,299 - tensor_defense - INFO -   Recall@10:
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Clean: 1.0000
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Adversarial (No Defense): 0.3750
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Adversarial (With CP Multi-Layer (2 Layers)): 0.4531
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Improvement: 20.83%
2025-04-20 11:41:18,299 - tensor_defense - INFO -     Performance Recovery: 12.50% of the adversarial drop
2025-04-20 11:41:18,299 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,299 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,300 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,300 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:41:18,300 - tensor_defense - INFO - All hooks removed
2025-04-20 11:41:18,533 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r1.png
2025-04-20 11:41:18,893 - tensor_defense - INFO - Saved comparison plot to results\defense_comparison_r5.png
2025-04-20 11:41:18,894 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 11:41:18,908 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:41:18,909 - tensor_defense - INFO - Experiment completed
2025-04-20 11:44:21,922 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:44:21,936 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:44:21,939 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:44:23,544 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:44:23,544 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:44:24,998 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:44:24,998 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:44:24,999 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:44:24,999 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:44:24,999 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:47:04,936 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:47:04,968 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:47:04,971 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:47:06,868 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:47:06,868 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:47:10,410 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:47:10,411 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:47:10,411 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:47:10,411 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:47:10,411 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:48:16,778 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:48:16,794 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:48:16,796 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:48:18,732 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:48:18,733 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:48:20,296 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:48:20,297 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:48:20,297 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:48:20,297 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:48:20,297 - tensor_defense - INFO - Generating adversarial examples
2025-04-20 11:56:37,107 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 11:56:37,122 - tensor_defense - INFO - Using device: cuda
2025-04-20 11:56:37,124 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 11:56:38,572 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 11:56:38,573 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 11:56:40,641 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 11:56:40,641 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 11:56:40,641 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 11:56:40,641 - root - INFO - Random start: True, Targeted: False
2025-04-20 11:56:40,641 - tensor_defense - INFO - Processing batches...
2025-04-20 11:56:45,090 - tensor_defense - INFO - Processing batch 1/32
2025-04-20 11:56:47,258 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 11:56:47,602 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 11:56:47,945 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 11:56:48,335 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 11:56:48,688 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 11:56:48,688 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 11:56:49,426 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:49,426 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:49,427 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,667 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,668 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:49,668 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:49,668 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,789 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,789 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:49,790 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:49,790 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,790 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,891 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:49,892 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:49,892 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:49,892 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:49,892 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,161 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,161 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,162 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,162 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:50,162 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,283 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,283 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,283 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:50,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,402 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,402 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,402 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,402 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:50,402 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,539 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,540 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:50,540 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,680 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,680 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:50,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:50,680 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:50,680 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:50,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:50,681 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:50,681 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:50,681 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,900 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,900 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,900 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,901 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:50,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:50,941 - tensor_defense - INFO - Processing batch 2/32
2025-04-20 11:56:51,986 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:51,986 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:51,986 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:51,986 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:52,109 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,109 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:52,109 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:52,109 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:52,109 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,235 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,235 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:52,236 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:52,236 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:52,236 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,369 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,369 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,369 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:52,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,569 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,569 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,569 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,570 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:52,570 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,692 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,692 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,692 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,692 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:52,692 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,804 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,805 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,805 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,805 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:52,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,898 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:52,898 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:52,898 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:52,898 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:52,898 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,037 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,037 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:53,038 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:53,038 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:53,038 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:53,038 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:53,038 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:53,038 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:53,038 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:53,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:53,277 - tensor_defense - INFO - Processing batch 3/32
2025-04-20 11:56:54,391 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:54,391 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:54,391 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,391 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:54,514 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,514 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:54,514 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:54,514 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,514 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,629 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,629 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:54,629 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:54,629 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,629 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,739 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:54,739 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:54,739 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:54,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,941 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:54,941 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:54,941 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:54,941 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:54,941 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,071 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,071 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,071 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,071 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:55,071 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,189 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,189 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,189 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,189 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:55,189 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,281 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,281 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,282 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:55,282 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,423 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:55,424 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:55,424 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:55,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:55,424 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:55,424 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:55,424 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:55,424 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:55,662 - tensor_defense - INFO - Processing batch 4/32
2025-04-20 11:56:56,704 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:56,704 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:56,704 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:56,704 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:56,827 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:56,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:56,828 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:56,828 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:56,828 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:56,947 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:56,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:56,947 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:56,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:56,947 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,062 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,063 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,063 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:57,063 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,265 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,265 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,265 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:57,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,388 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,388 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,388 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,388 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:57,388 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,511 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,511 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,511 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,511 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:57,511 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,611 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,611 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,611 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,612 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:57,612 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,751 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,751 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:57,751 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:57,751 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:57,752 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:56:57,752 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:56:57,752 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:57,752 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:56:57,752 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:57,969 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:58,010 - tensor_defense - INFO - Processing batch 5/32
2025-04-20 11:56:59,081 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,081 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,081 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,081 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:56:59,201 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,202 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:56:59,202 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:56:59,202 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,202 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,321 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,321 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:56:59,321 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:56:59,322 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,322 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,434 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,434 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,435 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,435 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:56:59,435 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,636 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,636 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,637 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,637 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:56:59,637 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,754 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,755 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,755 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:56:59,755 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,879 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,879 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,879 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,879 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:56:59,879 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,978 - tensor_defense - INFO - All hooks removed
2025-04-20 11:56:59,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:56:59,978 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:56:59,979 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:56:59,979 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,121 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,121 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:00,121 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:00,121 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:00,121 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:00,122 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:00,122 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:00,122 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:00,122 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,338 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:00,339 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:00,370 - tensor_defense - INFO - Processing batch 6/32
2025-04-20 11:57:01,374 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:01,374 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:01,374 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,374 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:01,497 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,497 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:01,497 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:01,497 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,497 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:01,618 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:01,618 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,728 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,729 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:01,729 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:01,729 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:01,729 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,930 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:01,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:01,931 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:01,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:01,931 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,060 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,060 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:02,060 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,199 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,200 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,200 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:02,200 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,311 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,311 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,311 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,311 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:02,312 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,448 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,448 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:02,449 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:02,449 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:02,449 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:02,449 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:02,449 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:02,449 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:02,449 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:02,703 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:02,720 - tensor_defense - INFO - Processing batch 7/32
2025-04-20 11:57:03,768 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:03,768 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:03,768 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:03,769 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:03,895 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:03,895 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:03,895 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:03,895 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:03,896 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,014 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,014 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:04,014 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:04,014 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,015 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,124 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,124 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,124 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,125 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,125 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,326 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,326 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,326 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:04,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,446 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:04,447 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,566 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,566 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,566 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,566 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:04,567 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,676 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,676 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,677 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,677 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:04,677 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,818 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:04,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:04,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:04,818 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:04,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:04,819 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:04,819 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:04,819 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:05,049 - tensor_defense - INFO - Processing batch 8/32
2025-04-20 11:57:06,091 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,092 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,092 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,092 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:06,214 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,214 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:06,214 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:06,215 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,215 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,308 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,308 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:06,308 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:06,308 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,308 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,410 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,410 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,410 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,410 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:06,411 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,616 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,616 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,616 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,616 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:06,617 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,735 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,736 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,736 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,736 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:06,736 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,858 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,858 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,859 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,859 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:06,859 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,948 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:06,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:06,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:06,948 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:06,949 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,094 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,094 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:07,094 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:07,094 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:07,095 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:07,095 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:07,095 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:07,095 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:07,095 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,310 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,310 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,310 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,311 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:07,311 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:07,371 - tensor_defense - INFO - Processing batch 9/32
2025-04-20 11:57:08,380 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:08,380 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:08,380 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,380 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:08,506 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,507 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:08,507 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:08,507 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,507 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,631 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,631 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:08,632 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:08,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,632 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,744 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,744 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:08,744 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:08,745 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:08,745 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,944 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:08,944 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:08,945 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:08,945 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:08,945 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,065 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,065 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,065 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,065 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:09,066 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,186 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,186 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:09,186 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,286 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,286 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,286 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:09,287 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,430 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,430 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:09,430 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:09,430 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:09,430 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:09,431 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:09,431 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:09,431 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:09,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,668 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,669 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:09,669 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:09,695 - tensor_defense - INFO - Processing batch 10/32
2025-04-20 11:57:10,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:10,706 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:10,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:10,706 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:10,827 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:10,827 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:10,827 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:10,827 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:10,827 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:10,942 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:10,942 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:10,942 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:10,942 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:10,943 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,080 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,081 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,081 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,081 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:11,081 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,280 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,281 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,281 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,281 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:11,281 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,397 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:11,398 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,518 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,519 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,519 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:11,519 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,618 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,618 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:11,618 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,775 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:11,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:11,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:11,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:11,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:11,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:11,776 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:11,776 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:11,993 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:11,994 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:12,009 - tensor_defense - INFO - Processing batch 11/32
2025-04-20 11:57:12,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:12,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:12,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:12,990 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:13,111 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,112 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:13,112 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:13,112 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:13,112 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,231 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,231 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:13,232 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:13,232 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:13,232 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,326 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,326 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,326 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:13,326 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,529 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,530 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,530 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,530 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:13,530 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,653 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,653 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,653 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,653 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:13,654 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,775 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,775 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,776 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:13,776 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,861 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:13,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:13,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:13,861 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:13,861 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,006 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,006 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:14,007 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:14,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:14,007 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:14,007 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:14,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:14,007 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:14,007 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,225 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:14,226 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:14,239 - tensor_defense - INFO - Processing batch 12/32
2025-04-20 11:57:15,221 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,221 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,221 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,221 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:15,344 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,344 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:15,345 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:15,345 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,345 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,468 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,469 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:15,469 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:15,469 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,469 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,578 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,578 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,579 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,579 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:15,579 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,779 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,779 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,779 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:15,780 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:15,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:15,901 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:15,901 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:15,901 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,021 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,021 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:16,021 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:16,021 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:16,021 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,119 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,119 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:16,119 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:16,119 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:16,119 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,262 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,262 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:16,263 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:16,263 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:16,263 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:16,263 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:16,263 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:16,263 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:16,263 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,482 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:16,483 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:16,537 - tensor_defense - INFO - Processing batch 13/32
2025-04-20 11:57:17,530 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:17,531 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:17,531 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,531 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:17,660 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,660 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:17,660 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:17,660 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,661 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,782 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:17,783 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:17,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,783 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,887 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:17,887 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:17,887 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:17,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:17,887 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,093 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,094 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,094 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,094 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:18,094 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,213 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,213 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,214 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,214 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:18,214 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,336 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,336 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,336 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,336 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:18,337 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,444 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,444 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,444 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,444 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:18,445 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,584 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:18,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:18,584 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:18,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:18,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:18,585 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:18,585 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:18,585 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,804 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:18,805 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:18,830 - tensor_defense - INFO - Processing batch 14/32
2025-04-20 11:57:19,881 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:19,882 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:19,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:19,882 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:20,002 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,003 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:20,003 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:20,003 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,003 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,131 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,132 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:20,132 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:20,132 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,132 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,235 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,235 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,235 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,235 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,235 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,434 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,435 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,435 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,435 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:20,435 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,579 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,579 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,579 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,579 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:20,579 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,698 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,698 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,698 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,698 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:20,699 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,790 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,790 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,790 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,790 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:20,790 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,930 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:20,930 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:20,930 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:20,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:20,931 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:20,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:20,931 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:20,931 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,147 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:21,148 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:21,166 - tensor_defense - INFO - Processing batch 15/32
2025-04-20 11:57:22,244 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,244 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,244 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,244 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:22,363 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:22,364 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:22,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,364 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,487 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:22,487 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:22,487 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,596 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,596 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,596 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,596 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:22,596 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,796 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,797 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:22,797 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,920 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:22,920 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:22,920 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:22,920 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:22,920 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,046 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:23,046 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:23,046 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:23,047 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,143 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,144 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:23,144 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:23,144 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:23,144 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,281 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,281 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:23,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:23,282 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:23,282 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:23,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:23,282 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:23,282 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:23,282 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:23,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:23,517 - tensor_defense - INFO - Processing batch 16/32
2025-04-20 11:57:24,490 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:24,490 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:24,490 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,490 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:24,615 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,616 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:24,616 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:24,616 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,616 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,739 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:24,739 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:24,739 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,739 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:24,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:24,850 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:24,850 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:24,850 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,051 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,051 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,051 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,051 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:25,051 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,171 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,171 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,171 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,172 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:25,172 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,287 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,287 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:25,287 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,385 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,385 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,385 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,385 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:25,385 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,527 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,527 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:25,527 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:25,527 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:25,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:25,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:25,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:25,528 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:25,528 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,744 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,744 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,745 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,745 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:25,745 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:25,800 - tensor_defense - INFO - Processing batch 17/32
2025-04-20 11:57:26,796 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:26,797 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:26,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:26,797 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:26,923 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:26,923 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:26,923 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:26,923 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:26,923 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,047 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,047 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:27,048 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:27,048 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,048 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,155 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,156 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,156 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,156 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,156 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,364 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,364 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,364 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:27,364 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,487 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,488 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,488 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:27,488 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,607 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,607 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,607 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,607 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:27,607 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,715 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,716 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:27,716 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,858 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:27,858 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:27,858 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:27,858 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,858 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:27,858 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:27,858 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:27,858 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:27,858 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:28,078 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:28,103 - tensor_defense - INFO - Processing batch 18/32
2025-04-20 11:57:29,119 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,119 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,119 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,119 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:29,246 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,246 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:29,246 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:29,247 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,247 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,368 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,369 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:29,369 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:29,369 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,480 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,481 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,481 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,481 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:29,481 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,686 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,686 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,686 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,686 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:29,687 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,810 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,810 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,810 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,810 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:29,811 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,926 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:29,927 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:29,927 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:29,927 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:29,927 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,021 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,021 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:30,021 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:30,021 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:30,022 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,159 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,159 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:30,159 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:30,159 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:30,160 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:30,160 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:30,160 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:30,160 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:30,160 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:30,372 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:30,387 - tensor_defense - INFO - Processing batch 19/32
2025-04-20 11:57:31,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:31,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:31,465 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,465 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:31,593 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,593 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:31,594 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:31,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,594 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,710 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,710 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:31,710 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:31,710 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,710 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:31,812 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:31,812 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:31,812 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:31,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,010 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,010 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,010 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,010 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:32,010 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,127 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,127 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,127 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,127 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:32,127 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,251 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,251 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,251 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,251 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:32,251 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,350 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,351 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,351 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,351 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:32,351 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,488 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,489 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:32,489 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:32,489 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:32,489 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:32,489 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:32,489 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:32,489 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:32,489 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:32,705 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:32,722 - tensor_defense - INFO - Processing batch 20/32
2025-04-20 11:57:33,716 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:33,716 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:33,716 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:33,716 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:33,842 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:33,842 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:33,842 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:33,842 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:33,842 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:33,949 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:33,949 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:33,949 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:33,949 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:33,949 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,051 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,052 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,052 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,052 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:34,052 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,251 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,252 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,252 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,252 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:34,252 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,366 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,367 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,367 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,367 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:34,367 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,487 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,487 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,487 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:34,487 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,601 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,602 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,602 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:34,602 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,743 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,743 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:34,743 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:34,743 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:34,743 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:34,743 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:34,743 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:34,743 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:34,743 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:34,959 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:35,012 - tensor_defense - INFO - Processing batch 21/32
2025-04-20 11:57:36,017 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,017 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,017 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,017 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:36,136 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:36,136 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:36,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,137 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,257 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,257 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:36,257 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:36,258 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,258 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,368 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,368 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,368 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,368 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:36,369 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,569 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,569 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,569 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,569 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:36,569 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,691 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,691 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,691 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:36,691 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,814 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,814 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,814 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,814 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:36,814 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,912 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:36,912 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:36,913 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:36,913 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:36,913 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,063 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,063 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:37,063 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:37,063 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:37,064 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:37,064 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:37,064 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:37,064 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:37,064 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:37,283 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:37,306 - tensor_defense - INFO - Processing batch 22/32
2025-04-20 11:57:38,317 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,317 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,317 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,317 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:38,437 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,437 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:38,438 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:38,438 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,438 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,559 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,560 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:38,560 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:38,560 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,560 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,670 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,671 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,671 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:38,671 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,870 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,870 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,871 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:38,871 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,989 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:38,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:38,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:38,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:38,990 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,110 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,110 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:39,110 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:39,110 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:39,110 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,217 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,218 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:39,218 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:39,218 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:39,218 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,378 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,378 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:39,379 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:39,379 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:39,379 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:39,379 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:39,379 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:39,379 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:39,379 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,601 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,602 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:39,602 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:39,618 - tensor_defense - INFO - Processing batch 23/32
2025-04-20 11:57:40,634 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:40,634 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:40,634 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,634 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:40,757 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,757 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:40,757 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:40,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,757 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,880 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,880 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:40,880 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:40,880 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,880 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,991 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:40,991 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:40,991 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:40,991 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:40,991 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:41,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,313 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,313 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,314 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,314 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:41,314 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,433 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,433 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,433 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,434 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:41,434 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,547 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,547 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,547 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,547 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:41,547 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,690 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,690 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:41,690 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:41,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:41,691 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:41,691 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:41,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:41,691 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:41,691 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,908 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:41,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:41,924 - tensor_defense - INFO - Processing batch 24/32
2025-04-20 11:57:42,942 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:42,943 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:42,943 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:42,943 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:43,068 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,068 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:43,068 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:43,068 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,068 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,195 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,195 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:43,195 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:43,195 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,196 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,294 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,294 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,294 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,294 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,499 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,499 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,499 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:43,499 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,619 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,619 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,619 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,619 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:43,619 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,748 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,748 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,748 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,748 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:43,748 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,844 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,845 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,845 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,845 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:43,845 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,988 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:43,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:43,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:43,988 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:43,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:43,989 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:43,989 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:43,989 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:44,203 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:44,264 - tensor_defense - INFO - Processing batch 25/32
2025-04-20 11:57:45,274 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,275 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,275 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,275 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:45,401 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,401 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:45,401 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:45,401 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,401 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,511 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,511 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:45,511 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:45,511 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,512 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,639 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,639 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,639 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,639 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:45,639 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,846 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,846 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,846 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,846 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:45,846 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,974 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:45,974 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:45,974 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:45,974 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:45,974 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,092 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,092 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:46,092 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:46,092 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:46,092 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,190 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,190 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:46,190 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:46,190 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:46,190 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,327 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,328 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:46,328 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:46,328 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:46,328 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:46,328 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:46,328 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:46,328 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:46,328 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:46,548 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:46,573 - tensor_defense - INFO - Processing batch 26/32
2025-04-20 11:57:47,592 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:47,593 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:47,593 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,593 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:47,718 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,719 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:47,719 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:47,719 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,719 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,837 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,837 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:47,837 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:47,837 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,838 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,940 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:47,940 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:47,941 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:47,941 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:47,941 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:48,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,261 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,261 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,261 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,261 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:48,261 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,383 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,384 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,384 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,384 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:48,384 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,493 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,493 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,493 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,494 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:48,494 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,632 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:48,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:48,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:48,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:48,633 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:48,633 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:48,633 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:48,633 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:48,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:48,865 - tensor_defense - INFO - Processing batch 27/32
2025-04-20 11:57:49,920 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:49,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:49,921 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:49,921 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:50,041 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,042 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:50,042 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:50,042 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,042 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,164 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,164 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:50,164 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:50,164 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,164 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,265 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,265 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,265 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,265 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,469 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,470 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,470 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:50,470 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,591 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,591 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,591 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,591 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:50,591 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,715 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,715 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,716 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:50,716 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,811 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,812 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,812 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,812 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:50,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,947 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:50,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:50,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:50,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:50,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:50,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:50,947 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:50,948 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:51,166 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:51,182 - tensor_defense - INFO - Processing batch 28/32
2025-04-20 11:57:52,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,186 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,186 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:52,305 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,305 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:52,305 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:52,305 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,305 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,422 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,423 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:52,423 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:52,423 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,423 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,528 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,528 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:52,528 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,731 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,731 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,732 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,732 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:52,732 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,849 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,849 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,850 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:52,850 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,966 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:52,966 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:52,966 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:52,966 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:52,966 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,064 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,064 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:53,064 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:53,065 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:53,065 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,206 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:53,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:53,207 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:53,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:53,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:53,207 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:53,207 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:53,207 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:53,431 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:53,468 - tensor_defense - INFO - Processing batch 29/32
2025-04-20 11:57:54,515 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:54,516 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:54,516 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,516 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:54,637 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:54,638 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:54,638 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,638 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,758 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:54,759 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:54,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,759 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,870 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:54,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:54,870 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:54,870 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:54,870 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,073 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,073 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,073 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,073 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:55,073 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,191 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,191 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,191 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:55,191 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,319 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,319 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,319 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,319 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:55,319 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,411 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,411 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,411 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:55,411 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,552 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,553 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:55,553 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:55,553 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:55,553 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:55,553 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:55,553 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:55,553 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:55,553 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:55,770 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:55,797 - tensor_defense - INFO - Processing batch 30/32
2025-04-20 11:57:56,784 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:56,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:56,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:56,785 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:56,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:56,909 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:56,909 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:56,909 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:56,909 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,029 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,030 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:57,030 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:57,030 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,030 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,125 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,125 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,125 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,125 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,125 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,329 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,329 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,329 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,329 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:57,329 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,454 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,454 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,454 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,454 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:57,454 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,566 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,566 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,566 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,566 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:57,566 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,669 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,670 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,670 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:57:57,670 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,811 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:57,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:57,811 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:57,811 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:57:57,811 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:57:57,811 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:57,812 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:57:57,812 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,028 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,028 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,029 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,029 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:58,029 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:58,046 - tensor_defense - INFO - Processing batch 31/32
2025-04-20 11:57:59,106 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,106 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,106 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,106 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:57:59,230 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,230 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:57:59,230 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:57:59,230 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,230 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,355 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:57:59,355 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:57:59,355 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,355 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,470 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,470 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,470 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:57:59,470 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,674 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,674 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,674 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,675 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:57:59,675 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,801 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:57:59,801 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,936 - tensor_defense - INFO - All hooks removed
2025-04-20 11:57:59,936 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:57:59,936 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:57:59,936 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:57:59,936 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,050 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,050 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:00,050 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:00,050 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:58:00,050 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,192 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,192 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:00,192 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:00,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,193 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:58:00,193 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:58:00,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,193 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:58:00,193 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:58:00,409 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,427 - tensor_defense - INFO - Processing batch 32/32
2025-04-20 11:58:00,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:00,828 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:00,828 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,829 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:58:00,954 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:00,954 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 11:58:00,954 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 11:58:00,954 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:00,954 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,035 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,035 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 11:58:01,035 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 11:58:01,035 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,035 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,142 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,142 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,240 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,240 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,240 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,240 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 11:58:01,240 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,345 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,345 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,345 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,345 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 11:58:01,345 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,448 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,448 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,448 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,448 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 11:58:01,448 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,550 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,551 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,551 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,551 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 11:58:01,551 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,675 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,675 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 11:58:01,675 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 11:58:01,675 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,675 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 11:58:01,675 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 11:58:01,675 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 11:58:01,675 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 11:58:01,675 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 11:58:01,882 - tensor_defense - INFO - All hooks removed
2025-04-20 11:58:02,577 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 11:58:02,735 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:06,335 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:00:06,351 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:00:06,353 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:00:07,887 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:00:07,887 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 1000
2025-04-20 12:00:09,873 - tensor_defense - INFO - Initialized dataset with 1000 samples
2025-04-20 12:00:09,874 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:00:09,874 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:00:09,874 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:00:09,874 - tensor_defense - INFO - Processing batches...
2025-04-20 12:00:14,183 - tensor_defense - INFO - Processing batch 1/32
2025-04-20 12:00:15,973 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:00:16,316 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:00:16,663 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:00:17,018 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:00:17,366 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:00:17,367 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:00:17,441 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:17,442 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:17,442 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,615 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:17,616 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:17,616 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,616 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,746 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,746 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:17,746 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:17,746 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,746 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,857 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:17,857 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:17,857 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:17,857 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:17,857 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,066 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,067 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:18,067 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,187 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,187 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,187 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,187 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:18,187 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,305 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,306 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,306 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:18,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,410 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,410 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,410 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:18,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,547 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:18,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:18,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:18,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:18,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:18,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:18,548 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:18,548 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:18,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:18,828 - tensor_defense - INFO - Processing batch 2/32
2025-04-20 12:00:19,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:19,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:19,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:19,861 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:19,986 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:19,987 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:19,987 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:19,987 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:19,987 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,106 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:20,106 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:20,106 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,211 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,211 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,211 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,411 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,411 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:20,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,527 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,527 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,527 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:20,527 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,649 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,650 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,650 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:20,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,753 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,753 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,753 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,753 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:20,753 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,892 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:20,893 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:20,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:20,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,893 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:20,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:20,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:20,893 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:20,893 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:21,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:21,122 - tensor_defense - INFO - Processing batch 3/32
2025-04-20 12:00:22,241 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,241 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,241 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,241 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:22,378 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,378 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:22,378 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:22,378 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,378 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,495 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,495 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:22,495 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:22,495 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,495 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,599 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,599 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,600 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,600 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:22,600 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,800 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:22,801 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,923 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:22,923 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:22,923 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:22,923 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:22,923 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,043 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,043 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:23,044 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:23,044 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:23,044 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,146 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,146 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:23,146 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:23,146 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:23,146 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,285 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,285 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:23,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:23,286 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:23,286 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:23,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:23,286 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:23,286 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:23,286 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:23,486 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:23,516 - tensor_defense - INFO - Processing batch 4/32
2025-04-20 12:00:24,545 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:24,545 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:24,545 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,545 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:24,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:24,670 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:24,670 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,777 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:24,777 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:24,777 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:24,887 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:24,887 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:24,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:24,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,087 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,087 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,088 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,088 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:25,088 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,211 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,211 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,211 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:25,211 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,329 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,329 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,329 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,329 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:25,329 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,431 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,432 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,432 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,432 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:25,432 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,571 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:25,571 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:25,571 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:25,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:25,572 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:25,572 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:25,572 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:25,572 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,789 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,789 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,790 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,790 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:25,790 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:25,812 - tensor_defense - INFO - Processing batch 5/32
2025-04-20 12:00:26,891 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:26,891 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:26,891 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:26,891 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:27,013 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,013 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:27,013 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:27,013 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,014 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,136 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:27,136 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:27,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,137 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,241 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,241 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,241 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,241 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,242 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,445 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,446 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,446 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,446 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:27,446 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,567 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,567 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,568 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,568 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:27,568 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,681 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,681 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,681 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,681 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:27,681 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,775 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:27,775 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,917 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:27,917 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:27,917 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:27,917 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,917 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:27,917 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:27,917 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:27,918 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:27,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,162 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:28,163 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:28,222 - tensor_defense - INFO - Processing batch 6/32
2025-04-20 12:00:29,210 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,210 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,210 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,210 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:29,332 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,332 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:29,333 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:29,333 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,333 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:29,447 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:29,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,552 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,552 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,552 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:29,552 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,758 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,758 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,758 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,758 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:29,759 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,880 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:29,881 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:29,881 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:29,881 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:29,881 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,008 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,008 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:30,009 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:30,009 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:30,009 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,100 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:30,100 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:30,100 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:30,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,240 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:30,240 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:30,240 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:30,241 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:30,241 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:30,241 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:30,241 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:30,241 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,452 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,452 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,452 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,453 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:30,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:30,469 - tensor_defense - INFO - Processing batch 7/32
2025-04-20 12:00:31,513 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:31,513 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:31,513 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,513 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:31,636 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,636 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:31,637 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:31,637 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,637 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,759 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:31,760 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:31,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,760 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,872 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:31,872 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:31,872 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:31,872 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:31,872 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,074 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,075 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,075 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,075 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:32,075 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,193 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,193 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,193 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:32,193 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,311 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,311 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,311 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,311 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:32,311 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,410 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,410 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,410 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:32,410 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,549 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,549 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:32,549 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:32,549 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:32,549 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:32,550 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:32,550 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:32,550 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:32,550 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,776 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:32,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:32,804 - tensor_defense - INFO - Processing batch 8/32
2025-04-20 12:00:33,836 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:33,836 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:33,836 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:33,836 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:33,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:33,957 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:33,958 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:33,958 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:33,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,069 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,069 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:34,069 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:34,069 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,070 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,170 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,170 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,170 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,372 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,372 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,372 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,372 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:34,372 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,490 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,490 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,490 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,490 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:34,491 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,610 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,611 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,611 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,611 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:34,611 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,718 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,718 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,718 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:34,718 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:34,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:34,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:34,862 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:34,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:34,862 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:34,862 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:34,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,072 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:35,073 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:35,090 - tensor_defense - INFO - Processing batch 9/32
2025-04-20 12:00:36,102 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,103 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,103 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,103 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:36,224 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,224 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:36,224 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:36,224 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,224 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,341 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,341 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:36,342 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:36,342 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,342 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,450 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,450 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,450 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,450 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:36,450 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,654 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,654 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,654 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:36,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,774 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:36,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,896 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,896 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,896 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,896 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:36,896 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:36,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:36,990 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:36,990 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:36,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,133 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,133 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:37,133 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:37,133 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:37,134 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:37,134 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:37,134 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:37,134 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:37,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:37,382 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:37,440 - tensor_defense - INFO - Processing batch 10/32
2025-04-20 12:00:38,444 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:38,445 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:38,445 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,445 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:38,566 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,566 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:38,566 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:38,566 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,566 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,692 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,692 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:38,692 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:38,692 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,692 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,797 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:38,797 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:38,798 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:38,798 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,999 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:38,999 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:38,999 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:38,999 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:39,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,114 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,115 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:39,115 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,236 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,236 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,236 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,236 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:39,236 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,341 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,341 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,342 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,342 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:39,342 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,500 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,500 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:39,500 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:39,500 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:39,501 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:39,501 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:39,501 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:39,501 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:39,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:39,723 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:39,738 - tensor_defense - INFO - Processing batch 11/32
2025-04-20 12:00:40,720 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:40,720 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:40,720 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:40,720 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:40,843 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:40,843 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:40,843 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:40,843 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:40,843 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:40,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:40,962 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:40,962 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:40,962 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:40,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,086 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,086 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,086 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,086 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:41,086 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,288 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:41,288 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,409 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,409 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:41,409 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,528 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:41,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,624 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,625 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,625 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,625 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:41,625 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,762 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,762 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:41,762 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:41,762 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:41,762 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:41,762 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:41,763 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:41,763 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:41,763 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,970 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:41,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:41,994 - tensor_defense - INFO - Processing batch 12/32
2025-04-20 12:00:42,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:42,975 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:42,975 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:42,975 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:43,098 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,098 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:43,098 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:43,098 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:43,098 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,219 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,220 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:43,220 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:43,220 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:43,220 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,314 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,314 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,315 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,315 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:43,315 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,513 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,513 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,513 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,514 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:43,514 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,629 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,629 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,629 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,630 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:43,630 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,754 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,755 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,755 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:43,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,859 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:43,859 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:43,859 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:43,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:43,999 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:44,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:44,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:44,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:44,000 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:44,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:44,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:44,229 - tensor_defense - INFO - Processing batch 13/32
2025-04-20 12:00:45,227 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,227 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,227 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,227 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:45,349 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,349 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:45,349 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:45,349 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,349 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,470 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,471 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:45,471 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:45,471 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,471 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,593 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,593 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,594 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:45,594 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,798 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,798 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,799 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,799 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:45,799 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:45,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:45,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:45,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:45,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,040 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,040 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:46,040 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:46,041 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:46,041 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,141 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:46,141 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:46,141 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:46,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,280 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,280 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:46,280 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:46,280 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:46,280 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:46,281 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:46,281 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:46,281 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:46,281 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,482 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,482 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,483 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,483 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:46,483 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:46,535 - tensor_defense - INFO - Processing batch 14/32
2025-04-20 12:00:47,578 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:47,578 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:47,578 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,578 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:47,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:47,706 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:47,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,817 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,817 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:47,817 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:47,817 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,817 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:47,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:47,916 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:47,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:47,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,118 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,119 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,119 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,119 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:48,119 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,237 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,237 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,237 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:48,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,355 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,356 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:48,356 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,448 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,448 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:48,448 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,586 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:48,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:48,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:48,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:48,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:48,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:48,587 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:48,587 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:48,808 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:48,826 - tensor_defense - INFO - Processing batch 15/32
2025-04-20 12:00:49,898 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:49,898 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:49,898 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:49,898 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:50,020 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:50,021 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:50,021 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,021 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,139 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,139 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:50,139 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:50,139 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,139 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,243 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,243 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,243 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,243 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,243 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:50,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,568 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,568 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,569 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,569 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:50,569 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,694 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,694 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,694 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,694 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:50,694 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,786 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,786 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,786 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,787 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:50,787 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:50,934 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:50,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:50,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,934 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:50,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:50,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:50,934 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:50,934 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:51,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:51,176 - tensor_defense - INFO - Processing batch 16/32
2025-04-20 12:00:52,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,147 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,147 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:52,269 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,269 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:52,269 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:52,270 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,270 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,390 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,390 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:52,390 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:52,390 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,391 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,500 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,500 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,500 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,500 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:52,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,705 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,706 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:52,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,825 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,825 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,825 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,825 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:52,825 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,945 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:52,945 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:52,945 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:52,945 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:52,945 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,051 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,051 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:53,051 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:53,051 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:53,051 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,192 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,192 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:53,192 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:53,192 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:53,192 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:53,193 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:53,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:53,193 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:53,193 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,400 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:53,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:53,413 - tensor_defense - INFO - Processing batch 17/32
2025-04-20 12:00:54,416 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:54,416 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:54,416 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,416 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:54,546 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,547 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:54,547 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:54,547 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,547 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:54,670 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:54,670 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:54,779 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:54,779 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:54,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,980 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:54,980 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:54,980 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:54,980 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:54,980 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,117 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,118 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,118 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,118 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:55,118 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,239 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,239 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,239 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,239 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:55,239 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,339 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,339 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,339 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,339 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:55,339 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,475 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:55,475 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:55,476 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:55,476 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:55,476 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:55,476 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:55,476 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:55,476 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:55,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:55,758 - tensor_defense - INFO - Processing batch 18/32
2025-04-20 12:00:56,765 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:56,765 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:56,765 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:56,765 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:56,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:56,887 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:56,887 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:56,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:56,887 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,007 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,007 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:57,007 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:57,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,007 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,109 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,109 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,109 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,109 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,109 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,312 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,312 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,312 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,313 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:57,313 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,431 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,432 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,432 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,432 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:57,432 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,546 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,547 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,547 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,547 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:57,547 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,645 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,645 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,645 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:00:57,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,791 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:57,791 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:57,791 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:57,791 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,792 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:00:57,792 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:00:57,792 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:57,792 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:00:57,792 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,010 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,010 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,010 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,011 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:58,011 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:58,026 - tensor_defense - INFO - Processing batch 19/32
2025-04-20 12:00:59,103 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,103 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,104 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,104 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:00:59,231 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,231 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:00:59,231 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:00:59,231 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,231 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,354 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:00:59,355 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:00:59,355 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,474 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,474 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,474 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,474 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:00:59,474 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,676 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,676 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,676 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,676 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:00:59,676 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:00:59,801 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,920 - tensor_defense - INFO - All hooks removed
2025-04-20 12:00:59,921 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:00:59,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:00:59,921 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:00:59,921 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,011 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,011 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:00,012 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:00,012 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:00,012 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,154 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:00,155 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:00,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:00,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:00,155 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:00,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:00,155 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:00,155 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:00,388 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:00,416 - tensor_defense - INFO - Processing batch 20/32
2025-04-20 12:01:01,402 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:01,403 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:01,403 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,403 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:01,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,526 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:01,526 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:01,526 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,650 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:01,650 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:01,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:01,757 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:01,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:01,757 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,953 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:01,953 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:01,954 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:01,954 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:01,954 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,070 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,070 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,070 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,070 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:02,070 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,189 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,190 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,190 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,190 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:02,190 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,290 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,290 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:02,291 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,429 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,429 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:02,429 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:02,429 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:02,430 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:02,430 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:02,430 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:02,430 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:02,430 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:02,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:02,671 - tensor_defense - INFO - Processing batch 21/32
2025-04-20 12:01:03,681 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:03,681 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:03,681 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:03,681 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:03,812 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:03,813 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:03,813 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:03,813 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:03,813 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:03,924 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:03,924 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:03,924 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:03,924 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:03,925 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,040 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,040 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,040 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,041 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:04,041 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,246 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,246 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:04,246 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,363 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,363 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:04,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,485 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,485 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,485 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:04,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,589 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,589 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,589 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:04,589 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,726 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,726 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:04,727 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:04,727 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:04,727 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:04,727 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:04,727 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:04,727 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:04,727 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:04,957 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:04,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:05,017 - tensor_defense - INFO - Processing batch 22/32
2025-04-20 12:01:06,026 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,027 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,027 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,027 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:06,148 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,149 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:06,149 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:06,149 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,149 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,268 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,268 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:06,269 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:06,269 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,269 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,380 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,380 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,380 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,380 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:06,380 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,582 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,582 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,583 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,583 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:06,583 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,702 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,702 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,702 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,702 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:06,702 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,815 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,816 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,816 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:06,816 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:06,909 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:06,909 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:06,909 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:06,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,042 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,042 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:07,042 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:07,042 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:07,043 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:07,043 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:07,043 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:07,043 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:07,043 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:07,256 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:07,271 - tensor_defense - INFO - Processing batch 23/32
2025-04-20 12:01:08,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,290 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,290 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:08,406 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,407 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:08,407 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:08,407 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,407 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,523 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,524 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:08,524 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:08,524 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,626 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,626 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,626 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,626 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:08,627 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,832 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,832 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,832 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,833 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:08,833 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,947 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:08,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:08,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:08,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:08,948 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,066 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,067 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:09,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:09,067 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:09,067 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,168 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,169 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:09,169 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:09,169 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:09,169 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,310 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,310 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:09,310 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:09,310 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:09,310 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:09,310 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:09,310 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:09,310 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:09,311 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:09,524 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:09,549 - tensor_defense - INFO - Processing batch 24/32
2025-04-20 12:01:10,559 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:10,559 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:10,559 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,559 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:10,686 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,686 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:10,686 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:10,686 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,686 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,806 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:10,807 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:10,807 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,807 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,911 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:10,912 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:10,912 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:10,912 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:10,912 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,113 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,114 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,114 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:11,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,234 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,234 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,235 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,235 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:11,235 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,353 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,353 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,353 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,353 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:11,354 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,447 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:11,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,587 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:11,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:11,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:11,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:11,587 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:11,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:11,587 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:11,587 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,805 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:11,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:11,820 - tensor_defense - INFO - Processing batch 25/32
2025-04-20 12:01:12,840 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:12,840 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:12,840 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:12,840 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:12,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:12,958 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:12,958 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:12,958 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:12,958 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,080 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,080 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:13,080 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:13,080 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,081 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,209 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,209 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,209 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,209 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,209 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,414 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,414 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,414 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,414 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:13,414 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:13,528 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,686 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,687 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,687 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,687 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:13,687 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,779 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,779 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:13,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:13,918 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:13,918 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:13,918 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,918 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:13,918 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:13,918 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:13,918 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:13,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:14,134 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:14,186 - tensor_defense - INFO - Processing batch 26/32
2025-04-20 12:01:15,196 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,196 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,197 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,197 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:15,320 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,320 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:15,320 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:15,320 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,320 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,438 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,438 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:15,438 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:15,438 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,438 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,533 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,534 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,534 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,534 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:15,534 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,737 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,738 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,738 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,738 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:15,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:15,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,985 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:15,985 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:15,986 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:15,986 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:15,986 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,079 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,080 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:16,080 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:16,080 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:16,080 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,218 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,218 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:16,218 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:16,218 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:16,218 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:16,219 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:16,219 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:16,219 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:16,219 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,427 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:16,428 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:16,442 - tensor_defense - INFO - Processing batch 27/32
2025-04-20 12:01:17,496 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:17,496 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:17,496 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,497 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:17,616 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,617 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:17,617 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:17,617 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,617 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,738 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:17,738 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:17,738 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,853 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:17,853 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:17,853 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:17,853 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:17,853 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,056 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,056 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,056 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,056 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:18,057 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,179 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,179 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,179 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,179 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:18,179 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,302 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,302 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,303 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,303 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:18,303 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,404 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,404 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,404 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,404 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:18,404 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,544 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,544 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:18,544 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:18,544 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:18,544 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:18,544 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:18,545 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:18,545 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:18,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:18,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:18,785 - tensor_defense - INFO - Processing batch 28/32
2025-04-20 12:01:19,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:19,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:19,774 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:19,774 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:19,898 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:19,898 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:19,898 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:19,898 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:19,898 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,018 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,019 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:20,019 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:20,019 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,019 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,122 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,122 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,122 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,122 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,122 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,325 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,326 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,326 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,326 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:20,326 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,440 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,440 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,440 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,441 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:20,441 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,554 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,554 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,554 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,554 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:20,554 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,643 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,643 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,643 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:20,643 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,782 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:20,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:20,782 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:20,783 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:20,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:20,783 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:20,783 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:20,996 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:21,010 - tensor_defense - INFO - Processing batch 29/32
2025-04-20 12:01:22,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,060 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,060 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:22,184 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,184 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:22,184 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:22,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,184 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:22,306 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:22,306 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,420 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,420 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,420 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:22,420 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,624 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,625 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,625 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,625 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:22,625 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,738 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,738 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,738 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:22,738 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,862 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:22,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:22,962 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:22,962 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:22,962 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:22,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,111 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,111 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:23,111 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:23,111 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:23,111 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:23,111 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:23,112 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:23,112 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:23,112 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:23,346 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:23,382 - tensor_defense - INFO - Processing batch 30/32
2025-04-20 12:01:24,377 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:24,377 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:24,377 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,377 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:24,518 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:24,518 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:24,518 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,518 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,645 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:24,645 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:24,645 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,645 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:24,756 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:24,756 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:24,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,961 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:24,961 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:24,961 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:24,962 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:24,962 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,079 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,079 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,080 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,080 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:25,080 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,203 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,203 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,203 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,203 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:25,204 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,316 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,316 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,316 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:25,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,453 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:25,453 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:25,453 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:25,453 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:25,453 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:25,453 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:25,454 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:25,454 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,661 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:25,662 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:25,677 - tensor_defense - INFO - Processing batch 31/32
2025-04-20 12:01:26,740 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:26,740 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:26,740 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:26,740 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:26,866 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:26,867 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:26,867 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:26,867 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:26,867 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:26,986 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:26,987 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:26,987 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:26,987 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:26,987 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,100 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,101 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,101 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:27,101 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,303 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,304 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,304 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,304 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:27,304 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,424 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,424 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,424 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:27,425 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,538 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,538 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,538 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,538 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:27,538 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,640 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,641 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,641 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:27,641 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,783 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:27,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:27,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:27,784 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:27,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:27,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:27,784 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:27,784 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:27,999 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:28,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,021 - tensor_defense - INFO - Processing batch 32/32
2025-04-20 12:01:28,398 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,398 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,398 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,399 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:28,507 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,507 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:01:28,507 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:01:28,507 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,508 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,593 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,593 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:01:28,593 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:01:28,593 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,593 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,700 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,700 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,701 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,701 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:28,701 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,800 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,800 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:01:28,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:28,909 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:28,909 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:28,909 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:01:28,909 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,016 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:29,016 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:29,016 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:01:29,016 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,117 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,117 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:29,117 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:29,117 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:01:29,117 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:01:29,245 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:01:29,245 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:29,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:01:29,245 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:01:29,245 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:01:29,245 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:01:29,246 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:29,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:01:30,162 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:01:30,334 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:01:55,222 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:01:55,238 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:01:55,241 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:01:57,413 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:01:57,413 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:01:58,895 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:01:58,895 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:01:58,896 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:01:58,896 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:01:58,896 - tensor_defense - INFO - Processing batches...
2025-04-20 12:02:03,455 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:02:05,306 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:02:05,649 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:02:05,991 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:02:06,345 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:02:06,690 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:02:06,691 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:02:06,766 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:06,766 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:06,766 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:06,932 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:06,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:06,933 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:06,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:06,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,061 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,062 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:07,062 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:07,062 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,062 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,167 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,167 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,167 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,167 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,377 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,377 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,377 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,378 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:07,378 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,492 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,493 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,493 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,493 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:07,493 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,614 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,615 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,615 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,615 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:07,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,722 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,722 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,722 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,722 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:07,722 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,865 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:07,866 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:07,866 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:07,866 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,866 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:07,866 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:07,866 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:07,866 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:07,867 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,083 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:08,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:08,120 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:02:09,152 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,152 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,153 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:09,275 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,275 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:09,275 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:09,276 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,276 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,394 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,394 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:09,394 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:09,394 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,394 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,507 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,507 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,507 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,507 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:09,507 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,711 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,711 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,711 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,711 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:09,711 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,829 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,829 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,829 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,829 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:09,830 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,950 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:09,950 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:09,950 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:09,951 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:09,951 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,054 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,054 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:10,054 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:10,054 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:10,055 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,198 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,198 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:10,198 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:10,198 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:10,199 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:10,199 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:10,199 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:10,199 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:10,199 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,417 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,417 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,418 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,418 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:10,418 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:10,433 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:02:11,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:11,552 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:11,552 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,552 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:11,673 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,673 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:11,673 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:11,673 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,673 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,797 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:11,797 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:11,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,797 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,915 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:11,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:11,916 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:11,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:11,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,115 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,115 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:12,115 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,237 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,237 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,237 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:12,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,384 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,385 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,385 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,385 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:12,385 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,475 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,475 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,475 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:12,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,612 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:12,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:12,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:12,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:12,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:12,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:12,613 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:12,614 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:12,831 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:12,850 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:02:13,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,201 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,201 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,201 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:13,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:13,306 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:13,306 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,307 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,361 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,361 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:13,361 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:13,362 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,362 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,475 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,475 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,475 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,475 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,476 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,548 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:13,548 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,651 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,651 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:13,651 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,756 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,756 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:13,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,849 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,850 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,850 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:13,850 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:13,971 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:13,971 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:13,971 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,971 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:13,971 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:13,971 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:13,971 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:13,972 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:14,170 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:14,884 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:02:15,061 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:40,549 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:02:40,565 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:02:40,568 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:02:42,191 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:02:42,191 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:02:45,168 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:02:45,168 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:02:45,169 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:02:45,169 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:02:45,169 - tensor_defense - INFO - Processing batches...
2025-04-20 12:02:49,697 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:02:51,544 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:02:51,889 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:02:52,229 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:02:52,588 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:02:52,937 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:02:52,938 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:02:53,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,016 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,016 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,194 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,194 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:53,194 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:53,194 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,194 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,327 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,327 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:53,328 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:53,328 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,328 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,446 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,447 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:53,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,660 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,660 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,660 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,660 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:53,660 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,782 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:53,783 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,901 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:53,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:53,902 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:53,902 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:53,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,002 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,002 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:54,002 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:54,002 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:54,002 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:54,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:54,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:54,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:54,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:54,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:54,142 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:54,142 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,367 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:54,368 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:54,382 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:02:55,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:55,420 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:55,420 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,420 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:55,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,545 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:55,546 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:55,546 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,546 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,665 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,665 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:55,665 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:55,665 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,665 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:55,774 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:55,774 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:55,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,975 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:55,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:55,976 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:55,976 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:55,976 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,095 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,096 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,096 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,096 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:56,096 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,220 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,220 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,220 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,220 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:56,220 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,316 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,316 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,316 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:56,316 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,457 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,457 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:56,457 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:56,457 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:56,457 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:56,457 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:56,458 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:56,458 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:56,458 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,678 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:56,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:56,695 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:02:57,806 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:57,807 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:57,807 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:57,807 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:57,927 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:57,928 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:57,928 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:57,928 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:57,928 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,046 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:58,046 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:58,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,046 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,147 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,148 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,148 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,148 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,347 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,348 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,348 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,348 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:58,348 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,472 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,473 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,473 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,473 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:58,473 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,591 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,591 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,591 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,591 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:58,591 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,679 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,679 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,680 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:02:58,680 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,819 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:58,819 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:58,819 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:58,819 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,820 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:02:58,820 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:02:58,820 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:58,820 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:02:58,820 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:59,039 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,059 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:02:59,396 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,397 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:02:59,500 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,500 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:02:59,501 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:02:59,501 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,550 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,550 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:02:59,551 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:02:59,551 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,551 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,653 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,654 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,654 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,654 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:02:59,654 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,714 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,714 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,714 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:02:59,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,823 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:02:59,824 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,930 - tensor_defense - INFO - All hooks removed
2025-04-20 12:02:59,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:02:59,931 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:02:59,931 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:02:59,931 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,025 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,026 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:00,026 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:00,026 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:00,026 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,151 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,151 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:00,151 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:00,151 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:00,151 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:00,151 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:00,151 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:00,152 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:00,152 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:00,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:01,084 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:03:01,257 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:39,915 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:03:39,929 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:03:39,931 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:03:41,352 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:03:41,352 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:03:42,914 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:03:42,915 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:03:42,915 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:03:42,915 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:03:42,915 - tensor_defense - INFO - Processing batches...
2025-04-20 12:03:47,266 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:03:49,084 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:03:49,429 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:03:49,776 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:03:50,126 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:03:50,472 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:03:50,473 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:03:50,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:50,548 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:50,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,715 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,715 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:50,715 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:50,715 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,716 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,834 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,834 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:50,834 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:50,834 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,834 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,946 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:50,946 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:50,946 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:50,946 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:50,947 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,154 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,154 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,154 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,154 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:51,154 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,274 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,274 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,274 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,274 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:51,274 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,395 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,396 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,396 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,396 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:51,396 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,501 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,501 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,501 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:51,501 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,641 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,641 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:51,642 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:51,642 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:51,642 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:51,642 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:51,642 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:51,642 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:51,642 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:51,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:51,875 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:03:52,900 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:52,900 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:52,900 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:52,900 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:53,019 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,019 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:53,019 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:53,020 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,020 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,137 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,138 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:53,138 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:53,138 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,138 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,246 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,246 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,246 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,246 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,453 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,453 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,453 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:53,453 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,575 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,575 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,575 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,575 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:53,575 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,694 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,695 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,695 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,695 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:53,695 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,810 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,811 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,811 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:53,811 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,947 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:53,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:53,947 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:53,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:53,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:53,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:53,948 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:53,948 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:54,166 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:54,191 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:03:55,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,290 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,291 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:55,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,412 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:55,412 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:55,412 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,412 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,534 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,534 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:55,534 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:55,535 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,535 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,642 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,643 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,643 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:55,643 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,844 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,844 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,845 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,845 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:55,845 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,966 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:55,966 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:55,966 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:55,967 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:55,967 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,091 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,091 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,091 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,091 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:56,091 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,187 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,188 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,188 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,188 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:56,188 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,330 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,330 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,330 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,330 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,330 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:56,330 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:56,331 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,331 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:56,331 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:56,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,552 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:03:56,892 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:56,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:56,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,893 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:56,994 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:56,995 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:03:56,995 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:03:56,995 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:56,995 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,052 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,052 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:03:57,052 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:03:57,052 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,052 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,155 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,155 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,155 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,214 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,214 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,214 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,214 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:03:57,215 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,319 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,320 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,320 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,320 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:03:57,320 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,422 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,422 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,422 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:03:57,422 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,515 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,515 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,515 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:03:57,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,640 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:03:57,640 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:03:57,640 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,641 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:03:57,641 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:03:57,641 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:03:57,641 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:03:57,641 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:57,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:03:58,553 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:03:58,643 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:03:58,656 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:03:58,657 - tensor_defense - INFO - Experiment completed
2025-04-20 12:04:53,622 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:04:53,637 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:04:53,639 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:04:55,082 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:04:55,082 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:04:56,726 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:04:56,727 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:04:56,727 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:04:56,727 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:04:56,727 - tensor_defense - INFO - Processing batches...
2025-04-20 12:05:01,108 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:05:02,893 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:05:03,233 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:05:03,578 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:05:03,930 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:05:04,275 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:05:04,276 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:05:04,350 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:04,350 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:04,350 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,525 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,526 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:04,526 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:04,526 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,526 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,647 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,648 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:04,648 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:04,648 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,648 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,764 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,764 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:04,764 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:04,764 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:04,764 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,971 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:04,971 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:04,971 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:04,971 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:04,972 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,088 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,088 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,088 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,088 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:05,088 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,207 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,208 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:05,208 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,322 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,322 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,322 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,322 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:05,322 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,486 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:05,486 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:05,486 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:05,486 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:05,486 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:05,486 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:05,486 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:05,487 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:05,706 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:05,731 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:05:06,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:06,760 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:06,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:06,760 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:06,872 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:06,872 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:06,873 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:06,873 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:06,873 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:06,989 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:06,989 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:06,989 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:06,989 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:06,989 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,101 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,101 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,102 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,102 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:07,102 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,299 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,300 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,300 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,300 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:07,300 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,411 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,411 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,412 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:07,412 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,531 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,531 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,531 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:07,531 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,630 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,630 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,630 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,630 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:07,630 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,776 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:07,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:07,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:07,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:07,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:07,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:07,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:07,777 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:07,777 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,000 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:08,001 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:08,018 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:05:09,120 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,121 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,121 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,121 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:09,241 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,242 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:09,242 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:09,242 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,242 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:09,363 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:09,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,460 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,460 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,460 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,461 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:09,461 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,662 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,662 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,662 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,662 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:09,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,782 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,782 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:09,782 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,903 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,903 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:09,903 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:09,997 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:09,997 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:09,997 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:09,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:10,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:10,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,142 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:10,142 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:10,142 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,142 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:10,142 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,351 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:10,352 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,369 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:05:10,706 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:10,706 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:10,706 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,706 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:10,805 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,806 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:05:10,806 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:05:10,806 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,806 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,859 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:05:10,860 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:05:10,860 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:10,964 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:10,964 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:10,964 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:10,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,022 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,022 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,022 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,022 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:05:11,022 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,130 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,130 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,130 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,130 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:05:11,130 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,235 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,236 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,236 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,236 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:05:11,236 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,336 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,337 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,337 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,337 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:05:11,337 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,463 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:05:11,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:05:11,464 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:11,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:05:11,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:05:11,464 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:05:11,464 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:05:11,465 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,660 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:11,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:05:12,373 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:05:12,374 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:05:12,374 - tensor_defense - INFO - 
clean:
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,374 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:05:12,374 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,375 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,376 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:05:12,376 - tensor_defense - INFO -   Recall@1: 0.0000
2025-04-20 12:05:12,377 - tensor_defense - INFO -   Recall@5: 0.0000
2025-04-20 12:05:12,377 - tensor_defense - INFO -   Recall@10: 0.0000
2025-04-20 12:05:12,377 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:05:12,462 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:05:12,475 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:05:12,476 - tensor_defense - INFO - Experiment completed
2025-04-20 12:06:08,267 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:06:08,282 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:06:08,284 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:06:10,030 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:06:10,031 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:06:11,608 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:06:11,609 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:06:11,609 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:06:11,609 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:06:11,609 - tensor_defense - INFO - Processing batches...
2025-04-20 12:06:16,144 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:06:17,978 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:06:18,322 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:06:18,668 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:06:19,019 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:06:19,368 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:06:19,368 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:06:19,537 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:19,538 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:19,538 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,718 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:19,719 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:19,719 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,719 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:19,861 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:19,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,989 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:19,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:19,990 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:19,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:19,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,200 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,200 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,200 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:20,200 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,319 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,319 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,319 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,319 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:20,319 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,436 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,437 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,437 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,437 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:20,437 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,541 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,542 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,542 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,542 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:20,542 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,682 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,682 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:20,683 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:20,683 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:20,683 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:20,683 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:20,683 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:20,683 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:20,683 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,901 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:20,902 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:20,941 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:06:21,965 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:21,965 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:21,965 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:21,965 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:22,092 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,092 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:22,092 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:22,092 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:22,092 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,217 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:22,217 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:22,217 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:22,217 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,340 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,341 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,341 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,341 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:22,341 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,540 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:22,540 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,663 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,663 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,664 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:22,664 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,780 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,781 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,781 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,781 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:22,781 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,876 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:22,876 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:22,876 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:22,877 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:22,877 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,019 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,019 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:23,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:23,020 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:23,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:23,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:23,020 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:23,020 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:23,020 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,239 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:23,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:23,259 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:06:24,369 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:24,369 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:24,369 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,369 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:24,497 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,497 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:24,498 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:24,498 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,498 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,614 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,614 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:24,615 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:24,615 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,734 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,734 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:24,735 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:24,735 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:24,735 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:24,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:24,933 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:24,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:24,933 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,052 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,053 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,053 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,053 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:25,053 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,173 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,174 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,174 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,174 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:25,174 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,283 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,283 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,284 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,284 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:25,284 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,424 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,424 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:25,425 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:25,425 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:25,425 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:25,425 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:25,425 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:25,425 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:25,425 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,650 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:25,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:25,670 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:06:26,002 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,002 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,003 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,003 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:26,107 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,108 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:06:26,108 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:06:26,108 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,108 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,162 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,162 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:06:26,162 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:06:26,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,163 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,264 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,264 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,264 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,265 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,265 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,324 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,324 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,324 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,324 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:06:26,325 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,427 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,427 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,427 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,427 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:06:26,427 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,525 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,525 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,525 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,525 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:06:26,525 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,615 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,615 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,615 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,616 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:06:26,616 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,735 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,736 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:06:26,736 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:06:26,736 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,736 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:06:26,736 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:06:26,736 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:06:26,736 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:06:26,736 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,939 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:26,940 - tensor_defense - INFO - All hooks removed
2025-04-20 12:06:27,655 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:06:27,655 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:06:27,655 - tensor_defense - INFO - 
clean:
2025-04-20 12:06:27,655 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:06:27,655 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@5: 0.2734
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,656 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:06:27,656 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,657 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@1: 0.3516
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:06:27,657 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:06:27,658 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:06:27,658 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@5: 0.3359
2025-04-20 12:06:27,658 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 12:06:27,658 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:06:27,743 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:06:27,756 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:06:27,757 - tensor_defense - INFO - Experiment completed
2025-04-20 12:07:58,762 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:07:58,787 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:07:58,789 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:08:00,391 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:08:00,392 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:08:02,206 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:08:02,206 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:08:02,206 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:08:02,206 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:08:02,206 - tensor_defense - INFO - Processing batches...
2025-04-20 12:08:06,718 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:08:08,585 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:08:08,926 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:08:09,267 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:08:09,622 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:08:09,968 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:08:09,968 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:08:10,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,210 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,210 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:10,210 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:10,210 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,210 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,336 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,337 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:10,337 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:10,337 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,337 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,444 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,444 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,444 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:10,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,661 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,661 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,661 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,661 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:10,662 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,779 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,779 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:10,779 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,907 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:10,907 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:10,908 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:10,908 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:10,908 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,004 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,005 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:11,005 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:11,005 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:11,005 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,146 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,146 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:11,147 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:11,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:11,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:11,147 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:11,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:11,147 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:11,147 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:11,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:11,378 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:08:12,415 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:12,415 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:12,415 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,415 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:12,539 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:12,539 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:12,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,539 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,663 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:12,663 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:12,663 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,663 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,800 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:12,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:12,801 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:12,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:12,801 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,002 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,003 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,003 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,003 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:13,003 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,127 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,128 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,128 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,128 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:13,128 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,253 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,253 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,253 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,253 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:13,254 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,355 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,356 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,356 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:13,356 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,494 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,495 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:13,495 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:13,495 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:13,495 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:13,495 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:13,495 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:13,495 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:13,495 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:13,714 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:13,730 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:08:14,847 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:14,847 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:14,848 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:14,848 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:14,973 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:14,973 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:14,974 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:14,974 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:14,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,103 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,104 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:15,104 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:15,104 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,104 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,216 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,216 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,216 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,216 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,216 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,421 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,422 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,422 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:15,422 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,545 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,545 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,545 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:15,545 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,670 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,670 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:15,671 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,774 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:15,774 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,915 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:15,915 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:15,915 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:15,915 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:15,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:15,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:15,916 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:15,916 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,140 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:16,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,159 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:08:16,491 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,491 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,492 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,492 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:16,618 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,619 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:08:16,619 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:08:16,619 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,619 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,649 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,649 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:08:16,649 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:08:16,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,650 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,754 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,755 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,755 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:16,755 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,814 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,815 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,815 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,815 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:08:16,815 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,921 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:16,921 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:16,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:16,921 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:08:16,922 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,024 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,024 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:17,024 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:17,024 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:08:17,024 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,115 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,115 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:17,115 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:17,115 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:08:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,243 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,244 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:08:17,244 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:08:17,244 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:17,244 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:08:17,244 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:08:17,244 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:08:17,245 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:08:17,245 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:17,443 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:17,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:08:18,164 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:08:18,164 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:08:18,164 - tensor_defense - INFO - 
clean:
2025-04-20 12:08:18,164 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:08:18,164 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:08:18,164 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2500
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,165 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:08:18,165 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:08:18,166 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 12:08:18,166 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:08:18,167 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 12:08:18,167 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 12:08:18,167 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:08:18,254 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:08:18,266 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:08:18,267 - tensor_defense - INFO - Experiment completed
2025-04-20 12:12:20,244 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:12:20,259 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:12:20,262 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:12:21,705 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:12:21,706 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:12:23,259 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:12:23,259 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:12:23,260 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:12:23,260 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:12:23,260 - tensor_defense - INFO - Processing batches...
2025-04-20 12:12:27,793 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:12:29,670 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:12:30,013 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:12:30,359 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:12:30,709 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:12:31,052 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:12:31,053 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:12:31,219 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,219 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,219 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,401 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:31,401 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:31,401 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,401 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,538 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,538 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:31,538 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:31,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,539 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,670 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,670 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,671 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,671 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:31,671 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,879 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,879 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,879 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,879 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:31,879 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:31,997 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:31,997 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:31,997 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:31,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,114 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:32,114 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:32,114 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:32,114 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,212 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,213 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:32,213 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:32,213 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:32,213 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,363 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:32,363 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:32,363 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:32,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:32,364 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:32,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:32,364 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:32,364 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:32,578 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:32,619 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:12:33,730 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:33,731 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:33,731 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:33,731 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:33,859 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:33,859 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:33,860 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:33,860 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:33,860 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:33,976 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:33,977 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:33,977 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:33,977 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:33,977 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,083 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,084 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,084 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,084 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:34,084 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,286 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,287 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:34,287 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,418 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,419 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,419 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,419 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:34,419 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,536 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,536 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,536 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,536 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:34,536 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,618 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,618 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,618 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:34,618 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,756 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:34,756 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:34,756 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:34,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:34,757 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:34,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:34,757 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:34,757 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,974 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:34,975 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:34,990 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:12:36,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,187 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,187 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:36,321 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,321 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:36,321 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:36,321 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,322 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,444 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,445 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:36,445 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:36,445 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,445 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,557 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,557 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,557 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,558 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:36,558 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,758 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,759 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:36,759 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,882 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:36,882 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:36,882 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:36,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:36,882 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,014 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,014 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,015 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,015 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:37,015 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,107 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,108 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,108 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,108 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:37,108 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,248 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,248 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,248 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,248 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,248 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:37,248 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:37,249 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,249 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:37,249 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:37,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,490 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:12:37,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:37,816 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:37,816 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,817 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:37,918 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,919 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:12:37,919 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:12:37,919 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,919 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:37,964 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:12:37,964 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:12:37,964 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:37,964 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,068 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,069 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,069 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,069 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:38,069 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,125 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,125 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,125 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,126 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:12:38,126 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,225 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,225 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,225 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,225 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:12:38,226 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,334 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,334 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,335 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,335 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:12:38,335 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,434 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,435 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,435 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,435 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:12:38,435 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,558 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,558 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:12:38,558 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:12:38,559 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:38,559 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:12:38,559 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:12:38,559 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:12:38,559 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:12:38,559 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,752 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,752 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,752 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:38,753 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:38,753 - tensor_defense - INFO - All hooks removed
2025-04-20 12:12:39,474 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:12:39,474 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:12:39,474 - tensor_defense - INFO - 
clean:
2025-04-20 12:12:39,474 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:12:39,475 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:12:39,475 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:12:39,475 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:12:39,475 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 12:12:39,476 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:12:39,476 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:12:39,476 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:12:39,476 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:12:39,477 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:12:39,477 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:12:39,478 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 12:12:39,478 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 12:12:39,478 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 12:12:39,478 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:12:39,564 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:12:39,577 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:12:39,578 - tensor_defense - INFO - Experiment completed
2025-04-20 12:35:25,921 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:35:25,936 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:35:25,938 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:35:27,365 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:35:27,365 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:35:29,855 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:35:29,855 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:35:29,855 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:35:29,855 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:35:29,855 - tensor_defense - INFO - Processing batches...
2025-04-20 12:35:34,230 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:35:36,119 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:35:36,468 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:35:36,826 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:35:37,180 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:35:37,535 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:35:37,535 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:35:37,619 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:37,619 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:37,619 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:37,809 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:37,810 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:35:37,810 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:35:37,810 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:37,810 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:37,941 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:37,941 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:35:37,941 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:35:37,941 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:37,941 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,071 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,071 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:38,071 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:38,071 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:38,072 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,323 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,323 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:38,323 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:38,323 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:35:38,323 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,474 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,474 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:38,474 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:38,474 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:35:38,474 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,594 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,595 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:38,595 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:38,595 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:35:38,595 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,696 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,696 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:38,696 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:38,696 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:35:38,696 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,836 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:38,836 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:38,836 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:38,836 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:38,837 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:35:38,837 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:35:38,837 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:38,837 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:35:38,837 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:39,061 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:39,061 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:39,061 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:39,061 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:39,061 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:39,089 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:35:40,218 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:40,218 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:40,218 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:40,218 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:40,360 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,360 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:35:40,360 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:35:40,360 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:40,360 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,485 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:35:40,485 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:35:40,485 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:40,485 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,587 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,587 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:40,587 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:40,587 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:40,588 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,791 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,792 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:40,792 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:40,792 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:35:40,792 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,907 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:40,908 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:40,908 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:40,908 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:35:40,908 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,022 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,022 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:41,022 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:41,023 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:35:41,023 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,106 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,106 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:41,106 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:41,106 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:35:41,107 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,241 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,242 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:41,242 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:41,242 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:41,242 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:35:41,242 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:35:41,242 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:41,242 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:35:41,243 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,467 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,467 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,468 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:41,468 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:41,497 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:35:42,721 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:42,721 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:42,721 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:42,721 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:42,861 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:42,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:35:42,862 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:35:42,862 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:42,862 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:42,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:42,990 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:35:42,990 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:35:42,990 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:42,990 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,100 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:43,100 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:43,100 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:43,100 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,305 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:43,306 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:43,306 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:35:43,306 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,438 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,438 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:43,438 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:43,438 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:35:43,438 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,566 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,567 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:43,567 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:43,567 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:35:43,567 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,674 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,674 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:43,674 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:43,674 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:35:43,674 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,823 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:43,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:43,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:43,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:43,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:35:43,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:35:43,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:43,824 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:35:43,824 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,054 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,054 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,054 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,054 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:44,055 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,075 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:35:44,456 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:44,457 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:44,457 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:44,457 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:44,579 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,579 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:35:44,579 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:35:44,579 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:44,579 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,640 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,641 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:35:44,641 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:35:44,641 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:44,641 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,760 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,761 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:44,761 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:44,761 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:44,761 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,827 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:44,828 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:44,828 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:35:44,828 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,944 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:44,944 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:44,944 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:44,944 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:35:44,945 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,054 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,054 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:45,054 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:45,054 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:35:45,054 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,163 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:45,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:45,163 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:35:45,163 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,294 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:35:45,294 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:35:45,294 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:45,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:35:45,295 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:35:45,295 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:35:45,295 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:35:45,295 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:45,516 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:45,516 - tensor_defense - INFO - All hooks removed
2025-04-20 12:35:46,359 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:35:46,360 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:35:46,360 - tensor_defense - INFO - 
clean:
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:35:46,360 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:35:46,360 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:35:46,360 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:35:46,361 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:35:46,361 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 12:35:46,361 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:35:46,361 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:35:46,361 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:35:46,362 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:35:46,362 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:35:46,362 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:35:46,362 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:35:46,362 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-20 12:35:46,363 - tensor_defense - INFO -   Recall@5: 0.3359
2025-04-20 12:35:46,363 - tensor_defense - INFO -   Recall@10: 0.4297
2025-04-20 12:35:46,363 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:35:46,474 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:35:46,486 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:35:46,488 - tensor_defense - INFO - Experiment completed
2025-04-20 12:47:08,802 - src.utils.visualization - INFO - Enhanced visualization utilities loaded successfully.
2025-04-20 12:51:44,373 - tensor_defense - INFO - Running experiment with config: config.yaml
2025-04-20 12:51:44,386 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:51:44,389 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:51:45,800 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:51:45,801 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:51:47,538 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:51:47,538 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:51:47,538 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:51:47,538 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:51:47,539 - tensor_defense - INFO - Processing batches...
2025-04-20 12:51:51,989 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:51:53,943 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:51:54,294 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:51:54,633 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:51:54,984 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:51:55,324 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:51:55,325 - tensor_defense - INFO - Saved 5 sample image pairs to results\samples
2025-04-20 12:51:55,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:55,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:55,464 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:55,659 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:55,659 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:51:55,660 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:51:55,660 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:55,660 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:55,788 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:55,788 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:51:55,788 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:51:55,788 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:55,788 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:55,896 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:55,896 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:55,896 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:55,896 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:55,897 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,108 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,108 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:56,108 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:56,108 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:51:56,108 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,229 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,229 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:56,230 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:56,230 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:51:56,230 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,350 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,351 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:56,351 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:56,351 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:51:56,351 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:56,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:56,447 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:51:56,447 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,584 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,585 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:56,585 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:56,585 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:56,585 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:51:56,585 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:51:56,585 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:56,585 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:51:56,585 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,796 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,796 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,796 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,796 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:51:56,796 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:56,834 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:51:57,880 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:57,880 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:57,880 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:57,880 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:51:58,004 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,004 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:51:58,004 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:51:58,004 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:58,004 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,123 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,124 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:51:58,124 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:51:58,124 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:58,124 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,232 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,232 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:58,232 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:58,232 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:58,232 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,442 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,442 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:58,442 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:58,443 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:51:58,443 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,562 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,562 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:58,562 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:58,562 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:51:58,562 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,680 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,681 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:58,681 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:58,681 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:51:58,681 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,788 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,788 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:58,788 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:58,788 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:51:58,788 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,928 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:58,928 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:51:58,928 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:51:58,928 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:58,928 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:51:58,929 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:51:58,929 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:51:58,929 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:51:58,929 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:59,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:59,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:59,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:59,141 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:51:59,141 - tensor_defense - INFO - All hooks removed
2025-04-20 12:51:59,159 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:52:00,282 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:00,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:00,282 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:00,282 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:52:00,404 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,404 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:52:00,404 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:52:00,405 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:00,405 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,529 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,529 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:52:00,529 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:52:00,529 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:00,530 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,640 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:00,640 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:00,640 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:00,640 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,847 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:00,847 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:00,847 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:52:00,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,967 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:00,967 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:00,967 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:00,967 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:52:00,967 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,082 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,082 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:01,083 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:01,083 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:52:01,083 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,178 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,179 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:01,179 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:01,179 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:52:01,179 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,317 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,317 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:01,317 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:01,317 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:01,317 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:52:01,317 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:52:01,317 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:01,317 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:52:01,318 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,532 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,532 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,532 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,533 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:52:01,533 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,555 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:52:01,891 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:01,891 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:01,891 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:01,891 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:52:01,997 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:01,998 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:52:01,998 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:52:01,998 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:01,998 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,048 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,049 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:52:02,049 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:52:02,049 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:02,049 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,153 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,153 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:02,153 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:02,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:02,153 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,212 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,213 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:02,213 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:02,213 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:52:02,213 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,320 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,320 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:02,321 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:02,321 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:52:02,321 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,421 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,421 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:02,421 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:02,421 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:52:02,421 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,515 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,516 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:02,516 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:02,516 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:52:02,516 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,643 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:52:02,644 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:52:02,644 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:02,644 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:52:02,644 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:52:02,644 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:52:02,644 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:52:02,644 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,847 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,848 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:02,848 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:52:02,848 - tensor_defense - INFO - All hooks removed
2025-04-20 12:52:03,568 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:52:03,568 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:52:03,568 - tensor_defense - INFO - 
clean:
2025-04-20 12:52:03,568 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:52:03,568 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:52:03,568 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:52:03,569 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:52:03,569 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@10: 0.3984
2025-04-20 12:52:03,569 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:52:03,569 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:52:03,569 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:52:03,570 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:52:03,570 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:52:03,570 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:52:03,570 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:52:03,570 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:52:03,570 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:52:03,571 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:52:03,571 - tensor_defense - INFO -   Recall@1: 0.3516
2025-04-20 12:52:03,571 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 12:52:03,571 - tensor_defense - INFO -   Recall@10: 0.4297
2025-04-20 12:52:03,571 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:52:05,204 - tensor_defense - INFO - All paper figures saved to results\figures
2025-04-20 12:52:05,204 - tensor_defense - INFO - All visualization plots saved to results\figures
2025-04-20 12:52:05,204 - tensor_defense - INFO - Experiment completed. Results saved to results
2025-04-20 12:52:05,216 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:52:05,217 - tensor_defense - INFO - Experiment completed
2025-04-20 12:56:26,865 - tensor_defense - INFO - Running experiment: config
2025-04-20 12:56:26,865 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-20 12:56:26,876 - tensor_defense - INFO - Using device: cuda
2025-04-20 12:56:26,879 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 12:56:28,277 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 12:56:28,277 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 12:56:29,912 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 12:56:29,913 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 12:56:29,913 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 12:56:29,913 - root - INFO - Random start: True, Targeted: False
2025-04-20 12:56:29,913 - tensor_defense - INFO - Processing batches...
2025-04-20 12:56:34,416 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 12:56:36,200 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 12:56:36,539 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 12:56:36,876 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 12:56:37,223 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 12:56:37,573 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 12:56:37,573 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-20 12:56:37,646 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:37,647 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:37,647 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:37,815 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:37,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:56:37,816 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:56:37,816 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:37,816 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:37,952 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:37,953 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:56:37,953 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:56:37,953 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:37,953 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,065 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:38,066 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:38,066 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:38,066 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,276 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,276 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:38,276 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:38,276 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:56:38,277 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,403 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,404 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:38,404 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:38,404 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:56:38,404 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,529 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,529 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:38,529 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:38,529 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:56:38,530 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,626 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,626 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:38,626 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:38,627 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:56:38,627 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,767 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,767 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:38,767 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:38,767 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:38,767 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:56:38,767 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:56:38,768 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:38,768 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:56:38,768 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,981 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,981 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,981 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,982 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:38,982 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:38,998 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 12:56:40,106 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:40,106 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:40,106 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:40,106 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:40,236 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,237 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:56:40,237 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:56:40,237 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:40,237 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,377 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,377 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:56:40,377 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:56:40,377 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:40,377 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,489 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,489 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:40,489 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:40,489 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:40,489 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,690 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,691 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:40,691 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:40,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:56:40,691 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,810 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,810 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:40,810 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:40,810 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:56:40,810 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,921 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:40,921 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:40,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:40,922 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:56:40,922 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,042 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,042 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:41,042 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:41,042 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:56:41,042 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,183 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,183 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:41,183 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:41,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:41,184 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:56:41,184 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:56:41,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:41,184 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:56:41,184 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,399 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,399 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,399 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,400 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:41,400 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:41,417 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 12:56:42,619 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:42,620 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:42,620 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:42,620 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:42,757 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:42,758 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:56:42,758 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:56:42,758 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:42,758 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:42,881 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:42,882 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:56:42,882 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:56:42,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:42,882 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,036 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,036 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:43,036 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:43,036 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:43,036 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,240 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:43,240 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:43,240 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:56:43,240 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,361 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,361 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:43,361 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:43,362 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:56:43,362 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,489 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,490 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:43,490 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:43,490 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:56:43,490 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,581 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,581 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:43,581 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:43,581 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:56:43,581 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,729 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,729 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:43,729 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:43,729 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:43,730 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:56:43,730 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:56:43,730 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:43,730 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:56:43,730 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,942 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,943 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,943 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,943 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:43,943 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:43,962 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 12:56:44,301 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:44,301 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:44,301 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:44,301 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:44,407 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,407 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 12:56:44,407 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 12:56:44,407 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:44,407 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,466 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,466 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 12:56:44,466 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 12:56:44,466 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:44,466 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,572 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,572 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:44,572 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:44,572 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:44,572 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,628 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,629 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:44,629 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:44,629 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 12:56:44,629 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,725 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,725 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:44,725 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:44,726 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 12:56:44,726 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,834 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,834 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:44,835 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:44,835 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 12:56:44,835 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,935 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:44,936 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:44,936 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:44,936 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 12:56:44,936 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:45,055 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:45,055 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 12:56:45,055 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 12:56:45,055 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:45,055 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 12:56:45,055 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 12:56:45,055 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 12:56:45,055 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 12:56:45,055 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:45,249 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:45,249 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:45,250 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:45,250 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:45,250 - tensor_defense - INFO - All hooks removed
2025-04-20 12:56:45,968 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 12:56:45,968 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:56:45,968 - tensor_defense - INFO - 
clean:
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 12:56:45,969 - tensor_defense - INFO - 
adversarial:
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 12:56:45,969 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 12:56:45,969 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 12:56:45,969 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 12:56:45,970 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@1: 0.2500
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:56:45,970 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:56:45,970 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 12:56:45,970 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 12:56:45,970 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:56:45,971 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 12:56:45,971 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 12:56:45,971 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@1: 0.3594
2025-04-20 12:56:45,971 - tensor_defense - INFO -   Recall@5: 0.3438
2025-04-20 12:56:45,972 - tensor_defense - INFO -   Recall@10: 0.4453
2025-04-20 12:56:45,972 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 12:56:47,704 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-20 12:56:47,704 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-20 12:56:47,714 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-20 12:56:47,727 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 12:56:47,728 - tensor_defense - INFO - Experiment completed. Results available in results\config
2025-04-20 15:18:59,849 - tensor_defense - INFO - Running experiment: config
2025-04-20 15:18:59,850 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-20 15:18:59,860 - tensor_defense - INFO - Using device: cuda
2025-04-20 15:18:59,862 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 15:19:01,369 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 15:19:01,369 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 15:19:02,748 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 15:19:02,748 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 15:19:02,748 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 15:19:02,748 - root - INFO - Random start: True, Targeted: False
2025-04-20 15:19:02,748 - tensor_defense - INFO - Processing batches...
2025-04-20 15:19:07,175 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 15:19:08,957 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 15:19:09,296 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 15:19:09,642 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 15:19:09,993 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 15:19:10,341 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 15:19:10,342 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-20 15:19:10,416 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:10,416 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:10,416 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:10,594 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:10,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:19:10,594 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:19:10,595 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:10,595 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:10,727 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:10,728 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:19:10,728 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:19:10,728 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:10,728 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:10,841 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:10,841 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:10,841 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:10,841 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:10,841 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,053 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,053 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:11,054 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:11,054 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:19:11,054 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,183 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,184 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:11,184 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:11,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:19:11,184 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,306 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,307 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:11,307 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:11,307 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:19:11,307 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,409 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:11,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:11,409 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:19:11,409 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,549 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,549 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:11,549 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:11,549 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:11,549 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:19:11,549 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:19:11,549 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:11,549 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:19:11,550 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,766 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,766 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,766 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,766 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:19:11,766 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:11,794 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 15:19:12,841 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:12,841 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:12,841 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:12,841 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:19:12,963 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:12,963 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:19:12,963 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:19:12,963 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:12,963 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,077 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,078 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:19:13,078 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:19:13,078 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:13,078 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,192 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,193 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:13,193 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:13,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:13,193 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,392 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,392 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:13,392 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:13,393 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:19:13,393 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,505 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,505 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:13,505 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:13,505 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:19:13,506 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,620 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,620 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:13,620 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:13,620 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:19:13,620 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,720 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,720 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:13,720 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:13,720 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:19:13,720 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,860 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:13,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:13,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:13,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:13,861 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:19:13,861 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:19:13,861 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:13,861 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:19:13,862 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:14,076 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:14,076 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:14,076 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:14,076 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:19:14,076 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:14,094 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 15:19:15,212 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:15,212 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:15,212 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:15,212 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:19:15,333 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,333 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:19:15,334 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:19:15,334 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:15,334 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,454 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,455 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:19:15,455 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:19:15,455 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:15,455 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,568 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,568 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:15,568 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:15,568 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:15,568 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,769 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,769 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:15,769 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:15,770 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:19:15,770 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,893 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:15,894 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:15,894 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:15,894 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:19:15,894 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,015 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,015 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:16,015 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:16,015 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:19:16,015 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,113 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,113 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:16,113 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:16,113 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:19:16,114 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,250 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,251 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:16,251 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:16,251 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:16,251 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:19:16,251 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:19:16,251 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:16,251 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:19:16,251 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,469 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,469 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,470 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,470 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:19:16,470 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,488 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 15:19:16,827 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:16,827 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:16,827 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:16,827 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:19:16,931 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:19:16,931 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:19:16,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:16,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,985 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:16,986 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:19:16,986 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:19:16,986 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:16,986 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,089 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,089 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:17,089 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:17,089 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:17,090 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,147 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:17,148 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:17,148 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:19:17,148 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,254 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,254 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:17,254 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:17,254 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:19:17,254 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,367 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,368 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:17,368 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:17,368 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:19:17,368 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,463 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:17,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:17,464 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:19:17,464 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,589 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:19:17,589 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:19:17,590 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:17,590 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:19:17,590 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:19:17,590 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:19:17,590 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:19:17,590 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,793 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,793 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,793 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:17,793 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:19:17,793 - tensor_defense - INFO - All hooks removed
2025-04-20 15:19:18,515 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 15:19:18,515 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:19:18,515 - tensor_defense - INFO - 
clean:
2025-04-20 15:19:18,515 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 15:19:18,516 - tensor_defense - INFO - 
adversarial:
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:19:18,516 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:19:18,516 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 15:19:18,516 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@5: 0.2734
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:19:18,517 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:19:18,517 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:19:18,517 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:19:18,517 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 15:19:18,517 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:19:18,518 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@10: 0.3984
2025-04-20 15:19:18,518 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:19:18,518 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 15:19:18,518 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 15:19:18,518 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:19:20,233 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-20 15:19:20,233 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-20 15:19:20,238 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-20 15:19:20,250 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:04,742 - tensor_defense - INFO - Running experiment: sweep_config
2025-04-20 15:24:04,743 - tensor_defense - INFO - Results will be saved to: results/sweep_results\sweep_config
2025-04-20 15:24:04,754 - tensor_defense - INFO - Using device: cuda
2025-04-20 15:24:04,756 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 15:24:06,268 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 15:24:06,268 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 15:24:07,639 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 15:24:07,639 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 15:24:07,640 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 15:24:07,640 - root - INFO - Random start: True, Targeted: False
2025-04-20 15:24:07,640 - tensor_defense - INFO - Processing batches...
2025-04-20 15:24:12,092 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 15:24:13,871 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 15:24:14,208 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 15:24:14,544 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 15:24:14,889 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 15:24:15,228 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 15:24:15,229 - tensor_defense - INFO - Saved 5 sample image pairs to results/sweep_results\sweep_config\samples
2025-04-20 15:24:15,302 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:15,302 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:15,302 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:24:15,461 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,461 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:15,461 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:15,462 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:24:15,462 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,590 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,590 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:15,590 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:15,591 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:24:15,591 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,712 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,712 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:15,712 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:15,713 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:24:15,713 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,836 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,836 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:15,836 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:15,837 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:15,837 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,956 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:15,957 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:15,957 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:15,957 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:24:15,957 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,075 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,075 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,075 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,075 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:24:16,075 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,197 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,197 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,197 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,197 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:24:16,198 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,313 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,314 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,314 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,314 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:24:16,314 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,434 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,434 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,435 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,435 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:24:16,435 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,518 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,518 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,518 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:24:16,518 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,612 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,612 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,612 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,612 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:16,612 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,733 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,733 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,733 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,733 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:24:16,733 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,871 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:16,871 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:16,872 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:16,872 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:24:16,872 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,055 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,055 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:17,055 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:17,055 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,056 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,174 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,175 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:17,175 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:17,175 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,175 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,294 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:17,295 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:17,295 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,295 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,402 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,402 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:24:17,403 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,403 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,424 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,425 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:24:17,425 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,425 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,445 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,446 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:17,446 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:17,446 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,446 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,664 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,664 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:17,665 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:17,665 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,665 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:17,665 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:17,665 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,665 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:17,665 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,881 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,881 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,881 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,882 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:17,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:17,882 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:17,882 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:17,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,882 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:17,882 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:17,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:17,883 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:17,883 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:18,095 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,095 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,095 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,095 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:18,096 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,096 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:18,096 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:18,096 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,096 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:18,096 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:18,096 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,096 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:18,096 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:18,336 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,336 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,336 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,337 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:18,337 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,337 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:18,337 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:18,337 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,337 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:18,337 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:18,337 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,337 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:18,337 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:18,338 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,338 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:24:18,338 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:18,649 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,649 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,650 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,650 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,650 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,650 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:18,650 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:18,650 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:18,650 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:18,650 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,650 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:18,650 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:18,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:18,651 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:18,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:18,651 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:18,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:18,651 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:24:18,651 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:19,058 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,058 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,058 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,058 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,058 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,058 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,059 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,059 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:19,059 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,059 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:19,059 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:19,059 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:19,059 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:19,059 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:19,059 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:19,059 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:19,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:19,060 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:19,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:19,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:19,060 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:19,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:24:19,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:24:19,060 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:19,060 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:24:19,060 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:19,586 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,587 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,588 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:19,588 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:19,600 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 15:24:20,647 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:20,647 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:20,647 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:24:20,647 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:20,771 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:20,771 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:20,772 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:20,772 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:24:20,772 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:20,892 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:20,892 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:20,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:20,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:24:20,893 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,020 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,020 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,020 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,020 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:24:21,020 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,143 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,143 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,143 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,143 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:21,143 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,259 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,259 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,259 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,259 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:24:21,259 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,383 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,383 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,383 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,383 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:24:21,383 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,508 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,508 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,509 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,509 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:24:21,509 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,632 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,633 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,633 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,633 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:24:21,633 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,764 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,764 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,764 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,765 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:24:21,765 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,860 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,860 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,860 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,860 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:24:21,860 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,946 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:21,946 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:21,946 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:21,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:21,947 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,066 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,067 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:22,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:22,067 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:24:22,067 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,208 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,208 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:22,208 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:22,208 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:24:22,208 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,394 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,395 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:22,395 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:22,395 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:22,395 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,513 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,514 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:22,514 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:22,514 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:22,514 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,646 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,646 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:22,646 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:22,646 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:22,646 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,753 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,753 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:24:22,754 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:22,754 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,775 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,775 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:24:22,775 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:22,775 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,799 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:22,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:22,800 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:22,800 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:22,800 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,008 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,008 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:23,009 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:23,009 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,009 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:23,009 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:23,009 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,009 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:23,009 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,222 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,222 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,222 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,222 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:23,223 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,223 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:23,223 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:23,223 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,223 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:23,223 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:23,223 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,223 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:23,224 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:23,439 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,439 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,439 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,440 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:23,440 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,440 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:23,440 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:23,440 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,440 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:23,440 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:23,440 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,440 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:23,441 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:23,660 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,660 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,661 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,661 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:23,661 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,661 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:23,661 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:23,661 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,661 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:23,662 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:23,662 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,662 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:23,662 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:23,662 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,662 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:24:23,662 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:23,973 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,974 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,974 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,974 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,974 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,974 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:23,974 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:23,974 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:23,974 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:23,974 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:23,975 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:23,975 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:23,975 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:23,975 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:23,975 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:23,975 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:23,975 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:24:23,975 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:24,395 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:24,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:24,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:24,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:24,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:24,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:24,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:24,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:24,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:24,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:24,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:24,398 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:24,398 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:24,398 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:24:24,398 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:24:24,398 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:24,398 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:24:24,398 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:24,904 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,904 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:24,905 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:24,920 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 15:24:26,037 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,037 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,037 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:24:26,037 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:26,166 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,166 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,166 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,166 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:24:26,166 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,290 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,290 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:24:26,290 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,412 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,413 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,413 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:24:26,413 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,534 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,534 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,534 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,534 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:26,534 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,657 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,657 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,657 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,657 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:24:26,657 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,776 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,776 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,776 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,776 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:24:26,776 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,896 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:26,897 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:26,897 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:26,897 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:24:26,897 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,016 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:27,017 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:27,017 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:24:27,017 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,137 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,137 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:27,137 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:27,137 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:24:27,137 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,216 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,216 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:27,216 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:27,217 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:24:27,217 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,345 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,345 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:27,345 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:27,346 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:27,346 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,467 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,467 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:27,467 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:27,467 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:24:27,467 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,602 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,602 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:27,602 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:27,603 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:24:27,603 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,786 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,786 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:27,786 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:27,786 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:27,786 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,900 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:27,900 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:27,900 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:27,900 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:27,900 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,022 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,023 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:28,023 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:28,023 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,023 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,124 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,125 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:24:28,125 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,125 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,146 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,146 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:24:28,146 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,146 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,171 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,171 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:28,171 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:28,171 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,172 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,374 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,374 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:28,375 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:28,375 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,375 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:28,375 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:28,375 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,375 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:28,375 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,596 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,597 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,597 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,597 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:28,597 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,597 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:28,597 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:28,598 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,598 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:28,598 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:28,598 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,598 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:28,598 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:28,820 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,820 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,820 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,820 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:28,820 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:28,820 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:28,820 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:28,820 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,821 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:28,821 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:28,821 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:28,821 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:28,821 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:29,044 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,044 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,044 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,045 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:29,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:29,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:29,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:29,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:29,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:29,046 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:29,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,046 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:24:29,046 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:29,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,366 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:29,366 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,366 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:29,366 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:29,366 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,366 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:29,366 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:29,367 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,367 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:29,367 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:29,367 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,367 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:29,367 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:29,367 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,367 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:24:29,367 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:29,782 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,782 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,782 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,782 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,782 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,782 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,783 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,783 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:29,783 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:29,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:29,783 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:29,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:29,783 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:29,783 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:29,783 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:29,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,784 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:29,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:29,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,784 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:24:29,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:24:29,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:29,784 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:24:29,784 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:30,285 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,285 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:30,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,306 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 15:24:30,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:30,652 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:30,652 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:24:30,652 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:30,756 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,757 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:30,757 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:30,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:24:30,757 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,863 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,864 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:30,864 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:30,864 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:24:30,864 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,971 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:30,971 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:30,971 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:30,971 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:24:30,971 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,079 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,079 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,079 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,079 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:31,079 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,179 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,179 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,179 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,179 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:24:31,179 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,285 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,286 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,286 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:24:31,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,390 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,390 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,391 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,391 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:24:31,391 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,493 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,493 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,493 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,493 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:24:31,493 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,593 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,593 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,593 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,593 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:24:31,593 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,682 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,682 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,683 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,683 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:24:31,683 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,775 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,775 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,775 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:31,775 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,876 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,876 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,877 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,877 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:24:31,877 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,998 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:31,999 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:31,999 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:31,999 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:24:31,999 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:32,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:32,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,265 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,265 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:32,265 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:32,265 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,266 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,304 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,304 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:32,304 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:32,304 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,304 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,409 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,409 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:24:32,409 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,410 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,415 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,415 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:24:32,415 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,416 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,422 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:32,422 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:32,422 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,422 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,480 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,480 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:32,480 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:32,480 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,481 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:24:32,481 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:24:32,481 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,481 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:32,481 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,638 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,638 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,638 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,638 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:32,638 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:32,638 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:32,638 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,639 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:24:32,639 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:24:32,639 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,639 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:32,639 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:32,834 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,834 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,834 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,834 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:32,835 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:32,835 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:32,835 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:32,835 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,835 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:32,835 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:32,835 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:32,835 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:24:32,835 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:33,044 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,044 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,044 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,045 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:33,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:33,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:33,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:33,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:33,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:33,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:33,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,046 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:24:33,046 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:33,345 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,345 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,346 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,346 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,346 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,346 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:33,346 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,346 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:33,346 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:33,347 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,347 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:33,347 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:33,347 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,347 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:33,347 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:33,347 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,347 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:33,347 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:33,347 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,347 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:24:33,347 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:33,739 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,739 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:33,740 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:24:33,741 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:24:33,741 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,741 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:24:33,741 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:24:33,741 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,741 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:24:33,741 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:24:33,741 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,741 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:24:33,741 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:24:33,742 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,742 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:24:33,742 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:24:33,742 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:24:33,742 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:24:33,742 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:34,240 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,240 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,240 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:24:34,241 - tensor_defense - INFO - All hooks removed
2025-04-20 15:24:34,968 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 15:24:34,968 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:24:34,968 - tensor_defense - INFO - 
clean:
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 15:24:34,969 - tensor_defense - INFO - 
adversarial:
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:24:34,969 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.1):
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:24:34,969 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.2):
2025-04-20 15:24:34,969 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:24:34,970 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:24:34,970 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.4):
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:24:34,970 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:24:34,970 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.6):
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:24:34,970 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:24:34,971 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:24:34,971 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.8):
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:24:34,971 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.9):
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@1: 0.2422
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:24:34,971 - tensor_defense - INFO - 
CP Final Norm (R=16, alpha=0.5):
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@1: 0.3516
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:24:34,971 - tensor_defense - INFO -   Recall@10: 0.3984
2025-04-20 15:24:34,972 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:24:34,972 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:24:34,972 - tensor_defense - INFO - 
CP Final Norm (R=256, alpha=0.5):
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:24:34,972 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:24:34,972 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:24:34,973 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:24:34,973 - tensor_defense - INFO - 
CP QKV (R=64, alpha=0.5):
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:24:34,973 - tensor_defense - INFO - 
CP Projection (R=64, alpha=0.5):
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:24:34,973 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:24:34,973 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:24:34,974 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + Attention):
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:24:34,974 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + MLP):
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:24:34,974 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:24:34,974 - tensor_defense - INFO - 
CP Multi-Layer (Last 2 Layers):
2025-04-20 15:24:34,975 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-20 15:24:34,975 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:24:34,975 - tensor_defense - INFO -   Recall@10: 0.4453
2025-04-20 15:24:34,975 - tensor_defense - INFO - 
CP Multi-Layer (Last 3 Layers):
2025-04-20 15:24:34,975 - tensor_defense - INFO -   Recall@1: 0.3906
2025-04-20 15:24:34,975 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 15:24:34,975 - tensor_defense - INFO -   Recall@10: 0.4922
2025-04-20 15:24:34,975 - tensor_defense - INFO - 
CP Multi-Layer (Last 4 Layers):
2025-04-20 15:24:34,975 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 15:24:34,976 - tensor_defense - INFO -   Recall@5: 0.3828
2025-04-20 15:24:34,976 - tensor_defense - INFO -   Recall@10: 0.4844
2025-04-20 15:24:34,976 - tensor_defense - INFO - 
CP Multi-Layer (Last 5 Layers):
2025-04-20 15:24:34,976 - tensor_defense - INFO -   Recall@1: 0.4453
2025-04-20 15:24:34,976 - tensor_defense - INFO -   Recall@5: 0.4453
2025-04-20 15:24:34,976 - tensor_defense - INFO -   Recall@10: 0.5469
2025-04-20 15:24:34,976 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:24:37,085 - tensor_defense - INFO - All paper figures saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:24:37,085 - tensor_defense - INFO - All visualization plots saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:24:37,093 - tensor_defense - INFO - Experiment sweep_config completed. Results saved to results/sweep_results\sweep_config
2025-04-20 15:24:37,106 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:02,391 - tensor_defense - INFO - Running experiment: sweep_config
2025-04-20 15:29:02,391 - tensor_defense - INFO - Results will be saved to: results/sweep_results\sweep_config
2025-04-20 15:29:02,401 - tensor_defense - INFO - Using device: cuda
2025-04-20 15:29:02,403 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 15:29:04,104 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 15:29:04,104 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 15:29:05,488 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 15:29:05,488 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 15:29:05,488 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 15:29:05,488 - root - INFO - Random start: True, Targeted: False
2025-04-20 15:29:05,488 - tensor_defense - INFO - Processing batches...
2025-04-20 15:29:09,960 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 15:29:11,823 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 15:29:12,165 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 15:29:12,511 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 15:29:12,859 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 15:29:13,210 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 15:29:13,211 - tensor_defense - INFO - Saved 5 sample image pairs to results/sweep_results\sweep_config\samples
2025-04-20 15:29:13,341 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:13,342 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:13,342 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:29:13,536 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:13,537 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:13,537 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:13,537 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:29:13,537 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:13,661 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:13,661 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:13,662 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:13,662 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:29:13,662 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:13,776 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:13,777 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:13,777 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:13,777 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:29:13,777 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:13,900 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:13,900 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:13,900 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:13,900 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:13,900 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,021 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,021 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,021 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,021 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:29:14,021 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,156 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,156 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,156 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,157 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:29:14,157 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,279 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,279 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,280 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,280 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:29:14,280 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,399 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,399 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,399 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,399 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:29:14,399 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,519 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,519 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,519 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,520 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:29:14,520 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,588 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,589 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,589 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:29:14,589 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,694 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,694 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,694 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,694 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:14,694 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,816 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,816 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,816 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:29:14,816 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,961 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:14,961 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:14,961 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:14,961 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:29:14,962 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,148 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,149 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:15,149 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:15,149 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,149 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,271 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,272 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:15,272 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:15,272 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,272 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,392 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,392 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:15,392 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:15,392 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,393 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,507 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,507 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:29:15,507 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,507 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,528 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,529 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:29:15,529 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,529 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,553 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,553 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:15,553 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:15,554 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,768 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,768 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:15,768 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:15,768 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,768 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:15,768 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:15,769 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,769 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:15,769 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,993 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,994 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,994 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,994 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:15,994 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:15,994 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:15,994 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:15,994 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,994 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:15,994 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:15,994 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:15,995 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:15,995 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:16,216 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,217 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,217 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,217 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:16,217 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,217 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:16,217 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:16,217 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,217 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:16,218 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:16,218 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,218 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:16,218 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:16,445 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,446 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,446 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,446 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:16,446 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,446 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:16,446 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:16,446 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,446 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:16,446 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:16,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:16,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:16,447 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,447 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:29:16,447 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:16,755 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,756 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,756 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,756 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,756 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,756 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:16,756 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:16,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:16,756 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:16,756 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:16,756 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:16,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,757 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:16,757 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:16,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,757 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:16,757 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:16,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:16,757 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:29:16,757 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:17,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,181 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:17,181 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:17,181 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:17,181 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:17,181 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:17,181 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:17,181 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:17,181 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:17,181 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:17,182 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:17,182 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:17,182 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:17,182 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:29:17,182 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:29:17,182 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:17,182 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:29:17,182 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:17,689 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,689 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,689 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,689 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,690 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:17,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:17,703 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 15:29:18,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:18,816 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:18,816 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:29:18,816 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:18,948 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:18,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:18,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:18,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:29:18,948 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,066 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,067 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,067 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:29:19,067 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,185 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,185 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,185 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,185 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:29:19,185 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,307 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,307 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,307 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,308 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:19,308 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,430 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,431 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,431 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,431 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:29:19,431 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,562 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,562 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,562 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,562 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:29:19,562 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,679 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,679 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,679 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,679 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:29:19,679 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,796 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,796 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,796 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,796 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:29:19,797 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:19,915 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:19,915 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:19,915 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:29:19,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,001 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,002 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:20,002 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:20,002 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:29:20,002 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,088 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,088 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:20,089 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:20,089 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:20,089 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,207 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:20,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:20,208 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:29:20,208 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,369 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,369 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:20,369 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:20,370 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:29:20,370 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,557 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,558 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:20,558 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:20,558 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:20,558 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,678 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,678 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:20,678 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:20,678 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:20,678 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,801 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:20,802 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:20,802 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:20,802 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,910 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,910 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:29:20,910 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:20,911 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,933 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,934 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:29:20,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:20,934 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,956 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:20,956 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:20,957 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:20,957 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:20,957 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,165 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,165 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:21,165 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:21,165 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,165 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:21,165 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:21,166 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,166 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:21,166 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,389 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,389 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,389 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,389 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:21,389 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,390 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:21,390 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:21,390 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,390 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:21,390 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:21,390 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,390 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:21,390 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:21,593 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,593 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,593 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,594 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:21,594 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:21,594 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:21,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:21,594 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:21,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,595 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:21,595 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:21,813 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,813 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,813 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,813 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:21,813 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:21,813 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:21,813 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:21,814 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,814 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:21,814 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:21,814 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,814 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:21,814 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:21,814 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:21,814 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:29:21,814 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:22,126 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,126 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,126 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,126 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,126 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,126 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:22,127 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,127 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:22,127 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:22,127 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,127 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:22,127 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:22,127 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,128 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:22,128 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:22,128 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,128 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:22,128 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:22,128 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,128 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:29:22,128 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:22,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,539 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,539 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:22,539 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:22,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:22,539 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:22,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:22,539 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:22,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:22,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:22,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:22,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:22,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:29:22,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:29:22,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:22,540 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:29:22,541 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:23,053 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,053 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,053 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,053 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,053 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,054 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,054 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,054 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,054 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,054 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:23,054 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:23,069 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 15:29:24,280 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:24,280 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:24,280 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:29:24,280 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:24,415 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,415 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:24,415 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:24,415 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:29:24,415 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,540 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:24,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:24,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:29:24,540 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,662 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,662 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:24,662 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:24,663 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:29:24,663 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,783 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,783 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:24,784 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:24,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:24,784 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,939 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:24,940 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:24,940 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:24,940 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:29:24,940 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,064 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,064 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,064 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:29:25,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,202 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,202 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,202 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,202 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:29:25,202 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,324 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,324 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,324 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,324 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:29:25,324 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,446 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,447 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,447 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,447 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:29:25,447 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,519 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,519 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,519 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,519 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:29:25,520 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,610 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,611 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,611 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,611 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:25,611 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,732 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,732 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,733 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,733 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:29:25,733 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,874 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:25,874 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:25,875 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:25,875 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:29:25,875 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,060 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:26,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:26,061 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,061 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,180 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,180 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:26,180 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:26,181 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,181 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,300 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,301 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:26,301 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:26,301 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,301 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,405 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,405 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:29:26,406 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,406 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,426 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,426 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:29:26,426 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,426 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,450 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,450 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:26,451 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:26,451 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,451 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,655 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,655 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:26,655 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:26,655 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,655 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:26,655 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:26,655 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,655 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:26,655 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,866 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,866 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,866 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,867 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:26,867 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:26,867 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:26,867 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:26,867 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,867 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:26,867 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:26,868 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:26,868 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:26,868 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:27,073 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,073 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,073 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,074 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:27,074 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,074 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:27,074 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:27,074 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,074 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:27,074 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:27,074 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,074 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:27,075 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:27,320 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,320 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,320 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,320 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:27,320 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,320 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:27,320 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:27,320 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,321 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:27,321 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:27,321 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,321 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:27,321 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:27,321 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,321 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:29:27,321 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:27,636 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,636 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,636 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,636 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,637 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:27,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:27,637 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:27,637 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:27,637 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,637 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:27,637 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:27,637 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:27,638 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:27,638 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:27,638 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:27,638 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:27,638 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:29:27,638 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,045 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:28,046 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:28,046 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:28,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:28,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:28,046 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:28,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:28,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:28,046 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:28,047 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:28,047 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:28,047 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:28,047 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:28,047 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:29:28,047 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:29:28,047 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:28,047 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:29:28,047 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:28,553 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,554 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:28,555 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:28,574 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 15:29:28,913 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:28,913 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:28,913 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:29:28,913 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:29,015 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,015 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,016 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,016 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:29:29,016 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,116 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,116 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,116 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:29:29,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,221 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,221 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,221 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,221 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:29:29,221 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,325 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,325 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,325 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,325 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:29,326 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,435 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,435 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,435 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,435 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:29:29,435 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,539 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,539 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:29:29,539 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,642 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,642 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,642 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,642 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:29:29,642 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,745 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,745 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,745 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,745 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:29:29,746 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,842 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,842 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,842 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,842 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:29:29,842 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,923 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:29,924 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:29,924 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:29,924 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:29:29,924 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,018 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,018 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:30,018 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:30,018 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,018 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,123 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,123 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:30,123 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:30,123 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:29:30,124 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,245 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:30,245 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:30,245 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:29:30,245 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,416 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,417 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:30,417 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:30,417 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,417 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,521 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,522 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:30,522 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:30,522 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,522 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,583 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:30,583 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:30,583 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,690 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:29:30,690 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,691 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,695 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,695 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:29:30,696 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,696 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,702 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,702 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:30,702 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:30,702 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,702 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,759 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:30,759 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:30,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,760 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:29:30,760 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:29:30,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,760 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:30,760 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,902 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,902 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,903 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,903 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:30,903 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:30,903 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:30,903 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:30,903 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,903 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:29:30,903 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:29:30,904 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:30,904 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:30,904 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,100 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,100 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,100 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,100 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,101 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,101 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:31,101 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:31,101 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,101 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:31,101 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:31,101 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,101 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:29:31,101 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,302 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,302 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,302 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,302 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,302 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,303 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:31,303 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:31,303 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,303 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:31,303 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:31,303 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,303 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:31,303 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:31,303 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,303 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:29:31,304 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,602 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,602 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,602 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,602 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,603 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,603 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,603 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,603 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:31,603 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:31,603 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,603 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:31,603 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:31,603 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,604 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:31,604 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:31,604 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,604 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:31,604 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:31,604 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:31,604 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:29:31,604 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,998 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,998 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,998 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,999 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,999 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,999 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,999 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,999 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:31,999 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:31,999 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:29:31,999 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:29:32,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:32,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:29:32,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:29:32,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:32,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:29:32,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:29:32,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:32,000 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:29:32,000 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:29:32,000 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:32,001 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:29:32,001 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:29:32,001 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:29:32,001 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:29:32,001 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:32,493 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,493 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,493 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:29:32,494 - tensor_defense - INFO - All hooks removed
2025-04-20 15:29:33,222 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 15:29:33,222 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:29:33,222 - tensor_defense - INFO - 
clean:
2025-04-20 15:29:33,222 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 15:29:33,222 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 15:29:33,223 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 15:29:33,223 - tensor_defense - INFO - 
adversarial:
2025-04-20 15:29:33,223 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:29:33,223 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:29:33,223 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:29:33,223 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.1):
2025-04-20 15:29:33,223 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:29:33,223 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,223 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:29:33,223 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.2):
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:29:33,224 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:29:33,224 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.4):
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:29:33,224 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:29:33,224 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:29:33,225 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.6):
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:29:33,225 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:29:33,225 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.8):
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:29:33,225 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.9):
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@1: 0.2422
2025-04-20 15:29:33,225 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:29:33,226 - tensor_defense - INFO - 
CP Final Norm (R=16, alpha=0.5):
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@10: 0.3984
2025-04-20 15:29:33,226 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:29:33,226 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,226 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:29:33,227 - tensor_defense - INFO - 
CP Final Norm (R=256, alpha=0.5):
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:29:33,227 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@5: 0.2734
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:29:33,227 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@1: 0.2500
2025-04-20 15:29:33,227 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:29:33,228 - tensor_defense - INFO - 
CP QKV (R=64, alpha=0.5):
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:29:33,228 - tensor_defense - INFO - 
CP Projection (R=64, alpha=0.5):
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:29:33,228 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 15:29:33,228 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:29:33,229 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + Attention):
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:29:33,229 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + MLP):
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:29:33,229 - tensor_defense - INFO - 
CP Multi-Layer (Last 2 Layers):
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 15:29:33,229 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@10: 0.4297
2025-04-20 15:29:33,230 - tensor_defense - INFO - 
CP Multi-Layer (Last 3 Layers):
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@1: 0.3828
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@5: 0.3672
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@10: 0.5156
2025-04-20 15:29:33,230 - tensor_defense - INFO - 
CP Multi-Layer (Last 4 Layers):
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@5: 0.3828
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@10: 0.4609
2025-04-20 15:29:33,230 - tensor_defense - INFO - 
CP Multi-Layer (Last 5 Layers):
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@1: 0.3828
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@5: 0.4375
2025-04-20 15:29:33,230 - tensor_defense - INFO -   Recall@10: 0.5469
2025-04-20 15:29:33,231 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:29:35,343 - tensor_defense - INFO - All paper figures saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:29:35,344 - tensor_defense - INFO - All visualization plots saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:29:35,351 - tensor_defense - INFO - Experiment sweep_config completed. Results saved to results/sweep_results\sweep_config
2025-04-20 15:29:35,364 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:21,169 - tensor_defense - INFO - Running experiment: sweep_config
2025-04-20 15:33:21,169 - tensor_defense - INFO - Results will be saved to: results/sweep_results\sweep_config
2025-04-20 15:33:21,179 - tensor_defense - INFO - Using device: cuda
2025-04-20 15:33:21,181 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 15:33:22,673 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 15:33:22,673 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 15:33:25,006 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 15:33:25,006 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 15:33:25,006 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 15:33:25,007 - root - INFO - Random start: True, Targeted: False
2025-04-20 15:33:25,007 - tensor_defense - INFO - Processing batches...
2025-04-20 15:33:29,480 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 15:33:31,332 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 15:33:31,677 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 15:33:32,023 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 15:33:32,367 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 15:33:32,715 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 15:33:32,715 - tensor_defense - INFO - Saved 5 sample image pairs to results/sweep_results\sweep_config\samples
2025-04-20 15:33:32,794 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:32,795 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:32,795 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:33:32,977 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:32,977 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:32,978 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:32,978 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:33:32,978 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,122 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,122 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,122 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,122 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:33:33,123 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,245 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,245 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,245 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,246 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:33:33,246 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,363 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,364 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,364 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:33,364 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,483 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,484 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,484 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,484 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:33:33,484 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,603 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,604 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,604 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,604 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:33:33,604 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,716 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,716 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,717 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,717 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:33:33,717 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,841 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,841 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,841 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,842 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:33:33,842 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,961 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:33,961 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:33,961 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:33,962 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:33:33,962 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,057 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,057 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:34,057 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:34,057 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:33:34,057 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,160 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,160 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:34,160 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:34,160 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:34,161 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,284 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,285 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:34,285 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:34,285 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:33:34,285 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,422 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:34,423 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:34,423 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:33:34,423 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,608 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,608 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:34,608 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:34,608 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:34,608 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,722 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,723 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:34,723 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:34,723 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:34,723 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,838 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,838 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:34,839 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:34,839 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:34,839 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,945 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,946 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:33:34,946 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:34,946 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,966 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,966 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:33:34,966 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:34,966 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,992 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:34,992 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:34,992 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:34,993 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:34,993 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,208 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,209 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:35,209 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:35,209 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,209 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:35,209 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:35,209 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,209 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:35,209 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,426 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,427 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,427 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,427 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:35,427 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,427 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:35,427 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:35,427 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,428 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:35,428 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:35,428 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,428 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:35,428 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:35,650 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,651 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,651 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,651 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:35,651 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:35,651 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:35,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:35,651 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:35,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,652 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:35,652 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:35,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,883 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:35,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:35,883 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:35,883 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:35,883 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,883 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:35,884 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:35,884 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,884 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:35,884 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:35,884 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:35,884 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:33:35,884 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:36,212 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,212 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,213 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,213 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,213 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,213 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:36,213 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,213 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:36,213 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:36,213 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,214 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:36,214 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:36,214 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,214 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:36,214 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:36,214 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,214 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:36,214 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:36,214 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,214 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:33:36,214 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:36,636 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,637 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:36,638 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:36,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:36,638 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:36,638 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:36,638 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:36,638 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,638 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:36,639 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:36,639 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,639 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:36,639 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:36,639 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,639 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:33:36,639 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:33:36,639 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:36,639 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:33:36,639 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:37,148 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,148 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,148 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,148 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,148 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,149 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,149 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,149 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,149 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,149 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:37,149 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:37,178 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 15:33:38,219 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:38,219 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:38,219 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:33:38,219 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:38,340 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,340 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:38,340 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:38,341 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:33:38,341 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,459 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,460 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:38,460 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:38,460 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:33:38,460 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,582 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,582 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:38,582 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:38,582 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:33:38,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,700 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,701 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:38,701 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:38,701 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:38,701 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,817 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,817 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:38,817 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:38,817 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:33:38,818 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,939 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:38,939 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:38,940 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:38,940 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:33:38,940 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,060 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,060 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,060 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,061 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:33:39,061 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,177 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,177 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,177 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,177 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:33:39,177 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,290 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,290 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:33:39,291 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,376 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,376 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,376 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,376 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:33:39,376 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,468 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,468 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,468 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,468 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:39,468 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,589 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,589 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,589 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:33:39,589 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,731 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,731 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,731 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,731 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:33:39,731 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,916 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:39,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:39,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:39,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:39,916 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,039 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,039 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:40,039 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:40,039 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,039 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,161 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,161 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:40,161 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:40,162 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,278 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,278 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:33:40,278 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,279 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,300 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,300 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:33:40,300 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,300 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,324 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,324 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:40,324 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:40,324 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,324 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,529 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,529 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:40,530 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:40,530 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,530 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:40,530 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:40,530 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,530 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:40,530 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,746 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,747 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,747 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,747 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:40,747 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,747 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:40,747 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:40,747 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,748 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:40,748 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:40,748 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,748 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:40,748 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:40,960 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,961 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,961 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,961 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:40,961 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:40,961 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:40,961 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:40,961 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,961 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:40,961 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:40,962 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:40,962 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:40,962 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:41,183 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,183 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,183 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,184 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:41,184 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,184 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:41,184 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:41,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,184 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:41,184 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:41,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,185 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:41,185 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:41,185 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,185 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:33:41,185 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:41,498 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,498 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,498 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,498 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,498 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,498 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:41,498 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,499 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:41,499 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:41,499 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,499 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:41,499 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:41,499 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,499 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:41,499 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:41,499 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,500 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:41,500 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:41,500 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,500 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:33:41,500 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:41,914 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,914 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,915 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:41,915 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:41,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:41,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:41,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:41,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:41,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:41,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:41,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,917 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:41,917 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:41,917 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,917 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:33:41,917 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:33:41,917 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:41,917 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:33:41,917 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:42,424 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,424 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,424 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,424 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,424 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,424 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,425 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,425 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,425 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,425 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:42,425 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:42,440 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 15:33:43,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:43,571 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:43,571 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:33:43,571 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:43,693 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:43,694 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:43,694 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:43,694 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:33:43,694 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:43,812 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:43,812 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:43,812 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:43,812 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:33:43,812 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:43,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:43,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:43,933 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:43,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:33:43,933 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:44,045 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:33:44,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,332 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,332 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,332 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,332 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:33:44,332 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,451 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,451 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,451 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,451 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:33:44,451 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,573 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,573 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,573 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,573 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:33:44,573 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,687 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,687 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,687 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,687 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:33:44,687 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,775 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,775 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,775 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:33:44,775 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,866 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,866 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,866 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,866 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:44,866 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,988 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:44,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:44,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:44,988 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:33:44,988 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,126 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,127 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:45,127 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:45,127 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:33:45,127 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,309 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,310 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:45,310 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:45,310 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,310 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,437 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,437 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:45,438 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:45,438 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,438 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,556 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,556 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:45,556 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:45,556 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,556 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,654 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,654 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:33:45,654 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,654 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,676 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,676 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:33:45,676 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,677 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,697 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,698 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:45,698 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:45,698 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,698 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:45,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:45,933 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:45,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:45,933 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:45,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:45,933 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:45,933 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,152 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,152 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,153 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,153 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:46,153 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,153 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:46,153 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:46,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,153 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:46,153 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:46,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,154 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:46,154 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:46,364 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,364 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,364 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,365 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:46,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,365 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:46,365 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:46,365 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,365 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:46,365 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:46,365 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,365 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:46,366 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:46,572 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,572 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,572 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,572 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:46,572 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,572 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:46,573 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:46,573 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,573 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:46,573 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:46,573 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,573 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:46,573 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:46,573 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,573 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:33:46,573 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:46,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,882 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:46,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:46,883 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:46,883 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:46,883 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,883 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:46,883 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:46,883 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,883 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:46,884 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:46,884 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,884 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:46,884 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:46,884 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:46,884 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:33:46,884 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:47,292 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,292 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,292 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,292 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,293 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,293 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,293 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,293 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:47,293 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,293 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:47,293 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:47,293 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:47,293 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:47,293 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:47,294 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:47,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:47,294 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:47,294 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:47,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:47,294 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:47,294 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:47,294 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:33:47,294 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:33:47,294 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:47,295 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:33:47,295 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:47,804 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,804 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,804 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:47,805 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:47,826 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 15:33:48,157 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,158 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,158 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:33:48,158 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:48,262 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,262 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,263 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,263 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:33:48,263 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,363 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,363 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,363 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,363 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:33:48,363 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,469 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,469 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,470 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:33:48,470 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,570 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,571 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,571 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:48,571 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,673 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,674 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,674 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,674 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:33:48,674 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,777 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,777 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,778 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,778 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:33:48,778 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,881 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,881 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,881 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,881 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:33:48,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,984 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:48,984 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:48,984 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:48,984 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:33:48,984 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,092 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,092 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:49,092 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:49,092 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:33:49,092 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,187 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,187 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:49,187 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:49,187 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:33:49,187 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,278 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,278 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:49,278 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:49,278 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:49,278 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,383 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,383 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:49,383 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:49,383 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:33:49,383 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,505 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,505 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:49,505 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:49,505 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:33:49,506 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,675 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,675 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:49,675 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:49,675 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:49,675 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,780 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,780 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:49,781 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:49,781 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:49,781 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,835 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,835 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:49,836 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:49,836 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:49,836 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,940 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,940 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:33:49,940 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:49,940 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,946 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,946 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:33:49,946 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:49,946 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,952 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:49,952 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:49,952 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:49,952 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:49,952 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,011 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,011 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:50,011 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:50,012 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,012 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:33:50,012 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:33:50,012 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,012 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:50,012 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,163 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:50,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:50,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:50,164 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,164 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:33:50,164 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:33:50,164 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,164 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:50,164 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:50,356 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,356 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,357 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,357 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:50,357 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,357 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:50,357 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:50,357 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,357 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:50,357 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:50,358 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,358 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:33:50,358 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:50,551 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,552 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,552 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,552 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:50,552 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:50,552 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:50,552 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:50,552 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:50,553 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,553 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:50,553 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:50,553 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,553 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:33:50,553 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:50,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,885 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:50,886 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:50,886 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:50,886 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:50,886 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,886 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:50,886 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:50,886 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,886 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:50,887 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:50,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,887 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:50,887 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:50,887 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:50,887 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:33:50,887 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:51,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,286 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,287 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:51,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:33:51,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:33:51,287 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:51,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:33:51,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:33:51,287 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:51,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:33:51,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:33:51,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:51,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:33:51,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:33:51,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:51,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:33:51,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:33:51,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:33:51,288 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:33:51,288 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:51,773 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:51,775 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:33:51,775 - tensor_defense - INFO - All hooks removed
2025-04-20 15:33:52,500 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 15:33:52,500 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:33:52,500 - tensor_defense - INFO - 
clean:
2025-04-20 15:33:52,500 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 15:33:52,500 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 15:33:52,501 - tensor_defense - INFO - 
adversarial:
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:33:52,501 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.1):
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:33:52,501 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.2):
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:33:52,501 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:33:52,501 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:33:52,502 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.4):
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:33:52,502 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:33:52,502 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.6):
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:33:52,502 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:33:52,502 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:33:52,503 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.8):
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@1: 0.2500
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:33:52,503 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.9):
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@1: 0.2422
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:33:52,503 - tensor_defense - INFO - 
CP Final Norm (R=16, alpha=0.5):
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:33:52,503 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:33:52,503 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:33:52,504 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:33:52,504 - tensor_defense - INFO - 
CP Final Norm (R=256, alpha=0.5):
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:33:52,504 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@5: 0.2734
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:33:52,504 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:33:52,504 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:33:52,504 - tensor_defense - INFO - 
CP QKV (R=64, alpha=0.5):
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:33:52,505 - tensor_defense - INFO - 
CP Projection (R=64, alpha=0.5):
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:33:52,505 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:33:52,505 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:33:52,505 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + Attention):
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@10: 0.4297
2025-04-20 15:33:52,506 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + MLP):
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@1: 0.3438
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:33:52,506 - tensor_defense - INFO - 
CP Multi-Layer (Last 2 Layers):
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@1: 0.3516
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@5: 0.3359
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 15:33:52,506 - tensor_defense - INFO - 
CP Multi-Layer (Last 3 Layers):
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@1: 0.3828
2025-04-20 15:33:52,506 - tensor_defense - INFO -   Recall@5: 0.3516
2025-04-20 15:33:52,507 - tensor_defense - INFO -   Recall@10: 0.5078
2025-04-20 15:33:52,507 - tensor_defense - INFO - 
CP Multi-Layer (Last 4 Layers):
2025-04-20 15:33:52,507 - tensor_defense - INFO -   Recall@1: 0.3828
2025-04-20 15:33:52,507 - tensor_defense - INFO -   Recall@5: 0.3672
2025-04-20 15:33:52,507 - tensor_defense - INFO -   Recall@10: 0.5000
2025-04-20 15:33:52,507 - tensor_defense - INFO - 
CP Multi-Layer (Last 5 Layers):
2025-04-20 15:33:52,507 - tensor_defense - INFO -   Recall@1: 0.4219
2025-04-20 15:33:52,507 - tensor_defense - INFO -   Recall@5: 0.4531
2025-04-20 15:33:52,507 - tensor_defense - INFO -   Recall@10: 0.5312
2025-04-20 15:33:52,507 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:33:54,634 - tensor_defense - INFO - All paper figures saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:33:54,634 - tensor_defense - INFO - All visualization plots saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:33:54,642 - tensor_defense - INFO - Experiment sweep_config completed. Results saved to results/sweep_results\sweep_config
2025-04-20 15:33:54,654 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:41,323 - tensor_defense - INFO - Running experiment: sweep_config
2025-04-20 15:36:41,323 - tensor_defense - INFO - Results will be saved to: results/sweep_results\sweep_config
2025-04-20 15:36:41,333 - tensor_defense - INFO - Using device: cuda
2025-04-20 15:36:41,335 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 15:36:42,999 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 15:36:42,999 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 15:36:44,731 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 15:36:44,731 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 15:36:44,732 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 15:36:44,732 - root - INFO - Random start: True, Targeted: False
2025-04-20 15:36:44,732 - tensor_defense - INFO - Processing batches...
2025-04-20 15:36:49,230 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 15:36:51,152 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 15:36:51,495 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 15:36:51,841 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 15:36:52,184 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 15:36:52,533 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 15:36:52,533 - tensor_defense - INFO - Saved 5 sample image pairs to results/sweep_results\sweep_config\samples
2025-04-20 15:36:52,694 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:52,694 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:52,694 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:36:52,881 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:52,881 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:52,881 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:52,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:36:52,882 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,027 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,027 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,028 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,028 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:36:53,028 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:36:53,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,289 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:53,289 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,406 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,406 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,406 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,406 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:36:53,406 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,531 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,531 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,531 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,531 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:36:53,531 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,659 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,659 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,659 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,660 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:36:53,660 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,779 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,779 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,779 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,779 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:36:53,779 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,902 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,902 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,902 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:36:53,902 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,986 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:53,987 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:53,987 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:53,987 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:36:53,987 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,084 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:54,084 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:54,084 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:54,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,206 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,206 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:54,206 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:54,206 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:36:54,207 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,354 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,354 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:54,354 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:54,355 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:36:54,355 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,544 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,544 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:54,544 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:54,544 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:54,544 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,668 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,668 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:36:54,668 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:36:54,668 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:54,668 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,792 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,792 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:36:54,792 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:36:54,792 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:54,793 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,909 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,909 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:36:54,909 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:54,909 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,933 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,933 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:36:54,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:54,933 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,956 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:54,956 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:54,956 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:54,956 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:54,956 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,170 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,171 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:55,171 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:55,171 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,171 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:36:55,171 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:36:55,171 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,172 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:36:55,172 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,396 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:55,396 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,396 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:55,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:55,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:36:55,397 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:36:55,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,397 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:36:55,397 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:55,595 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,595 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,596 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,596 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:55,596 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,596 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:55,596 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:55,596 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,597 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:36:55,597 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:36:55,597 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,597 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:36:55,597 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:55,822 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,823 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:55,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:55,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:55,823 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:55,823 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:36:55,823 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:36:55,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:36:55,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:36:55,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:55,824 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:36:55,824 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:56,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,162 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,162 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:56,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:56,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:56,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:36:56,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:36:56,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:36:56,163 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:36:56,163 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:36:56,164 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:36:56,164 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,164 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:36:56,164 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:56,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:56,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:56,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:56,584 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:36:56,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:36:56,584 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:36:56,585 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:36:56,585 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,585 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:36:56,585 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:36:56,585 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,585 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:36:56,585 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:36:56,585 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:56,585 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:36:56,585 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:57,113 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,114 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,114 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,114 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,114 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,114 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,114 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,115 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,115 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,115 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:57,115 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:57,130 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 15:36:58,335 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:58,335 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:58,335 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:36:58,335 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:36:58,470 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,470 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:58,470 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:58,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:36:58,470 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,594 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:58,594 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:58,595 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:36:58,595 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,707 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,707 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:58,707 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:58,707 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:36:58,708 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,825 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,825 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:58,825 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:58,825 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:58,825 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,942 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:58,942 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:58,942 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:58,942 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:36:58,942 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,063 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,064 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,064 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,064 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:36:59,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,177 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,178 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,178 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,178 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:36:59,178 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,301 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,301 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,301 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,301 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:36:59,301 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,431 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,432 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,432 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,432 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:36:59,433 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,528 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,529 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:36:59,529 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,624 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,624 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,624 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,625 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:36:59,625 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,766 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,767 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,767 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,767 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:36:59,767 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,909 - tensor_defense - INFO - All hooks removed
2025-04-20 15:36:59,910 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:36:59,910 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:36:59,910 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:36:59,910 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,123 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,123 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:00,124 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:00,124 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,124 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,256 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,257 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:37:00,257 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:37:00,257 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,257 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,391 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,391 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:37:00,391 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:37:00,391 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,391 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,512 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,513 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:37:00,513 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,513 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,537 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,537 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:37:00,537 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,561 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,561 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:00,561 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:00,561 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,562 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,786 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:00,786 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:00,786 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:00,787 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,787 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:37:00,787 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:37:00,787 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:00,787 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:00,787 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,011 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,011 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,011 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,011 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:01,011 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,011 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:01,012 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:01,012 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,012 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:37:01,012 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:37:01,012 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,012 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:01,012 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:01,221 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,221 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,221 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,221 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:01,221 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,222 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:01,222 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:01,222 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,222 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:01,222 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:01,222 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,222 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:01,222 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:01,455 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,455 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,456 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,456 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:01,456 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,456 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:01,456 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:01,456 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,456 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:01,456 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:01,457 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,457 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:01,457 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:01,457 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,457 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:37:01,457 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:01,817 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,817 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,817 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,817 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,818 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,818 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:01,818 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:01,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:01,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:01,818 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:01,818 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:01,818 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,818 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:01,819 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:01,819 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,819 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:37:01,819 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:37:01,819 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:01,819 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:37:01,819 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:02,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,288 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:02,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:02,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:02,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:02,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:02,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:02,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:02,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:02,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:02,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:02,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:37:02,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:37:02,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:02,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:37:02,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:37:02,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:02,289 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:37:02,289 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:02,853 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,853 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,854 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:02,855 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:02,885 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 15:37:04,152 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:04,152 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:04,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:37:04,153 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:04,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:04,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:04,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:37:04,289 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,409 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:04,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:04,410 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:37:04,410 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,533 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,534 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:04,534 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:04,534 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:37:04,534 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,660 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,661 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:04,661 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:04,661 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:04,661 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,784 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,785 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:04,785 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:04,785 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:37:04,785 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,901 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:04,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:04,901 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:04,902 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:37:04,902 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,031 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,032 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,032 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,032 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:37:05,032 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,171 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,171 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,172 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,172 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:37:05,172 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,302 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,302 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,303 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,303 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:37:05,303 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,401 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,401 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,401 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,401 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:37:05,401 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,499 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,499 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,500 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,500 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:05,500 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,637 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,637 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,637 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:37:05,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,796 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,797 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,797 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:37:05,797 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,995 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:05,995 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:05,996 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:05,996 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:05,996 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,116 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:37:06,117 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:37:06,117 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,238 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,238 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:37:06,239 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:37:06,239 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,239 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,355 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,355 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:37:06,355 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,355 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,380 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,380 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:37:06,380 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,380 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,405 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,405 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:06,406 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:06,406 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,406 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,618 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:06,618 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:06,618 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,618 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:37:06,619 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:37:06,619 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,619 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:06,619 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,862 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,862 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,862 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,862 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:06,863 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:06,863 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:06,863 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:06,863 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,863 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:37:06,863 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:37:06,863 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:06,864 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:06,864 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:07,078 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,078 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,079 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,079 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:07,079 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,079 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:07,079 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:07,079 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,079 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:07,079 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:07,079 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,080 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:07,080 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:07,303 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,303 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,303 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,304 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:07,304 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,304 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:07,304 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:07,304 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,304 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:07,304 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:07,304 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,305 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:07,305 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:07,305 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,305 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:37:07,305 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:07,620 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,621 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,621 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,621 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,621 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,621 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:07,621 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:07,621 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:07,622 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:07,622 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,622 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:07,622 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:07,622 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,622 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:07,622 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:07,622 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,622 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:37:07,622 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:37:07,622 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:07,623 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:37:07,623 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:08,033 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:08,034 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,035 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:08,035 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:08,035 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:08,035 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:08,035 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:08,035 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:08,035 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:08,035 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:08,036 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:08,036 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:37:08,036 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:37:08,036 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:08,036 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:37:08,036 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:37:08,036 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:08,037 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:37:08,037 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:08,562 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:08,563 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:08,584 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 15:37:08,935 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:08,935 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:08,936 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:37:08,936 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:09,040 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,040 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,040 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,040 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:37:09,041 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,153 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,153 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,153 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:37:09,154 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,261 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,261 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,261 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,261 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:37:09,261 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,365 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,365 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,365 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:09,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,474 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,474 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,474 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,474 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:37:09,474 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,573 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,573 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,574 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,574 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:37:09,574 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,687 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,687 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,687 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,687 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:37:09,687 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,796 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,797 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:37:09,797 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,901 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,902 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,902 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:37:09,902 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,998 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:09,998 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:09,998 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:09,999 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:37:09,999 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,091 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,091 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:10,091 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:10,092 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,092 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,204 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,205 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:10,205 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:10,205 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:37:10,205 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,338 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,338 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:10,339 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:10,339 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:37:10,339 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,509 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,509 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:10,509 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:10,509 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,509 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,614 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,614 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:37:10,614 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:37:10,614 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,614 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,650 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,651 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:37:10,651 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:37:10,651 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,651 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,757 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,757 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:37:10,757 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,758 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,763 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,763 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:37:10,763 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,763 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,769 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,769 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:10,769 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:10,769 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,770 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,828 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:10,828 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:10,828 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:37:10,829 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:37:10,829 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,829 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:10,829 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,966 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,966 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,966 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,966 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:10,966 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:10,967 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:10,967 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:10,967 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,967 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:37:10,967 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:37:10,967 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:10,967 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:10,967 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:11,176 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,176 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,176 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,176 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:11,176 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,176 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:11,176 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:11,177 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,177 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:11,177 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:11,177 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,177 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:37:11,177 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:11,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,408 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:11,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,408 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:11,408 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:11,408 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:11,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:11,409 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:11,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:11,409 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,409 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:37:11,409 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:11,712 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,712 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,712 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,713 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,713 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,713 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:11,713 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:11,713 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:11,713 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:11,713 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,713 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:11,714 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:11,714 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,714 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:11,714 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:11,714 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,714 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:37:11,714 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:37:11,714 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:11,715 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:37:11,715 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:12,134 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,135 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:37:12,135 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:37:12,135 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:12,135 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:37:12,135 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:37:12,135 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:12,135 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:37:12,135 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:37:12,135 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:12,135 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:37:12,135 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:37:12,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:12,136 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:37:12,136 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:37:12,136 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:37:12,136 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:37:12,136 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:12,641 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,641 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,641 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,641 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,641 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,641 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,642 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,642 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,642 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:12,642 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:37:12,642 - tensor_defense - INFO - All hooks removed
2025-04-20 15:37:13,389 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 15:37:13,390 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:37:13,390 - tensor_defense - INFO - 
clean:
2025-04-20 15:37:13,390 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 15:37:13,390 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 15:37:13,390 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 15:37:13,390 - tensor_defense - INFO - 
adversarial:
2025-04-20 15:37:13,390 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:37:13,390 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:37:13,390 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:37:13,391 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.1):
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:37:13,391 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.2):
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:37:13,391 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:37:13,391 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:37:13,392 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.4):
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:37:13,392 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@10: 0.3984
2025-04-20 15:37:13,392 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.6):
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:37:13,392 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:37:13,392 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:37:13,393 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.8):
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@5: 0.2734
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:37:13,393 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.9):
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@1: 0.2422
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:37:13,393 - tensor_defense - INFO - 
CP Final Norm (R=16, alpha=0.5):
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:37:13,393 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:37:13,393 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:37:13,394 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:37:13,394 - tensor_defense - INFO - 
CP Final Norm (R=256, alpha=0.5):
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:37:13,394 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:37:13,394 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:37:13,394 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-20 15:37:13,395 - tensor_defense - INFO - 
CP QKV (R=64, alpha=0.5):
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:37:13,395 - tensor_defense - INFO - 
CP Projection (R=64, alpha=0.5):
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:37:13,395 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:37:13,395 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:37:13,396 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + Attention):
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@10: 0.4219
2025-04-20 15:37:13,396 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + MLP):
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@1: 0.3438
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:37:13,396 - tensor_defense - INFO - 
CP Multi-Layer (Last 2 Layers):
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 15:37:13,396 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@10: 0.4297
2025-04-20 15:37:13,397 - tensor_defense - INFO - 
CP Multi-Layer (Last 3 Layers):
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@1: 0.3828
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@10: 0.5000
2025-04-20 15:37:13,397 - tensor_defense - INFO - 
CP Multi-Layer (Last 4 Layers):
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@5: 0.3750
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@10: 0.5156
2025-04-20 15:37:13,397 - tensor_defense - INFO - 
CP Multi-Layer (Last 5 Layers):
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@1: 0.4688
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@5: 0.4297
2025-04-20 15:37:13,397 - tensor_defense - INFO -   Recall@10: 0.5469
2025-04-20 15:37:13,398 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:37:15,555 - tensor_defense - INFO - All paper figures saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:37:15,555 - tensor_defense - INFO - All visualization plots saved to results/sweep_results\sweep_config\figures\figures
2025-04-20 15:37:15,563 - tensor_defense - INFO - Experiment sweep_config completed. Results saved to results/sweep_results\sweep_config
2025-04-20 15:37:15,576 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:00,380 - tensor_defense - INFO - Running experiment: sweep_config
2025-04-20 15:39:00,380 - tensor_defense - INFO - Results will be saved to: results/sweep_config
2025-04-20 15:39:00,391 - tensor_defense - INFO - Using device: cuda
2025-04-20 15:39:00,393 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-20 15:39:01,991 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-20 15:39:01,991 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-20 15:39:03,572 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-20 15:39:03,572 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-20 15:39:03,572 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-20 15:39:03,572 - root - INFO - Random start: True, Targeted: False
2025-04-20 15:39:03,572 - tensor_defense - INFO - Processing batches...
2025-04-20 15:39:08,157 - tensor_defense - INFO - Processing batch 1/4
2025-04-20 15:39:10,072 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-20 15:39:10,413 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-20 15:39:10,761 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-20 15:39:11,105 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-20 15:39:11,455 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-20 15:39:11,455 - tensor_defense - INFO - Saved 5 sample image pairs to results/sweep_config\samples
2025-04-20 15:39:11,631 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:11,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:11,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:39:11,810 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:11,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:11,811 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:11,811 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:39:11,811 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:11,931 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:11,931 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:11,931 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:11,931 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:39:11,931 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,051 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,051 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,051 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:39:12,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,175 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,175 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,175 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,176 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:12,176 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,293 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,293 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,293 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,293 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:39:12,294 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,416 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,416 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,416 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,416 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:39:12,416 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,536 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,536 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,536 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,536 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:39:12,536 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,655 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,655 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,655 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,655 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:39:12,656 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,774 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:39:12,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,851 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,851 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,851 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,852 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:39:12,852 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,944 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:12,944 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:12,944 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:12,944 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:12,944 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,067 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,067 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:13,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:13,068 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:39:13,068 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,210 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,210 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:13,210 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:13,211 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:39:13,211 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,398 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,398 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:13,398 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:13,398 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,398 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,514 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,514 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:13,515 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:13,515 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,515 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,630 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,630 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:13,630 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:13,630 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,630 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,731 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,732 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:39:13,732 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,732 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,753 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,753 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:39:13,753 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,753 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,777 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,778 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:13,778 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:13,778 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,778 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,988 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:13,989 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:13,989 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:13,989 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,989 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:13,989 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:13,989 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:13,989 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:13,990 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,195 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,195 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,195 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,195 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:14,196 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,196 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:14,196 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:14,196 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,196 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:14,196 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:14,196 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,196 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:14,196 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:14,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,409 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:14,409 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:14,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:14,409 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,409 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:14,409 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:14,409 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,409 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:14,409 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:14,631 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,631 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,631 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,631 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:14,631 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,631 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:14,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:14,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:14,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:14,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:14,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:14,633 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,633 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:39:14,633 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:14,957 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,957 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,957 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,958 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,958 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,958 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:14,958 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:14,958 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:14,958 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:14,958 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,958 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:14,959 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:14,959 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,959 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:14,959 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:14,959 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,959 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:14,959 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:14,959 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:14,959 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:39:14,959 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:15,419 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,419 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,419 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,419 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,420 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,420 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,420 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,420 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:15,420 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,420 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:15,420 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:15,420 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,421 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:15,421 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:15,421 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,421 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:15,421 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:15,421 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:15,422 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:15,422 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,422 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:15,422 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:15,422 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,422 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:39:15,422 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:15,931 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,932 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,933 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:15,933 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:15,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:15,933 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:15,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:15,933 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:15,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:15,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:15,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,934 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:15,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:15,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,934 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:15,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:15,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,935 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 6 final norm
2025-04-20 15:39:15,935 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -6)
2025-04-20 15:39:15,935 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,935 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 5 final norm
2025-04-20 15:39:15,935 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -7)
2025-04-20 15:39:15,935 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,935 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 4 final norm
2025-04-20 15:39:15,935 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -8)
2025-04-20 15:39:15,935 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,935 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 3 final norm
2025-04-20 15:39:15,936 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -9)
2025-04-20 15:39:15,936 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,936 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 2 final norm
2025-04-20 15:39:15,936 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -10)
2025-04-20 15:39:15,936 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,936 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 1 final norm
2025-04-20 15:39:15,936 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -11)
2025-04-20 15:39:15,936 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,936 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 0 final norm
2025-04-20 15:39:15,936 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -12)
2025-04-20 15:39:15,936 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:15,937 - tensor_defense - INFO - Initialized multi-layer defense with 12 layers
2025-04-20 15:39:15,937 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,117 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,118 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,119 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:17,119 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:17,144 - tensor_defense - INFO - Processing batch 2/4
2025-04-20 15:39:18,266 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:18,267 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:18,267 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:39:18,267 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:18,401 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,401 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:18,402 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:18,402 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:39:18,402 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,527 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:18,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:18,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:39:18,528 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,664 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,665 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:18,665 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:18,665 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:39:18,665 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,803 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,803 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:18,804 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:18,804 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:18,804 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,940 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:18,940 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:18,940 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:18,940 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:39:18,940 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,086 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,086 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,086 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,087 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:39:19,087 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,222 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,223 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,223 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,223 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:39:19,223 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,366 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,366 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,366 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,366 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:39:19,367 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,499 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,499 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,499 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,500 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:39:19,500 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,583 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,584 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:39:19,584 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,686 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,686 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,687 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,687 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:19,687 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,820 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,820 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,821 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,821 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:39:19,821 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,959 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:19,959 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:19,960 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:19,960 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:39:19,960 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,154 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,154 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:20,154 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:20,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,155 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,283 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,283 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:20,284 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:20,284 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,284 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,410 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:20,411 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:20,411 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,517 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,517 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:39:20,517 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,517 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,537 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,537 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:39:20,537 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,537 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,561 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,561 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:20,562 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:20,562 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,562 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,774 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:20,775 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:20,775 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:20,775 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,775 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:20,775 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:20,775 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:20,776 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:20,776 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,028 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,028 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,028 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,028 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:21,028 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,028 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:21,028 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:21,029 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,029 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:21,029 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:21,029 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,029 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:21,029 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:21,237 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,238 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,238 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,238 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:21,238 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,238 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:21,238 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:21,239 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,239 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:21,239 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:21,239 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,239 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:21,239 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:21,466 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,466 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,466 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,466 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:21,467 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,467 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:21,467 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:21,467 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,467 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:21,467 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:21,467 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,467 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:21,467 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:21,468 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,468 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:39:21,468 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:21,856 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,856 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,856 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,856 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,857 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,857 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:21,857 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:21,857 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:21,857 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:21,857 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,857 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:21,857 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:21,857 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,857 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:21,857 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:21,858 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,858 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:21,858 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:21,858 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:21,858 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:39:21,858 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:22,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,287 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,288 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:22,288 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:22,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:22,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:22,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:22,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:22,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:22,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:22,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:22,289 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,289 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:22,289 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:22,290 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,290 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:39:22,290 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:22,822 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,822 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:22,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:22,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:22,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:22,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:22,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:22,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:22,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:22,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:22,825 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:22,825 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,825 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:22,825 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:22,825 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,825 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 6 final norm
2025-04-20 15:39:22,825 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -6)
2025-04-20 15:39:22,825 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,825 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 5 final norm
2025-04-20 15:39:22,826 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -7)
2025-04-20 15:39:22,826 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,826 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 4 final norm
2025-04-20 15:39:22,826 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -8)
2025-04-20 15:39:22,826 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,826 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 3 final norm
2025-04-20 15:39:22,826 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -9)
2025-04-20 15:39:22,826 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,826 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 2 final norm
2025-04-20 15:39:22,826 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -10)
2025-04-20 15:39:22,827 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,827 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 1 final norm
2025-04-20 15:39:22,827 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -11)
2025-04-20 15:39:22,827 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,827 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 0 final norm
2025-04-20 15:39:22,827 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -12)
2025-04-20 15:39:22,827 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:22,827 - tensor_defense - INFO - Initialized multi-layer defense with 12 layers
2025-04-20 15:39:22,828 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:24,049 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,049 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,049 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,049 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,049 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,050 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,050 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,050 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,050 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,050 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,050 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,050 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,051 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,052 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,052 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,052 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:24,052 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:24,082 - tensor_defense - INFO - Processing batch 3/4
2025-04-20 15:39:25,267 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:25,267 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:25,267 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:39:25,267 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:25,400 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,400 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:25,401 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:25,401 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:39:25,401 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,517 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,518 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:25,518 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:25,518 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:39:25,518 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,665 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,666 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:25,666 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:25,666 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:39:25,666 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,788 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,788 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:25,788 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:25,789 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:25,789 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,908 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:25,909 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:25,909 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:25,909 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:39:25,909 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,032 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,032 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,032 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,032 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:39:26,032 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,145 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,146 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,146 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,146 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:39:26,146 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,268 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,269 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,269 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,269 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:39:26,269 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,385 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,385 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,386 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,386 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:39:26,386 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,464 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,464 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:39:26,464 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,552 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,553 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,553 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:26,553 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,679 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,680 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,680 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:39:26,680 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,823 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:26,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:26,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:26,824 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:39:26,824 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,018 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,018 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:27,018 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:27,018 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,018 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,146 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:27,147 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:27,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,147 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,272 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,272 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:27,272 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:27,272 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,272 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,385 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,385 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:39:27,385 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,385 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,407 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,407 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:39:27,408 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,408 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,430 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,431 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:27,431 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:27,431 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,431 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,636 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,636 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:27,636 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:27,636 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,636 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:27,637 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:27,637 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,637 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:27,637 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,865 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,865 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,866 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,866 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:27,866 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:27,866 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:27,866 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:27,866 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,866 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:27,866 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:27,867 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:27,867 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:27,867 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:28,074 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,075 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,075 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,075 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:28,075 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,075 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:28,075 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:28,075 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,075 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:28,075 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:28,075 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,076 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:28,076 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:28,304 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,305 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,305 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,305 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:28,305 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,305 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:28,305 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:28,305 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:28,306 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:28,306 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,306 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:28,306 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:28,306 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,306 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:39:28,306 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:28,643 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,643 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,643 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,644 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,644 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,644 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:28,644 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:28,644 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:28,644 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:28,644 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,644 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:28,645 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:28,645 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,645 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:28,645 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:28,645 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,645 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:28,645 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:28,645 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:28,646 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:39:28,646 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:29,083 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:29,084 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,085 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:29,085 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:29,085 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,085 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:29,085 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:29,085 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,085 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:29,085 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:29,085 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,086 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:29,086 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:29,086 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,086 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:29,086 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:29,086 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,086 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:39:29,086 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:29,628 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,629 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:29,630 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:29,630 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:29,630 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:29,630 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,630 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:29,630 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:29,630 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,631 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:29,631 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:29,631 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,631 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:29,631 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:29,631 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,631 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:29,631 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:29,631 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 6 final norm
2025-04-20 15:39:29,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -6)
2025-04-20 15:39:29,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 5 final norm
2025-04-20 15:39:29,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -7)
2025-04-20 15:39:29,632 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,632 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 4 final norm
2025-04-20 15:39:29,632 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -8)
2025-04-20 15:39:29,633 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,633 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 3 final norm
2025-04-20 15:39:29,633 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -9)
2025-04-20 15:39:29,633 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,633 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 2 final norm
2025-04-20 15:39:29,633 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -10)
2025-04-20 15:39:29,633 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,633 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 1 final norm
2025-04-20 15:39:29,633 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -11)
2025-04-20 15:39:29,634 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,634 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 0 final norm
2025-04-20 15:39:29,634 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -12)
2025-04-20 15:39:29,634 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:29,634 - tensor_defense - INFO - Initialized multi-layer defense with 12 layers
2025-04-20 15:39:29,634 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:30,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,883 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,884 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,885 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,886 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:30,886 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:30,909 - tensor_defense - INFO - Processing batch 4/4
2025-04-20 15:39:31,263 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:31,263 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:31,263 - tensor_defense - INFO - Rank: 64, Alpha: 0.1
2025-04-20 15:39:31,263 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:31,373 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,373 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:31,374 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:31,374 - tensor_defense - INFO - Rank: 64, Alpha: 0.2
2025-04-20 15:39:31,374 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,485 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,485 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:31,486 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:31,486 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-20 15:39:31,486 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,603 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,603 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:31,603 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:31,604 - tensor_defense - INFO - Rank: 64, Alpha: 0.4
2025-04-20 15:39:31,604 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,716 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,717 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:31,717 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:31,717 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:31,717 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,829 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,829 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:31,829 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:31,829 - tensor_defense - INFO - Rank: 64, Alpha: 0.6
2025-04-20 15:39:31,829 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,941 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:31,941 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:31,941 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:31,941 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-20 15:39:31,941 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,052 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,052 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,053 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,053 - tensor_defense - INFO - Rank: 64, Alpha: 0.8
2025-04-20 15:39:32,053 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,163 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,163 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,164 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,164 - tensor_defense - INFO - Rank: 64, Alpha: 0.9
2025-04-20 15:39:32,164 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,272 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,273 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,273 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,273 - tensor_defense - INFO - Rank: 16, Alpha: 0.5
2025-04-20 15:39:32,273 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,349 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,350 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,350 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,350 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-20 15:39:32,350 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,449 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,449 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,449 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,449 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:32,450 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,560 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,560 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,560 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,560 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-20 15:39:32,560 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,689 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,689 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,689 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,689 - tensor_defense - INFO - Rank: 256, Alpha: 0.5
2025-04-20 15:39:32,690 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,862 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,862 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:32,862 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:32,862 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:32,862 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,972 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:32,972 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:32,972 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:32,973 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:32,973 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,016 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:33,016 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:33,016 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,017 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,125 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,125 - tensor_defense - INFO - Initialized cp tensor defense on qkv (vision layer -1)
2025-04-20 15:39:33,125 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,125 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,130 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,131 - tensor_defense - INFO - Initialized cp tensor defense on projection (vision layer -1)
2025-04-20 15:39:33,131 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,131 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,137 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,137 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:33,137 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:33,138 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,138 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,199 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,199 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:33,200 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:33,200 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-20 15:39:33,200 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-20 15:39:33,200 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,200 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:33,200 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,364 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,364 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,364 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,364 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:33,365 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,365 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:33,365 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:33,365 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,365 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-20 15:39:33,365 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-20 15:39:33,365 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,365 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:33,366 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:33,588 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,588 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,588 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,588 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:33,588 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,588 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:33,589 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:33,589 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:33,589 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:33,589 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,589 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-20 15:39:33,589 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:33,800 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,800 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,800 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,801 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:33,801 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:33,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:33,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:33,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:33,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:33,802 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,802 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:33,802 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:33,802 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:33,802 - tensor_defense - INFO - Initialized multi-layer defense with 3 layers
2025-04-20 15:39:33,802 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:34,115 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,116 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:34,116 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,116 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:34,116 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:34,117 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,117 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:34,117 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:34,117 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,117 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:34,117 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:34,117 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,117 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:34,118 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:34,118 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,118 - tensor_defense - INFO - Initialized multi-layer defense with 4 layers
2025-04-20 15:39:34,118 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:34,537 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,537 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,538 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:34,538 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:34,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:34,539 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:34,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:34,539 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:34,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:34,539 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:34,539 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:34,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:34,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,540 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:34,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:34,540 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:34,540 - tensor_defense - INFO - Initialized multi-layer defense with 5 layers
2025-04-20 15:39:34,540 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:35,063 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,063 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,063 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,063 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,063 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,064 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:35,064 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:35,065 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-20 15:39:35,065 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-20 15:39:35,065 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,065 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-20 15:39:35,065 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-20 15:39:35,065 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,065 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 9 final norm
2025-04-20 15:39:35,065 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -3)
2025-04-20 15:39:35,065 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 8 final norm
2025-04-20 15:39:35,066 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -4)
2025-04-20 15:39:35,066 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 7 final norm
2025-04-20 15:39:35,066 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -5)
2025-04-20 15:39:35,066 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 6 final norm
2025-04-20 15:39:35,066 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -6)
2025-04-20 15:39:35,066 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,066 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 5 final norm
2025-04-20 15:39:35,066 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -7)
2025-04-20 15:39:35,067 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,067 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 4 final norm
2025-04-20 15:39:35,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -8)
2025-04-20 15:39:35,067 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,067 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 3 final norm
2025-04-20 15:39:35,067 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -9)
2025-04-20 15:39:35,067 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,068 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 2 final norm
2025-04-20 15:39:35,068 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -10)
2025-04-20 15:39:35,068 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,068 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 1 final norm
2025-04-20 15:39:35,068 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -11)
2025-04-20 15:39:35,068 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,068 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 0 final norm
2025-04-20 15:39:35,068 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -12)
2025-04-20 15:39:35,069 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-20 15:39:35,069 - tensor_defense - INFO - Initialized multi-layer defense with 12 layers
2025-04-20 15:39:35,069 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:36,410 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,410 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,411 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-20 15:39:36,412 - tensor_defense - INFO - All hooks removed
2025-04-20 15:39:37,171 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-20 15:39:37,172 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:39:37,172 - tensor_defense - INFO - 
clean:
2025-04-20 15:39:37,172 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-20 15:39:37,172 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-20 15:39:37,172 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-20 15:39:37,172 - tensor_defense - INFO - 
adversarial:
2025-04-20 15:39:37,173 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:39:37,173 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:39:37,173 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:39:37,173 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.1):
2025-04-20 15:39:37,173 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:39:37,173 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:39:37,173 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:39:37,174 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.2):
2025-04-20 15:39:37,174 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:39:37,174 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:39:37,174 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:39:37,174 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-20 15:39:37,174 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:39:37,174 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:39:37,175 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:39:37,175 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.4):
2025-04-20 15:39:37,175 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:39:37,175 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:39:37,175 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:39:37,175 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-20 15:39:37,175 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:39:37,176 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:39:37,176 - tensor_defense - INFO -   Recall@10: 0.3984
2025-04-20 15:39:37,176 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.6):
2025-04-20 15:39:37,176 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:39:37,176 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:39:37,176 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:39:37,177 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-20 15:39:37,177 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:39:37,177 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:39:37,177 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:39:37,177 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.8):
2025-04-20 15:39:37,177 - tensor_defense - INFO -   Recall@1: 0.2500
2025-04-20 15:39:37,177 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:39:37,177 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:39:37,178 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.9):
2025-04-20 15:39:37,178 - tensor_defense - INFO -   Recall@1: 0.2422
2025-04-20 15:39:37,178 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:39:37,178 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:39:37,178 - tensor_defense - INFO - 
CP Final Norm (R=16, alpha=0.5):
2025-04-20 15:39:37,178 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:39:37,179 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:39:37,179 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:39:37,179 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-20 15:39:37,179 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-20 15:39:37,179 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:39:37,179 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:39:37,179 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-20 15:39:37,179 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:39:37,180 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-20 15:39:37,180 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:39:37,180 - tensor_defense - INFO - 
CP Final Norm (R=256, alpha=0.5):
2025-04-20 15:39:37,180 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:39:37,180 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-20 15:39:37,180 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:39:37,180 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-20 15:39:37,180 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-20 15:39:37,181 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:39:37,181 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-20 15:39:37,181 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-20 15:39:37,181 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-20 15:39:37,181 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-20 15:39:37,181 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:39:37,181 - tensor_defense - INFO - 
CP QKV (R=64, alpha=0.5):
2025-04-20 15:39:37,181 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:39:37,182 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:39:37,182 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:39:37,182 - tensor_defense - INFO - 
CP Projection (R=64, alpha=0.5):
2025-04-20 15:39:37,182 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-20 15:39:37,182 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-20 15:39:37,182 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-20 15:39:37,182 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-20 15:39:37,183 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-20 15:39:37,183 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-20 15:39:37,183 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-20 15:39:37,183 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + Attention):
2025-04-20 15:39:37,183 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-20 15:39:37,183 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-20 15:39:37,184 - tensor_defense - INFO -   Recall@10: 0.4219
2025-04-20 15:39:37,184 - tensor_defense - INFO - 
CP Multi-Layer (Final Norm + MLP):
2025-04-20 15:39:37,184 - tensor_defense - INFO -   Recall@1: 0.2812
2025-04-20 15:39:37,184 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-20 15:39:37,184 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-20 15:39:37,184 - tensor_defense - INFO - 
CP Multi-Layer (Last 2 Layers):
2025-04-20 15:39:37,184 - tensor_defense - INFO -   Recall@1: 0.3594
2025-04-20 15:39:37,185 - tensor_defense - INFO -   Recall@5: 0.3359
2025-04-20 15:39:37,185 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-20 15:39:37,185 - tensor_defense - INFO - 
CP Multi-Layer (Last 3 Layers):
2025-04-20 15:39:37,185 - tensor_defense - INFO -   Recall@1: 0.3828
2025-04-20 15:39:37,185 - tensor_defense - INFO -   Recall@5: 0.3594
2025-04-20 15:39:37,185 - tensor_defense - INFO -   Recall@10: 0.4922
2025-04-20 15:39:37,185 - tensor_defense - INFO - 
CP Multi-Layer (Last 4 Layers):
2025-04-20 15:39:37,185 - tensor_defense - INFO -   Recall@1: 0.3750
2025-04-20 15:39:37,186 - tensor_defense - INFO -   Recall@5: 0.3672
2025-04-20 15:39:37,186 - tensor_defense - INFO -   Recall@10: 0.4922
2025-04-20 15:39:37,186 - tensor_defense - INFO - 
CP Multi-Layer (Last 5 Layers):
2025-04-20 15:39:37,186 - tensor_defense - INFO -   Recall@1: 0.4531
2025-04-20 15:39:37,186 - tensor_defense - INFO -   Recall@5: 0.4531
2025-04-20 15:39:37,186 - tensor_defense - INFO -   Recall@10: 0.5547
2025-04-20 15:39:37,186 - tensor_defense - INFO - 
CP Multi-Layer (All Final Norm Layers):
2025-04-20 15:39:37,186 - tensor_defense - INFO -   Recall@1: 0.3047
2025-04-20 15:39:37,187 - tensor_defense - INFO -   Recall@5: 0.2500
2025-04-20 15:39:37,187 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-20 15:39:37,187 - tensor_defense - INFO - --------------------------------------------------
2025-04-20 15:39:39,489 - tensor_defense - INFO - All paper figures saved to results/sweep_config\figures\figures
2025-04-20 15:39:39,489 - tensor_defense - INFO - All visualization plots saved to results/sweep_config\figures\figures
2025-04-20 15:39:39,497 - tensor_defense - INFO - Experiment sweep_config completed. Results saved to results/sweep_config
2025-04-20 15:39:39,512 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:49:50,097 - tensor_defense - INFO - Running experiment: config
2025-04-22 09:49:50,097 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 09:49:50,110 - tensor_defense - INFO - Using device: cuda
2025-04-22 09:49:50,116 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 09:49:52,211 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 09:49:52,211 - tensor_defense - INFO - Loading dataset: microsoft/coco, split: test, max_samples: 100
2025-04-22 09:53:30,978 - tensor_defense - INFO - Running experiment: config
2025-04-22 09:53:30,978 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 09:53:30,990 - tensor_defense - INFO - Using device: cuda
2025-04-22 09:53:30,993 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 09:53:33,058 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 09:53:33,059 - tensor_defense - INFO - Loading dataset: microsoft/coco, split: test, max_samples: 100
2025-04-22 09:54:04,694 - tensor_defense - INFO - Running experiment: config
2025-04-22 09:54:04,694 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 09:54:04,703 - tensor_defense - INFO - Using device: cuda
2025-04-22 09:54:04,706 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 09:54:06,316 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 09:54:06,316 - tensor_defense - INFO - Loading dataset: HuggingFaceM4/COCO, split: test, max_samples: 100
2025-04-22 09:54:51,909 - tensor_defense - INFO - Running experiment: config
2025-04-22 09:54:51,910 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 09:54:51,919 - tensor_defense - INFO - Using device: cuda
2025-04-22 09:54:51,922 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 09:54:53,344 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 09:54:53,344 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-22 09:54:56,626 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 09:54:56,626 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 09:54:56,626 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 09:54:56,626 - root - INFO - Random start: True, Targeted: False
2025-04-22 09:54:56,626 - tensor_defense - INFO - Processing batches...
2025-04-22 09:55:01,162 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 09:55:03,575 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 09:55:03,919 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 09:55:04,289 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 09:55:04,644 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 09:55:05,012 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 09:55:05,013 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 09:55:05,199 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:05,199 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:05,200 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:05,417 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:05,418 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 09:55:05,418 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 09:55:05,418 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:05,418 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:05,563 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:05,564 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 09:55:05,564 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 09:55:05,564 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:05,564 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:05,680 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:05,680 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:05,680 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:05,681 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:05,681 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:05,929 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:05,929 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:05,929 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:05,929 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 09:55:05,930 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,062 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,062 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:06,062 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:06,062 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 09:55:06,063 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,194 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,194 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:06,194 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:06,194 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 09:55:06,194 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,331 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,331 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:06,331 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:06,332 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 09:55:06,332 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,481 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,481 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:06,482 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:06,482 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:06,482 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 09:55:06,482 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 09:55:06,482 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:06,483 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 09:55:06,483 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,735 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,735 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,735 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,736 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:06,736 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:06,765 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 09:55:08,004 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:08,005 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:08,005 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:08,005 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:08,151 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,151 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 09:55:08,151 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 09:55:08,151 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:08,152 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,282 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,283 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 09:55:08,283 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 09:55:08,283 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:08,283 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,400 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,400 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:08,400 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:08,401 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:08,401 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,629 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,629 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:08,629 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:08,629 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 09:55:08,630 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,761 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,761 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:08,761 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:08,761 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 09:55:08,761 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,892 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:08,892 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:08,892 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:08,892 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 09:55:08,893 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,003 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,003 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:09,003 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:09,003 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 09:55:09,003 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,160 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,161 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:09,161 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:09,161 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:09,161 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 09:55:09,161 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 09:55:09,161 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:09,162 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 09:55:09,162 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,438 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,438 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,438 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,438 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:09,439 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:09,468 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 09:55:10,844 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:10,845 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:10,845 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:10,845 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:10,991 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:10,991 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 09:55:10,991 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 09:55:10,991 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:10,991 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,127 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,127 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 09:55:11,128 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 09:55:11,128 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:11,128 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,245 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,246 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:11,246 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:11,246 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:11,246 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,472 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,473 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:11,473 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:11,473 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 09:55:11,473 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,606 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,606 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:11,607 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:11,607 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 09:55:11,607 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,741 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,741 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:11,741 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:11,741 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 09:55:11,741 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,844 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:11,844 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:11,844 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:11,844 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 09:55:11,844 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,006 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,006 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:12,006 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:12,006 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:12,006 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 09:55:12,006 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 09:55:12,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:12,007 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 09:55:12,007 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,240 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,240 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,240 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,240 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:12,240 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,263 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 09:55:12,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:12,644 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:12,644 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:12,644 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:12,767 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,767 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 09:55:12,767 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 09:55:12,767 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:12,768 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,838 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,838 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 09:55:12,838 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 09:55:12,838 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:12,838 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,950 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:12,951 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:12,951 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:12,951 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:12,951 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,017 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,018 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:13,018 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:13,018 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 09:55:13,018 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,137 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,137 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:13,137 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:13,137 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 09:55:13,138 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,259 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,259 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:13,259 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:13,259 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 09:55:13,260 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,367 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,367 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:13,368 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:13,368 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 09:55:13,368 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,503 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,503 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 09:55:13,504 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 09:55:13,504 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:13,504 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 09:55:13,504 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 09:55:13,504 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 09:55:13,504 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 09:55:13,504 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,725 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,725 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,725 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:13,726 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:13,726 - tensor_defense - INFO - All hooks removed
2025-04-22 09:55:14,476 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 09:55:14,476 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 09:55:14,476 - tensor_defense - INFO - 
clean:
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-22 09:55:14,477 - tensor_defense - INFO - 
adversarial:
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-22 09:55:14,477 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-22 09:55:14,477 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-22 09:55:14,478 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@5: 0.2812
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@10: 0.3750
2025-04-22 09:55:14,478 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 09:55:14,478 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-22 09:55:14,478 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 09:55:14,479 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 09:55:14,479 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 09:55:14,479 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-22 09:55:14,479 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-22 09:55:14,479 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-22 09:55:14,479 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 09:55:14,479 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-22 09:55:14,479 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 09:55:14,479 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 09:55:14,479 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@10: 0.4062
2025-04-22 09:55:14,480 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 09:55:14,480 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@1: 0.3594
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@5: 0.3281
2025-04-22 09:55:14,480 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-22 09:55:14,481 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 09:55:16,259 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 09:55:16,260 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 09:55:16,281 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 09:55:16,293 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 09:55:29,626 - tensor_defense - INFO - Running experiment: config
2025-04-22 09:55:29,626 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 09:55:29,639 - tensor_defense - INFO - Using device: cuda
2025-04-22 09:55:29,641 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 09:55:31,032 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 09:55:31,032 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: test, max_samples: 100
2025-04-22 09:56:14,846 - tensor_defense - INFO - Running experiment: config
2025-04-22 09:56:14,846 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 09:56:14,856 - tensor_defense - INFO - Using device: cuda
2025-04-22 09:56:14,858 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 09:56:16,386 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 09:56:16,387 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: test, max_samples: 100
2025-04-22 09:56:42,136 - tensor_defense - INFO - Running experiment: config
2025-04-22 09:56:42,136 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 09:56:42,146 - tensor_defense - INFO - Using device: cuda
2025-04-22 09:56:42,149 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 09:56:43,958 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 09:56:43,959 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: test, max_samples: 100
2025-04-22 10:01:30,255 - tensor_defense - INFO - Running experiment: config
2025-04-22 10:01:30,255 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 10:01:30,265 - tensor_defense - INFO - Using device: cuda
2025-04-22 10:01:30,267 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 10:01:31,937 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 10:01:31,937 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: test, max_samples: 100
2025-04-22 10:01:31,937 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 10:06:34,111 - tensor_defense - ERROR - Error loading COCO dataset: 
2025-04-22 10:07:28,869 - tensor_defense - INFO - Running experiment: config
2025-04-22 10:07:28,869 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 10:07:28,879 - tensor_defense - INFO - Using device: cuda
2025-04-22 10:07:28,882 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 10:07:30,886 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 10:07:30,886 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: test, max_samples: 100
2025-04-22 10:07:30,886 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 10:12:33,110 - tensor_defense - ERROR - Error loading COCO dataset: 
2025-04-22 10:17:42,204 - tensor_defense - INFO - Running experiment: config
2025-04-22 10:17:42,204 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 10:17:42,215 - tensor_defense - INFO - Using device: cuda
2025-04-22 10:17:42,217 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 10:17:43,740 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 10:17:43,741 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: test, max_samples: 100
2025-04-22 10:17:43,741 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 10:19:20,611 - tensor_defense - INFO - Running experiment: config
2025-04-22 10:19:20,611 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 10:19:20,621 - tensor_defense - INFO - Using device: cuda
2025-04-22 10:19:20,624 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 10:19:22,090 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 10:19:22,091 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: test, max_samples: 100
2025-04-22 10:19:22,091 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 10:33:12,483 - datasets_modules.datasets.shunk031--MSCOCO.9a9d3cb1e5e1927e03f5448bc4e3dd95d17101d142ba4b94d6973770757f535f.MSCOCO - INFO - Load annotation json from C:\Users\techn\.cache\huggingface\datasets\downloads\extracted\2160e399b74e420e9add9c0d8c20cbce15a99be6e8d6381a70994259e47f367c\annotations\captions_train2014.json
2025-04-22 10:39:25,481 - datasets_modules.datasets.shunk031--MSCOCO.9a9d3cb1e5e1927e03f5448bc4e3dd95d17101d142ba4b94d6973770757f535f.MSCOCO - INFO - Load annotation json from C:\Users\techn\.cache\huggingface\datasets\downloads\extracted\2160e399b74e420e9add9c0d8c20cbce15a99be6e8d6381a70994259e47f367c\annotations\captions_val2014.json
2025-04-22 10:42:39,070 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:09:34,247 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:09:34,247 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:09:34,261 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:09:34,266 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:09:36,453 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:09:36,453 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: train, max_samples: 100
2025-04-22 11:09:36,453 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:09:37,222 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:09:37,224 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:09:37,225 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:09:37,225 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:09:37,225 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:09:37,225 - tensor_defense - INFO - Processing batches...
2025-04-22 11:09:42,619 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:09:45,323 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:09:45,793 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:09:46,272 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:09:46,762 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:09:47,224 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:09:47,224 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:09:47,373 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:47,373 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:47,373 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:47,648 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:47,648 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:09:47,648 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:09:47,648 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:47,648 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:47,780 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:47,780 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:09:47,780 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:09:47,780 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:47,781 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:47,937 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:47,937 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:47,938 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:47,938 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:47,938 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,262 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,262 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:48,262 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:48,263 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:09:48,263 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,435 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,435 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:48,435 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:48,435 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:09:48,436 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,602 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,602 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:48,602 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:48,602 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:09:48,603 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,752 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,753 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:48,753 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:48,753 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:09:48,753 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,947 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:48,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:48,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:48,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:48,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:09:48,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:09:48,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:48,949 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:09:48,949 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:49,261 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:49,261 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:49,261 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:49,261 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:09:49,261 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:49,276 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:09:50,469 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:50,469 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:50,469 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:50,469 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:09:50,651 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:50,652 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:09:50,652 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:09:50,652 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:50,652 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:50,832 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:50,832 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:09:50,833 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:09:50,833 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:50,833 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:50,973 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:50,974 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:50,974 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:50,974 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:50,974 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,253 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,254 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:51,254 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:51,254 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:09:51,254 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,428 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,428 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:51,428 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:51,428 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:09:51,429 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,605 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,606 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:51,606 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:51,606 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:09:51,606 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,743 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,744 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:51,744 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:51,744 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:09:51,744 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,944 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:51,945 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:51,945 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:51,945 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:51,945 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:09:51,945 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:09:51,945 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:51,945 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:09:51,945 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:52,257 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:52,257 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:52,258 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:52,258 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:09:52,258 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:52,304 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:09:53,480 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:53,481 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:53,481 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:53,481 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:09:53,658 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:53,658 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:09:53,659 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:09:53,659 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:53,659 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:53,831 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:53,831 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:09:53,832 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:09:53,832 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:53,832 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:53,975 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:53,975 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:53,975 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:53,975 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:53,975 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,249 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,250 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:54,250 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:54,250 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:09:54,250 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,431 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,431 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:54,432 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:54,432 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:09:54,432 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,600 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,600 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:54,601 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:54,601 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:09:54,601 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,737 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,737 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:54,737 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:54,737 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:09:54,737 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,933 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:54,933 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:54,933 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:54,933 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:54,934 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:09:54,934 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:09:54,934 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:54,934 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:09:54,934 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,248 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,249 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,249 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,249 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:09:55,249 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,265 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:09:55,691 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:55,692 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:55,692 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:55,692 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:09:55,846 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,847 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:09:55,847 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:09:55,847 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:55,847 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,904 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:55,904 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:09:55,905 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:09:55,905 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:55,905 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,054 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,055 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:56,055 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:56,055 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:56,055 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,151 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,152 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:56,152 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:56,152 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:09:56,152 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,309 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,309 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:56,309 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:56,309 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:09:56,310 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,463 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,463 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:56,463 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:56,463 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:09:56,463 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,598 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,598 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:56,599 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:56,599 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:09:56,599 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,774 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:56,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:09:56,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:09:56,774 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:56,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:09:56,775 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:09:56,775 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:09:56,775 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:09:56,775 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:57,076 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:57,077 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:57,077 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:57,077 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:09:57,077 - tensor_defense - INFO - All hooks removed
2025-04-22 11:09:57,984 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:09:57,984 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:09:57,985 - tensor_defense - INFO - 
clean:
2025-04-22 11:09:57,985 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,985 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,985 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,985 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:09:57,985 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,985 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,986 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,986 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,986 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:09:57,986 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,987 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,987 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,987 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,987 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,988 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,988 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,988 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:09:57,988 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:09:57,989 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:09:57,989 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:09:57,989 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:10:00,523 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:10:00,523 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:10:00,539 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:10:00,553 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:11:26,978 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:11:26,978 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:11:26,990 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:11:26,993 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:11:28,737 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:11:28,738 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: train, max_samples: 100
2025-04-22 11:11:28,738 - tensor_defense - INFO - Loading regular dataset: nlphuji/flickr30k
2025-04-22 11:11:51,414 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:11:51,415 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:11:51,426 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:11:51,429 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:11:53,606 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:11:53,607 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-22 11:11:53,607 - tensor_defense - INFO - Loading regular dataset: nlphuji/flickr30k
2025-04-22 11:11:55,715 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:11:55,716 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:11:55,716 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:11:55,716 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:11:55,716 - tensor_defense - INFO - Processing batches...
2025-04-22 11:12:00,891 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:12:03,190 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:12:03,663 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:12:04,127 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:12:04,612 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:12:05,081 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:12:05,082 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:12:05,220 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:05,220 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:05,220 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:05,470 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:05,470 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:12:05,470 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:12:05,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:05,470 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:05,635 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:05,635 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:12:05,636 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:12:05,636 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:05,636 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:05,799 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:05,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:05,800 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:05,800 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:05,800 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,093 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,094 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:06,094 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:06,094 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:12:06,094 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,273 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,273 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:06,273 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:06,273 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:12:06,273 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,451 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:06,451 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:06,451 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:12:06,451 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,599 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,599 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:06,599 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:06,600 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:12:06,600 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,797 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:06,798 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:06,798 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:06,798 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:06,798 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:12:06,798 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:12:06,798 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:06,798 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:12:06,798 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:07,114 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:07,114 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:07,114 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:07,114 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:12:07,114 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:07,155 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:12:08,691 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:08,691 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:08,691 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:08,691 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:12:08,879 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:08,879 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:12:08,880 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:12:08,880 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:08,880 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,054 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,055 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:12:09,055 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:12:09,055 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:09,055 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,213 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,213 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:09,213 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:09,213 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:09,214 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,489 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,490 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:09,490 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:09,490 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:12:09,490 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,664 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,664 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:09,664 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:09,664 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:12:09,665 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,838 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,839 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:09,839 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:09,839 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:12:09,839 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,991 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:09,991 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:09,991 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:09,992 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:12:09,992 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:10,183 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:10,183 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:10,184 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:10,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:10,184 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:12:10,184 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:12:10,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:10,184 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:12:10,184 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:10,504 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:10,504 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:10,504 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:10,504 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:12:10,505 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:10,542 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:12:12,131 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:12,131 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:12,131 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:12,131 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:12:12,317 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:12,318 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:12:12,318 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:12:12,318 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:12,318 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:12,509 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:12,509 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:12:12,509 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:12:12,509 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:12,509 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:12,682 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:12,682 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:12,682 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:12,682 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:12,683 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,004 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,005 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:13,005 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:13,005 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:12:13,005 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,207 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,207 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:13,207 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:13,207 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:12:13,207 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,396 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:13,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:13,397 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:12:13,397 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,572 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,573 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:13,573 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:13,573 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:12:13,573 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,781 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:13,781 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:13,781 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:13,782 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:13,782 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:12:13,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:12:13,782 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:13,782 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:12:13,782 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,115 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,116 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,116 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,116 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:12:14,116 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,144 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:12:14,564 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:14,564 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:14,564 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:14,565 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:12:14,721 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,722 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:12:14,722 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:12:14,722 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:14,722 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,786 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,786 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:12:14,786 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:12:14,786 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:14,787 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,936 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:14,937 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:14,937 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:14,937 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:14,937 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,016 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:15,017 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:15,017 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:12:15,017 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,175 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,175 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:15,175 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:15,175 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:12:15,175 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,324 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,325 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:15,325 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:15,325 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:12:15,325 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,465 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,466 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:15,466 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:15,466 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:12:15,466 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,643 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,644 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:12:15,644 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:12:15,644 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:15,644 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:12:15,644 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:12:15,645 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:12:15,645 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:12:15,645 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,924 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,924 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,924 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:15,924 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:12:15,925 - tensor_defense - INFO - All hooks removed
2025-04-22 11:12:16,858 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:12:16,858 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:12:16,859 - tensor_defense - INFO - 
clean:
2025-04-22 11:12:16,859 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-22 11:12:16,859 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-22 11:12:16,859 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-22 11:12:16,859 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:12:16,860 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-22 11:12:16,860 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-22 11:12:16,860 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-22 11:12:16,860 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:12:16,860 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-22 11:12:16,860 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-22 11:12:16,860 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-22 11:12:16,860 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-22 11:12:16,861 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@1: 0.2500
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:12:16,861 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 11:12:16,861 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:12:16,861 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-22 11:12:16,862 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:12:16,862 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-22 11:12:16,862 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-22 11:12:16,862 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-22 11:12:16,863 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:12:16,863 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:12:16,863 - tensor_defense - INFO -   Recall@1: 0.3594
2025-04-22 11:12:16,863 - tensor_defense - INFO -   Recall@5: 0.3359
2025-04-22 11:12:16,863 - tensor_defense - INFO -   Recall@10: 0.4453
2025-04-22 11:12:16,863 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:12:18,944 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:12:18,944 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:12:18,950 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:12:18,965 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:07,623 - tensor_defense - INFO - Running experiment: coco
2025-04-22 11:16:07,623 - tensor_defense - INFO - Results will be saved to: results\coco
2025-04-22 11:16:07,637 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:16:07,640 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:16:09,291 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:16:09,291 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: train, max_samples: 100
2025-04-22 11:16:09,291 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:16:09,971 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:16:09,973 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:16:09,974 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:16:09,974 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:16:09,974 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:16:09,974 - tensor_defense - INFO - Processing batches...
2025-04-22 11:16:15,319 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:16:17,323 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:16:17,782 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:16:18,240 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:16:18,704 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:16:19,162 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:16:19,163 - tensor_defense - INFO - Saved 5 sample image pairs to results\coco\samples
2025-04-22 11:16:19,276 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:19,277 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:19,277 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:19,521 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:19,521 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:16:19,521 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:16:19,521 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:19,521 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:19,667 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:19,667 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:16:19,667 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:16:19,667 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:19,668 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:19,827 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:19,828 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:19,828 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:19,828 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:19,828 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,122 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,123 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:20,123 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:20,123 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:16:20,123 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,298 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,298 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:20,298 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:20,298 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:16:20,299 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,471 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,472 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:20,472 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:20,472 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:16:20,472 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,607 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,608 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:20,608 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:20,608 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:16:20,608 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,816 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:20,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:20,816 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:20,816 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:20,817 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:16:20,817 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:16:20,817 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:20,817 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:16:20,817 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:21,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:21,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:21,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:21,134 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:21,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:21,187 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:16:22,358 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:22,358 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:22,358 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:22,358 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:22,548 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:22,548 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:16:22,548 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:16:22,548 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:22,549 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:22,697 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:22,697 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:16:22,697 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:16:22,697 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:22,698 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:22,854 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:22,854 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:22,854 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:22,854 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:22,854 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,156 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,156 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:23,156 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:23,156 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:16:23,157 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,341 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,342 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:23,342 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:23,342 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:16:23,342 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,520 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,520 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:23,520 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:23,521 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:16:23,521 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,662 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,662 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:23,663 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:23,663 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:16:23,663 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,852 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:23,852 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:23,852 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:23,853 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:23,853 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:16:23,853 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:16:23,853 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:23,853 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:16:23,853 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:24,171 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:24,171 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:24,171 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:24,172 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:24,172 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:24,217 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:16:25,390 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:25,390 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:25,390 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:25,390 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:25,563 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:25,564 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:16:25,564 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:16:25,564 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:25,564 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:25,741 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:25,741 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:16:25,741 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:16:25,742 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:25,742 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:25,909 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:25,910 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:25,910 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:25,910 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:25,910 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,193 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,194 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:26,194 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:26,194 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:16:26,194 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,374 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,375 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:26,375 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:26,375 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:16:26,376 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,551 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,551 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:26,552 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:26,552 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:16:26,552 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,686 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,687 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:26,687 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:26,687 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:16:26,687 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,884 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:26,885 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:26,885 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:26,885 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:26,885 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:16:26,885 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:16:26,886 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:26,886 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:16:26,886 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,199 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,200 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,200 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,200 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:27,200 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,216 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:16:27,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:27,644 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:27,644 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:27,644 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:27,808 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,808 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:16:27,808 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:16:27,808 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:27,809 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,882 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:27,882 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:16:27,882 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:16:27,882 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:27,883 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,045 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,046 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:28,046 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:28,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:28,046 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,146 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:28,147 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:28,147 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:16:28,147 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,313 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,313 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:28,313 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:28,313 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:16:28,314 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,477 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,477 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:28,477 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:28,478 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:16:28,478 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,629 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,629 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:28,629 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:28,629 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:16:28,630 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,800 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:28,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:16:28,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:16:28,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:28,801 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:16:28,801 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:16:28,802 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:16:28,802 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:16:28,802 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:29,095 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:29,095 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:29,096 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:29,096 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:16:29,096 - tensor_defense - INFO - All hooks removed
2025-04-22 11:16:30,017 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:16:30,017 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:16:30,017 - tensor_defense - INFO - 
clean:
2025-04-22 11:16:30,017 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,017 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,018 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,018 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,018 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:16:30,018 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,019 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,019 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,019 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:16:30,019 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,020 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,020 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,020 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,021 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:16:30,021 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,021 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,021 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,021 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:16:30,021 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:16:30,021 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:16:30,021 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:16:30,021 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:16:32,569 - tensor_defense - INFO - All paper figures saved to results\coco\figures\figures
2025-04-22 11:16:32,570 - tensor_defense - INFO - All visualization plots saved to results\coco\figures\figures
2025-04-22 11:16:32,577 - tensor_defense - INFO - Experiment coco completed. Results saved to results\coco
2025-04-22 11:16:32,593 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:08,595 - tensor_defense - INFO - Running experiment: coco
2025-04-22 11:19:08,595 - tensor_defense - INFO - Results will be saved to: results\coco
2025-04-22 11:19:08,607 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:19:08,610 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:19:10,227 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:19:10,228 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: train, max_samples: 100
2025-04-22 11:19:10,228 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:19:10,908 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:19:10,918 - tensor_defense - INFO - Dataset first item keys: ['annotations', 'coco_url', 'date_captured', 'file_name', 'flickr_url', 'height', 'image', 'image_id', 'license', 'license_id', 'width']
2025-04-22 11:19:10,919 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:19:10,919 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:19:10,919 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:19:10,919 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:19:10,919 - tensor_defense - INFO - Processing batches...
2025-04-22 11:19:16,189 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:19:18,301 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:19:18,781 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:19:19,259 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:19:19,749 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:19:20,225 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:19:20,225 - tensor_defense - INFO - Saved 5 sample image pairs to results\coco\samples
2025-04-22 11:19:20,346 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:20,346 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:20,346 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:20,595 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:20,595 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:19:20,596 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:19:20,596 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:20,596 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:20,772 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:20,773 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:19:20,773 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:19:20,773 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:20,773 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:20,936 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:20,936 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:20,936 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:20,937 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:20,937 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,252 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,253 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:21,253 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:21,253 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:19:21,253 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,438 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,438 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:21,438 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:21,439 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:19:21,439 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,611 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,612 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:21,612 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:21,612 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:19:21,612 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,772 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,773 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:21,773 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:21,773 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:19:21,773 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,987 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:21,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:21,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:21,988 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:21,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:19:21,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:19:21,988 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:21,988 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:19:21,988 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:22,321 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:22,322 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:22,322 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:22,322 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:22,322 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:22,373 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:19:23,614 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:23,614 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:23,615 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:23,615 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:23,800 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:23,800 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:19:23,800 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:19:23,801 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:23,801 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:23,946 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:23,946 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:19:23,947 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:19:23,947 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:23,947 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,104 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,105 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:24,105 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:24,105 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:24,105 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,397 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,398 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:24,398 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:24,398 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:19:24,398 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,577 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,578 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:24,578 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:24,578 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:19:24,578 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,754 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,755 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:24,755 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:24,755 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:19:24,755 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,901 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:24,901 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:24,901 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:24,901 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:19:24,901 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:25,106 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:25,107 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:25,107 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:25,107 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:25,107 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:19:25,107 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:19:25,107 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:25,108 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:19:25,108 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:25,433 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:25,434 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:25,434 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:25,434 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:25,434 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:25,480 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:19:26,785 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:26,785 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:26,785 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:26,786 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:27,001 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,001 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:19:27,001 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:19:27,001 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:27,002 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,149 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,149 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:19:27,149 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:19:27,150 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:27,150 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,334 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,335 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:27,335 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:27,335 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:27,335 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,639 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,640 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:27,640 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:27,640 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:19:27,640 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,850 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:27,850 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:27,850 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:27,850 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:19:27,851 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,026 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,026 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:28,027 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:28,027 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:19:28,027 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,156 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,157 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:28,157 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:28,157 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:19:28,157 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,354 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,354 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:28,354 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:28,354 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:28,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:19:28,355 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:19:28,355 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:28,355 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:19:28,355 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,667 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,667 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,667 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,667 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:28,667 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:28,684 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:19:29,096 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:29,097 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:29,097 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:29,097 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:29,253 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,254 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:19:29,254 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:19:29,254 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:29,254 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,316 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,316 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:19:29,317 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:19:29,317 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:29,317 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,467 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,468 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:29,468 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:29,468 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:29,468 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,551 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:29,552 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:29,552 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:19:29,552 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,692 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,693 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:29,693 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:29,693 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:19:29,693 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,840 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,841 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:29,841 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:29,841 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:19:29,841 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,978 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:29,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:29,978 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:29,978 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:19:29,978 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:30,155 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:30,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:19:30,155 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:19:30,156 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:30,156 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:19:30,156 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:19:30,156 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:19:30,156 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:19:30,156 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:30,456 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:30,456 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:30,457 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:30,457 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:19:30,457 - tensor_defense - INFO - All hooks removed
2025-04-22 11:19:31,384 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:19:31,385 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:19:31,385 - tensor_defense - INFO - 
clean:
2025-04-22 11:19:31,385 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,385 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,385 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,385 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:19:31,386 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,386 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,386 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,386 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:19:31,386 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,386 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,386 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,386 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:19:31,386 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,387 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,387 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,387 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,388 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:19:31,388 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,388 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,388 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,388 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:19:31,388 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,388 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,388 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,388 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,389 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,389 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:19:31,389 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:19:31,389 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:19:33,803 - tensor_defense - INFO - All paper figures saved to results\coco\figures\figures
2025-04-22 11:19:33,804 - tensor_defense - INFO - All visualization plots saved to results\coco\figures\figures
2025-04-22 11:19:33,810 - tensor_defense - INFO - Experiment coco completed. Results saved to results\coco
2025-04-22 11:19:33,828 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:06,975 - tensor_defense - INFO - Running experiment: flicker
2025-04-22 11:20:06,976 - tensor_defense - INFO - Results will be saved to: results\flicker
2025-04-22 11:20:06,990 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:20:06,993 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:20:08,854 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:20:08,854 - tensor_defense - INFO - Loading dataset: nlphuji/flickr30k, split: test, max_samples: 100
2025-04-22 11:20:08,854 - tensor_defense - INFO - Loading regular dataset: nlphuji/flickr30k
2025-04-22 11:20:12,318 - tensor_defense - INFO - Dataset first item keys: ['caption', 'filename', 'image', 'img_id', 'sentids', 'split']
2025-04-22 11:20:12,318 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:20:12,318 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:20:12,319 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:20:12,319 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:20:12,319 - tensor_defense - INFO - Processing batches...
2025-04-22 11:20:17,716 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:20:19,824 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:20:20,223 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:20:20,623 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:20:21,043 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:20:21,444 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:20:21,445 - tensor_defense - INFO - Saved 5 sample image pairs to results\flicker\samples
2025-04-22 11:20:21,579 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:21,579 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:21,579 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:21,811 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:21,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:20:21,812 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:20:21,812 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:21,812 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:21,985 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:21,985 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:20:21,985 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:20:21,985 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:21,985 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,151 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,152 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:22,152 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:22,152 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:22,152 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,473 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,473 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:22,473 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:22,473 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:20:22,473 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,662 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,662 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:22,662 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:22,663 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:20:22,663 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,849 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:22,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:22,849 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:22,849 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:20:22,850 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,021 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,021 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:23,021 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:23,021 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:20:23,021 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,219 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,219 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:23,219 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:23,219 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:23,220 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:20:23,220 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:20:23,220 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:23,220 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:20:23,220 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,546 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,546 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,546 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,546 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:23,546 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:23,584 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:20:24,987 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:24,987 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:24,987 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:24,987 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:25,166 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,167 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:20:25,167 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:20:25,167 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:25,167 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,345 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,345 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:20:25,345 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:20:25,345 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:25,345 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,497 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,497 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:25,497 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:25,497 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:25,497 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,781 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,781 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:25,782 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:25,782 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:20:25,782 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,956 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:25,956 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:25,956 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:25,956 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:20:25,957 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,132 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,133 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:26,133 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:26,133 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:20:26,133 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,274 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,275 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:26,275 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:26,275 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:20:26,275 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,473 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,473 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:26,473 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:26,473 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:26,473 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:20:26,473 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:20:26,474 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:26,474 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:20:26,474 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,788 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,788 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,788 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,788 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:26,789 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:26,825 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:20:28,397 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:28,397 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:28,397 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:28,397 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:28,570 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:28,571 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:20:28,571 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:20:28,571 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:28,571 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:28,742 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:28,743 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:20:28,743 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:20:28,743 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:28,743 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:28,901 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:28,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:28,902 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:28,902 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:28,902 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,178 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,178 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:29,178 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:29,179 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:20:29,179 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,351 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,352 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:29,352 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:29,352 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:20:29,352 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,527 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:29,528 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:29,528 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:20:29,528 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,689 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,689 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:29,690 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:29,690 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:20:29,690 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,892 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:29,892 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:29,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:29,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:29,893 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:20:29,893 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:20:29,893 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:29,894 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:20:29,894 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,212 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,212 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,212 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,212 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:30,213 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,241 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:20:30,660 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:30,660 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:30,661 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:30,661 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:30,816 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,816 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:20:30,817 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:20:30,817 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:30,817 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,901 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:30,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:20:30,902 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:20:30,902 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:30,902 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,055 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,055 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:31,055 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:31,056 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:31,056 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,134 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:31,135 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:31,135 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:20:31,135 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,290 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,291 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:31,291 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:31,291 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:20:31,291 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,451 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,452 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:31,452 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:31,452 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:20:31,452 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,600 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,600 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:31,600 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:31,600 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:20:31,601 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,776 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:31,777 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:20:31,777 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:20:31,777 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:31,777 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:20:31,777 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:20:31,778 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:20:31,778 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:20:31,778 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:32,083 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:32,083 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:32,084 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:32,084 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:32,084 - tensor_defense - INFO - All hooks removed
2025-04-22 11:20:33,025 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:20:33,026 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:20:33,026 - tensor_defense - INFO - 
clean:
2025-04-22 11:20:33,026 - tensor_defense - INFO -   Recall@1: 0.9375
2025-04-22 11:20:33,026 - tensor_defense - INFO -   Recall@5: 0.7422
2025-04-22 11:20:33,026 - tensor_defense - INFO -   Recall@10: 0.7500
2025-04-22 11:20:33,026 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:20:33,026 - tensor_defense - INFO -   Recall@1: 0.2266
2025-04-22 11:20:33,026 - tensor_defense - INFO -   Recall@5: 0.2656
2025-04-22 11:20:33,027 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-22 11:20:33,027 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:20:33,027 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-22 11:20:33,027 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-22 11:20:33,027 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-22 11:20:33,027 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:20:33,027 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-22 11:20:33,027 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@10: 0.3672
2025-04-22 11:20:33,028 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@1: 0.2578
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@5: 0.2891
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:20:33,028 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@5: 0.2969
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:20:33,028 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:20:33,028 - tensor_defense - INFO -   Recall@1: 0.2969
2025-04-22 11:20:33,029 - tensor_defense - INFO -   Recall@5: 0.3203
2025-04-22 11:20:33,029 - tensor_defense - INFO -   Recall@10: 0.4141
2025-04-22 11:20:33,029 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:20:33,029 - tensor_defense - INFO -   Recall@1: 0.2656
2025-04-22 11:20:33,029 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-22 11:20:33,029 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:20:33,029 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:20:33,029 - tensor_defense - INFO -   Recall@1: 0.2891
2025-04-22 11:20:33,029 - tensor_defense - INFO -   Recall@5: 0.3047
2025-04-22 11:20:33,030 - tensor_defense - INFO -   Recall@10: 0.3906
2025-04-22 11:20:33,030 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:20:33,030 - tensor_defense - INFO -   Recall@1: 0.2734
2025-04-22 11:20:33,030 - tensor_defense - INFO -   Recall@5: 0.3125
2025-04-22 11:20:33,030 - tensor_defense - INFO -   Recall@10: 0.3828
2025-04-22 11:20:33,030 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:20:33,030 - tensor_defense - INFO -   Recall@1: 0.3672
2025-04-22 11:20:33,030 - tensor_defense - INFO -   Recall@5: 0.3359
2025-04-22 11:20:33,030 - tensor_defense - INFO -   Recall@10: 0.4375
2025-04-22 11:20:33,031 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:20:35,037 - tensor_defense - INFO - All paper figures saved to results\flicker\figures\figures
2025-04-22 11:20:35,038 - tensor_defense - INFO - All visualization plots saved to results\flicker\figures\figures
2025-04-22 11:20:35,044 - tensor_defense - INFO - Experiment flicker completed. Results saved to results\flicker
2025-04-22 11:20:35,057 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:20:52,747 - tensor_defense - INFO - Running experiment: coco
2025-04-22 11:20:52,747 - tensor_defense - INFO - Results will be saved to: results\coco
2025-04-22 11:20:52,763 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:20:52,766 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:20:54,448 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:20:54,448 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: train, max_samples: 100
2025-04-22 11:20:54,448 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:20:55,097 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:20:55,107 - tensor_defense - INFO - Dataset first item keys: ['annotations', 'coco_url', 'date_captured', 'file_name', 'flickr_url', 'height', 'image', 'image_id', 'license', 'license_id', 'width']
2025-04-22 11:20:55,107 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:20:55,108 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:20:55,108 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:20:55,108 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:20:55,108 - tensor_defense - INFO - Processing batches...
2025-04-22 11:21:00,553 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:21:02,541 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:21:02,937 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:21:03,384 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:21:03,820 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:21:04,213 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:21:04,213 - tensor_defense - INFO - Saved 5 sample image pairs to results\coco\samples
2025-04-22 11:21:04,312 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:04,313 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:04,313 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:04,549 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:04,549 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:21:04,549 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:21:04,550 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:04,550 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:04,725 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:04,725 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:21:04,725 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:21:04,726 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:04,726 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:04,894 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:04,895 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:04,895 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:04,895 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:04,895 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,198 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,198 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:05,198 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:05,198 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:21:05,199 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,400 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,400 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:05,400 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:05,400 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:21:05,400 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,586 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,586 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:05,586 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:05,587 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:21:05,587 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,741 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,741 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:05,742 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:05,742 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:21:05,742 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,950 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:05,950 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:05,950 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:05,951 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:05,951 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:21:05,951 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:21:05,951 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:05,951 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:21:05,951 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:06,272 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:06,273 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:06,273 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:06,273 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:21:06,273 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:06,318 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:21:07,512 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:07,512 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:07,513 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:07,513 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:21:07,687 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:07,687 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:21:07,688 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:21:07,688 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:07,688 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:07,878 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:07,878 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:21:07,878 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:21:07,878 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:07,879 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,047 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,047 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:08,047 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:08,047 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:08,048 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,334 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,335 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:08,335 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:08,335 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:21:08,335 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,517 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,517 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:08,518 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:08,518 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:21:08,518 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,698 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,699 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:08,699 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:08,699 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:21:08,699 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,848 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:08,848 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:08,848 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:08,848 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:21:08,849 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:09,051 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:09,051 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:09,051 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:09,051 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:09,052 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:21:09,052 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:21:09,052 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:09,052 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:21:09,052 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:09,371 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:09,372 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:09,372 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:09,372 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:21:09,372 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:09,422 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:21:10,681 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:10,681 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:10,681 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:10,681 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:21:10,874 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:10,874 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:21:10,874 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:21:10,874 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:10,874 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,026 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,027 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:21:11,027 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:21:11,027 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:11,027 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,183 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,183 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:11,183 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:11,184 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:11,184 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,457 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,458 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:11,458 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:11,458 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:21:11,458 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,639 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,639 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:11,639 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:11,639 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:21:11,639 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,831 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,831 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:11,832 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:11,832 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:21:11,832 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,989 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:11,989 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:11,989 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:11,990 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:21:11,990 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:12,202 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:12,202 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:12,203 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:12,203 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:12,203 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:21:12,203 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:21:12,203 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:12,203 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:21:12,204 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:12,526 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:12,526 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:12,526 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:12,526 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:21:12,526 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:12,547 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:21:12,988 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:12,988 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:12,988 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:12,988 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:21:13,151 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,151 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:21:13,151 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:21:13,151 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:13,151 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,238 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,238 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:21:13,238 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:21:13,238 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:13,239 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,389 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,389 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:13,390 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:13,390 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:13,390 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,470 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,470 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:13,470 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:13,470 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:21:13,471 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,629 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,630 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:13,630 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:13,630 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:21:13,630 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,788 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,788 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:13,789 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:13,789 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:21:13,789 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,946 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:13,946 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:13,946 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:13,946 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:21:13,947 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:14,130 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:14,130 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:21:14,130 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:21:14,131 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:14,131 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:21:14,131 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:21:14,131 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:21:14,131 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:21:14,131 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:14,444 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:14,445 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:14,445 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:14,445 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:21:14,445 - tensor_defense - INFO - All hooks removed
2025-04-22 11:21:15,392 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:21:15,393 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:21:15,393 - tensor_defense - INFO - 
clean:
2025-04-22 11:21:15,393 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,393 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,394 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,394 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:21:15,394 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,394 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,394 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,395 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:21:15,395 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,395 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,395 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,395 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:21:15,395 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,395 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,395 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,396 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:21:15,396 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,396 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,396 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,396 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:21:15,396 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,396 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,396 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,397 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:21:15,397 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,397 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,397 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,397 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:21:15,397 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,398 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,398 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,398 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:21:15,398 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,398 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,398 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,398 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:21:15,399 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,399 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,399 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,399 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:21:15,399 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:21:15,399 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:21:15,399 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:21:15,399 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:21:18,153 - tensor_defense - INFO - All paper figures saved to results\coco\figures\figures
2025-04-22 11:21:18,153 - tensor_defense - INFO - All visualization plots saved to results\coco\figures\figures
2025-04-22 11:21:18,160 - tensor_defense - INFO - Experiment coco completed. Results saved to results\coco
2025-04-22 11:21:18,180 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:37,348 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:23:37,348 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:23:37,360 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:23:37,363 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:23:39,262 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:23:39,262 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: validation, max_samples: 100
2025-04-22 11:23:39,262 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:23:39,949 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:23:39,958 - tensor_defense - INFO - Dataset first item keys: ['annotations', 'coco_url', 'date_captured', 'file_name', 'flickr_url', 'height', 'image', 'image_id', 'license', 'license_id', 'width']
2025-04-22 11:23:39,959 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:23:39,959 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:23:39,959 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:23:39,959 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:23:39,959 - tensor_defense - INFO - Processing batches...
2025-04-22 11:23:45,246 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:23:47,354 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:23:47,747 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:23:48,148 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:23:48,547 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:23:48,962 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:23:48,962 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:23:49,081 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:49,081 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:49,081 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:49,317 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:49,318 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:23:49,318 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:23:49,318 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:49,318 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:49,491 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:49,491 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:23:49,491 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:23:49,491 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:49,492 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:49,655 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:49,655 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:49,655 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:49,655 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:49,656 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:49,964 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:49,964 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:49,964 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:49,965 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:23:49,965 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,149 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,149 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:50,150 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:50,150 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:23:50,150 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,334 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,334 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:50,334 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:50,335 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:23:50,335 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,481 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,481 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:50,482 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:50,482 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:23:50,482 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,700 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:50,700 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:50,701 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:50,701 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:50,701 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:23:50,701 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:23:50,701 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:50,702 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:23:50,702 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:51,035 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:51,035 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:51,035 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:51,035 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:51,035 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:51,085 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:23:52,361 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:52,361 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:52,362 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:52,362 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:52,542 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:52,542 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:23:52,542 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:23:52,542 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:52,543 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:52,719 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:52,720 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:23:52,720 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:23:52,720 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:52,720 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:52,873 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:52,874 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:52,874 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:52,874 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:52,874 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,154 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,155 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:53,155 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:53,155 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:23:53,155 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,335 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,335 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:53,335 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:53,336 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:23:53,336 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,508 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,508 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:53,508 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:53,509 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:23:53,509 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,640 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,641 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:53,641 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:53,641 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:23:53,641 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,839 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:53,839 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:53,839 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:53,839 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:53,839 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:23:53,840 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:23:53,840 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:53,840 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:23:53,840 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:54,163 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:54,163 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:54,164 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:54,164 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:54,164 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:54,211 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:23:55,386 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:55,386 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:55,386 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:55,386 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:55,565 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:55,565 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:23:55,565 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:23:55,565 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:55,565 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:55,748 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:55,748 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:23:55,748 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:23:55,749 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:55,749 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:55,900 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:55,900 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:55,900 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:55,900 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:55,901 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,185 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:56,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:56,186 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:23:56,186 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,370 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,370 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:56,370 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:56,370 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:23:56,370 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,550 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,550 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:56,550 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:56,550 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:23:56,551 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,680 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,680 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:56,680 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:56,681 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:23:56,681 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,884 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:56,884 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:56,884 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:56,885 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:56,885 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:23:56,885 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:23:56,885 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:56,885 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:23:56,885 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,211 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,212 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,212 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,212 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:57,212 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,229 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:23:57,635 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:57,635 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:57,635 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:57,635 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:57,784 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,785 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:23:57,785 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:23:57,785 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:57,785 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,855 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:57,855 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:23:57,855 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:23:57,855 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:57,855 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,006 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,006 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:58,006 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:58,007 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:58,007 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,083 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,083 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:58,083 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:58,083 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:23:58,084 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,238 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,238 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:58,239 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:58,239 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:23:58,239 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,394 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,394 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:58,394 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:58,394 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:23:58,394 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,535 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,535 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:58,535 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:58,535 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:23:58,535 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,708 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:58,708 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:23:58,709 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:23:58,709 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:58,709 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:23:58,709 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:23:58,709 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:23:58,709 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:23:58,710 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:59,002 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:59,002 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:59,003 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:59,003 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:23:59,003 - tensor_defense - INFO - All hooks removed
2025-04-22 11:23:59,930 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:23:59,931 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:23:59,931 - tensor_defense - INFO - 
clean:
2025-04-22 11:23:59,931 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,931 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,931 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,931 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:23:59,931 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,932 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,932 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,932 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,932 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,933 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,933 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,933 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,934 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,934 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,934 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,934 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,935 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,935 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:23:59,935 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:23:59,935 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:23:59,935 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:23:59,935 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:24:02,496 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:24:02,496 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:24:02,502 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:24:02,519 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:20,119 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:25:20,119 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:25:20,131 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:25:20,134 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:25:22,620 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:25:22,620 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: validation, max_samples: 100
2025-04-22 11:25:22,620 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:25:23,318 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:25:23,318 - tensor_defense - INFO - Dataset type: <class 'datasets.dataset_dict.DatasetDict'>
2025-04-22 11:25:23,318 - tensor_defense - INFO - Dataset string representation: DatasetDict({
    train: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 82783
    })
    validation: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 40504
    })
})
2025-04-22 11:25:23,318 - tensor_defense - INFO - Is COCO dataset: False
2025-04-22 11:25:23,328 - tensor_defense - INFO - Dataset first item keys: ['annotations', 'coco_url', 'date_captured', 'file_name', 'flickr_url', 'height', 'image', 'image_id', 'license', 'license_id', 'width']
2025-04-22 11:25:23,328 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:25:23,328 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:25:23,328 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:25:23,329 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:25:23,329 - tensor_defense - INFO - Processing batches...
2025-04-22 11:25:28,461 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:25:30,464 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:25:30,873 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:25:31,259 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:25:31,654 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:25:32,045 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:25:32,046 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:25:32,158 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:32,158 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:32,158 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:32,392 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:32,392 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:25:32,393 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:25:32,393 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:32,393 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:32,567 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:32,568 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:25:32,568 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:25:32,568 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:32,568 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:32,729 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:32,729 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:32,730 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:32,730 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:32,730 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,024 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,025 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:33,025 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:33,025 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:25:33,025 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,206 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,206 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:33,206 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:33,207 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:25:33,207 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,387 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,387 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:33,388 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:33,388 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:25:33,388 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,539 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,539 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:33,540 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:33,540 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:25:33,540 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,746 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:33,746 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:33,747 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:33,747 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:33,747 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:25:33,747 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:25:33,747 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:33,747 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:25:33,748 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:34,065 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:34,065 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:34,066 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:34,066 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:34,066 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:34,124 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:25:35,286 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:35,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:35,287 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:35,287 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:35,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:35,450 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:25:35,450 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:25:35,450 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:35,451 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:35,626 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:35,626 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:25:35,627 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:25:35,627 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:35,627 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:35,785 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:35,786 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:35,786 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:35,786 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:35,786 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,060 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,061 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:36,061 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:36,061 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:25:36,061 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,234 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,234 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:36,234 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:36,235 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:25:36,235 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,418 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,418 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:36,418 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:36,418 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:25:36,419 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,560 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,561 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:36,561 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:36,561 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:25:36,561 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,758 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:36,758 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:36,759 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:36,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:36,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:25:36,759 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:25:36,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:36,759 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:25:36,759 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:37,072 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:37,072 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:37,072 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:37,072 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:37,072 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:37,114 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:25:38,273 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:38,273 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:38,273 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:38,273 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:38,455 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:38,455 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:25:38,455 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:25:38,456 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:38,456 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:38,623 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:38,623 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:25:38,623 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:25:38,623 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:38,623 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:38,784 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:38,784 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:38,784 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:38,784 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:38,784 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,074 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,074 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:39,075 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:39,075 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:25:39,075 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,251 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,251 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:39,252 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:39,252 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:25:39,252 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,426 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,427 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:39,427 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:39,427 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:25:39,427 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,559 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,560 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:39,560 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:39,560 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:25:39,560 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,759 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:39,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:39,759 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:39,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:39,760 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:25:39,760 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:25:39,760 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:39,760 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:25:39,760 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,081 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,081 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,082 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,082 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:40,082 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,096 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:25:40,519 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:40,519 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:40,519 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:40,519 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:40,675 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,676 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:25:40,676 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:25:40,676 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:40,676 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,756 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,756 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:25:40,756 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:25:40,756 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:40,756 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,908 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,908 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:40,908 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:40,908 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:40,908 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,986 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:40,986 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:40,986 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:40,987 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:25:40,987 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,139 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,139 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:41,139 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:41,139 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:25:41,139 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,285 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,285 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:41,286 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:41,286 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:25:41,286 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,426 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,426 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:41,427 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:41,427 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:25:41,427 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,583 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:25:41,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:25:41,584 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:41,584 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:25:41,584 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:25:41,584 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:25:41,584 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:25:41,584 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,877 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,877 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,878 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:41,878 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:25:41,878 - tensor_defense - INFO - All hooks removed
2025-04-22 11:25:42,798 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:25:42,798 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:25:42,798 - tensor_defense - INFO - 
clean:
2025-04-22 11:25:42,798 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,798 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,798 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,799 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,799 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,799 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,799 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,800 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,800 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,800 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,800 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:25:42,800 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,801 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,801 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,801 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:25:42,801 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:25:42,801 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:25:45,382 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:25:45,382 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:25:45,389 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:25:45,406 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:36,289 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:27:36,289 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:27:36,300 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:27:36,303 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:27:37,953 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:27:37,954 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: validation, max_samples: 100
2025-04-22 11:27:37,954 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:27:38,609 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:27:38,609 - tensor_defense - INFO - Dataset type: <class 'datasets.dataset_dict.DatasetDict'>
2025-04-22 11:27:38,609 - tensor_defense - INFO - Dataset string representation: DatasetDict({
    train: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 82783
    })
    validation: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 40504
    })
})
2025-04-22 11:27:38,609 - tensor_defense - INFO - Is COCO dataset: False
2025-04-22 11:27:38,611 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:27:38,611 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:27:38,611 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:27:38,611 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:27:38,611 - tensor_defense - INFO - Processing batches...
2025-04-22 11:27:43,736 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:27:45,695 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:27:46,112 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:27:46,537 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:27:46,947 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:27:47,376 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:27:47,377 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:27:47,494 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:47,494 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:47,495 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:47,718 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:47,718 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:27:47,718 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:27:47,718 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:47,718 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:47,881 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:47,881 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:27:47,881 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:27:47,881 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:47,882 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,018 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,019 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:48,019 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:48,019 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:48,019 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,310 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,311 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:48,311 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:48,311 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:27:48,311 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,480 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,480 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:48,481 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:48,481 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:27:48,481 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,642 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,642 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:48,642 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:48,643 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:27:48,643 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,784 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,785 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:48,785 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:48,785 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:27:48,785 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,977 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:48,977 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:48,977 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:48,978 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:48,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:27:48,978 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:27:48,978 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:48,978 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:27:48,978 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:49,288 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:49,288 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:49,289 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:49,289 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:49,289 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:49,341 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:27:50,488 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:50,489 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:50,489 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:50,489 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:50,653 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:50,654 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:27:50,654 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:27:50,654 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:50,654 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:50,829 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:50,829 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:27:50,829 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:27:50,829 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:50,830 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:50,988 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:50,989 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:50,989 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:50,989 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:50,989 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,281 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,282 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:51,282 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:51,282 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:27:51,282 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,464 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,464 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:51,464 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:51,464 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:27:51,464 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,642 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,643 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:51,643 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:51,643 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:27:51,643 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,765 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,766 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:51,766 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:51,766 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:27:51,766 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,959 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:51,959 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:51,959 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:51,959 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:51,959 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:27:51,960 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:27:51,960 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:51,960 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:27:51,960 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:52,268 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:52,269 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:52,269 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:52,269 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:52,269 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:52,307 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:27:53,478 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:53,478 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:53,478 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:53,478 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:53,649 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:53,649 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:27:53,649 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:27:53,649 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:53,649 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:53,810 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:53,811 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:27:53,811 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:27:53,811 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:53,811 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:53,973 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:53,973 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:53,973 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:53,974 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:53,974 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,246 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,247 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:54,247 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:54,247 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:27:54,247 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,418 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,418 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:54,419 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:54,419 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:27:54,419 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,589 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:54,590 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:54,590 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:27:54,590 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,727 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,727 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:54,727 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:54,727 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:27:54,727 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,921 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:54,921 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:54,921 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:54,921 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:54,922 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:27:54,922 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:27:54,922 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:54,922 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:27:54,922 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,237 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,238 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,238 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,238 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:55,238 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,256 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:27:55,663 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:55,664 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:55,664 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:55,664 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:55,823 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:27:55,824 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:27:55,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:55,824 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,893 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:55,894 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:27:55,894 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:27:55,894 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:55,894 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,045 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:56,045 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:56,045 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:56,046 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,129 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,129 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:56,129 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:56,129 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:27:56,129 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,278 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,278 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:56,278 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:56,278 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:27:56,279 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,431 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,431 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:56,431 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:56,432 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:27:56,432 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,567 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,567 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:56,567 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:56,567 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:27:56,568 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,732 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:56,733 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:27:56,733 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:27:56,733 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:56,733 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:27:56,733 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:27:56,734 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:27:56,734 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:27:56,734 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:57,019 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:57,020 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:57,020 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:57,020 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:27:57,020 - tensor_defense - INFO - All hooks removed
2025-04-22 11:27:57,948 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:27:57,948 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:27:57,948 - tensor_defense - INFO - 
clean:
2025-04-22 11:27:57,948 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,948 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,948 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,948 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:27:57,949 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,949 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,949 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,949 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:27:57,949 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,949 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,949 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,949 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:27:57,950 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,950 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,950 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,950 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:27:57,950 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,950 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,950 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,951 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:27:57,951 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,951 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,951 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,951 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:27:57,951 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,951 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,951 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,951 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,952 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,952 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,952 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,953 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:27:57,953 - tensor_defense - INFO -   Recall@1: 0.0859
2025-04-22 11:27:57,953 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:27:57,953 - tensor_defense - INFO -   Recall@10: 0.2344
2025-04-22 11:27:57,953 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:28:00,407 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:28:00,408 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:28:00,414 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:28:00,430 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:08,701 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:30:08,701 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:30:08,712 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:30:08,715 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:30:10,300 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:30:10,301 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: validation, max_samples: 100
2025-04-22 11:30:10,301 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:30:10,970 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:30:10,970 - tensor_defense - INFO - Dataset type: <class 'datasets.dataset_dict.DatasetDict'>
2025-04-22 11:30:10,970 - tensor_defense - INFO - Dataset string representation: DatasetDict({
    train: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 82783
    })
    validation: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 40504
    })
})
2025-04-22 11:30:10,970 - tensor_defense - INFO - Is COCO dataset: True
2025-04-22 11:30:11,170 - tensor_defense - INFO - Created 501 image-caption pairs from 100 images
2025-04-22 11:30:11,170 - tensor_defense - INFO - Initialized dataset with 501 samples
2025-04-22 11:30:11,170 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:30:11,170 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:30:11,170 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:30:11,170 - tensor_defense - INFO - Processing batches...
2025-04-22 11:30:30,395 - tensor_defense - INFO - Processing batch 1/16
2025-04-22 11:30:32,687 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:30:33,155 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:30:33,616 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:30:34,087 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:30:34,561 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:30:34,562 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:30:34,697 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:34,697 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:34,697 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:34,948 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:34,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:34,948 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:34,949 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:34,949 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,124 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,124 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:35,124 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:35,124 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:35,125 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,296 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,297 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:35,297 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:35,297 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:35,297 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,585 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,586 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:35,586 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:35,586 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:35,586 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,765 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,765 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:35,765 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:35,765 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:35,766 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,939 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:35,939 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:35,940 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:35,940 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:35,940 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,108 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,108 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:36,109 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:36,109 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:36,109 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,301 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,301 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:36,302 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:36,302 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:36,302 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:36,302 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:36,302 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:36,302 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:36,303 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,624 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,625 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,625 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,625 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:36,625 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:36,647 - tensor_defense - INFO - Processing batch 2/16
2025-04-22 11:30:37,889 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:37,889 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:37,889 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:37,889 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:38,061 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,061 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:38,061 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:38,062 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:38,062 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,231 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,232 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:38,232 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:38,232 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:38,232 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,402 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,403 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:38,403 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:38,403 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:38,403 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,677 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,677 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:38,677 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:38,677 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:38,677 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,851 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:38,852 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:38,852 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:38,852 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:38,852 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,031 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,031 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:39,031 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:39,032 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:39,032 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,200 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:39,200 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:39,200 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:39,201 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,399 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,399 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:39,399 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:39,399 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:39,399 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:39,400 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:39,400 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:39,400 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:39,400 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,729 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,729 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,730 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,730 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:39,730 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:39,747 - tensor_defense - INFO - Processing batch 3/16
2025-04-22 11:30:41,040 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:41,040 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:41,040 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:41,041 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:41,211 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,212 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:41,212 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:41,212 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:41,212 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,388 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,388 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:41,388 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:41,388 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:41,389 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,554 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,554 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:41,555 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:41,555 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:41,555 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,826 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,826 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:41,826 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:41,826 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:41,827 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,998 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:41,998 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:41,998 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:41,999 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:41,999 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,170 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,170 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:42,170 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:42,171 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:42,171 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,331 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,331 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:42,331 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:42,332 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:42,332 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,528 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:42,529 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:42,529 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:42,529 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:42,529 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:42,529 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:42,530 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:42,530 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,842 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,843 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,843 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,843 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:42,843 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:42,888 - tensor_defense - INFO - Processing batch 4/16
2025-04-22 11:30:44,123 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:44,124 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:44,124 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:44,124 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:44,307 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:44,307 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:44,307 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:44,308 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:44,308 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:44,480 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:44,480 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:44,480 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:44,480 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:44,480 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:44,661 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:44,662 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:44,662 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:44,662 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:44,662 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:44,955 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:44,955 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:44,955 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:44,955 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:44,955 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,133 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,133 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:45,133 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:45,134 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:45,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,314 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,314 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:45,314 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:45,314 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:45,314 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,480 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,480 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:45,480 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:45,480 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:45,480 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,684 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:45,684 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:45,685 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:45,685 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:45,685 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:45,685 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:45,685 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:45,685 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:45,685 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:46,001 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:46,002 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:46,002 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:46,002 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:46,002 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:46,083 - tensor_defense - INFO - Processing batch 5/16
2025-04-22 11:30:47,421 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:47,422 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:47,422 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:47,422 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:47,599 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:47,599 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:47,599 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:47,600 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:47,600 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:47,770 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:47,770 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:47,770 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:47,770 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:47,770 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:47,947 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:47,948 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:47,948 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:47,948 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:47,948 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,228 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,228 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:48,228 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:48,228 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:48,229 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,399 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,400 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:48,400 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:48,400 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:48,400 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,573 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,574 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:48,574 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:48,574 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:48,574 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,739 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,739 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:48,739 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:48,739 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:48,740 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,938 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:48,938 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:48,938 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:48,939 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:48,939 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:48,939 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:48,939 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:48,939 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:48,939 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:49,271 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:49,271 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:49,271 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:49,271 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:49,271 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:49,317 - tensor_defense - INFO - Processing batch 6/16
2025-04-22 11:30:50,591 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:50,592 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:50,592 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:50,592 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:50,764 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:50,764 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:50,764 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:50,765 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:50,765 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:50,960 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:50,960 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:50,961 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:50,961 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:50,961 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,137 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,137 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:51,137 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:51,138 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:51,138 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,419 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,419 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:51,419 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:51,419 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:51,420 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,601 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,601 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:51,601 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:51,602 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:51,602 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,774 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,774 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:51,774 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:51,774 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:51,775 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,944 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:51,944 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:51,944 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:51,944 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:51,944 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:52,140 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:52,140 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:52,140 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:52,140 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:52,141 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:52,141 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:52,141 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:52,141 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:52,141 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:52,449 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:52,449 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:52,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:52,450 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:52,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:52,466 - tensor_defense - INFO - Processing batch 7/16
2025-04-22 11:30:53,792 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:53,792 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:53,793 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:53,793 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:53,963 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:53,963 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:53,963 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:53,964 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:53,964 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,133 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,133 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:54,134 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:54,134 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:54,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,312 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,313 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:54,313 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:54,313 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:54,313 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,612 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,612 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:54,612 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:54,612 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:54,612 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,796 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,797 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:54,797 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:54,797 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:54,797 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,977 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:54,977 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:54,977 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:54,977 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:54,977 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,138 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,138 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:55,138 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:55,138 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:55,139 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,344 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,345 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:55,345 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:55,345 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:55,346 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:55,346 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:55,346 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:55,346 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:55,346 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,662 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,663 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,663 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,663 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:55,663 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:55,707 - tensor_defense - INFO - Processing batch 8/16
2025-04-22 11:30:57,024 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:57,024 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:57,025 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:57,025 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:57,216 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:57,217 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:30:57,217 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:30:57,217 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:57,217 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:57,375 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:57,375 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:30:57,375 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:30:57,375 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:57,376 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:57,552 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:57,552 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:57,552 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:57,552 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:57,552 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:57,834 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:57,834 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:57,834 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:57,834 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:30:57,835 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,016 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,016 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:58,016 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:58,017 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:30:58,017 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,186 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,186 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:58,186 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:58,186 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:30:58,186 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,354 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:58,355 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:58,355 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:30:58,355 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,556 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,556 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:30:58,557 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:30:58,557 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:58,557 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:30:58,557 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:30:58,557 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:30:58,557 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:30:58,557 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,875 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,875 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,875 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,876 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:30:58,876 - tensor_defense - INFO - All hooks removed
2025-04-22 11:30:58,949 - tensor_defense - INFO - Processing batch 9/16
2025-04-22 11:31:00,328 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:00,329 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:00,329 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:00,329 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:00,519 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:00,519 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:00,519 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:00,519 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:00,520 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:00,698 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:00,698 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:00,699 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:00,699 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:00,699 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:00,870 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:00,870 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:00,870 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:00,870 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:00,870 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,152 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,153 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:01,153 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:01,153 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:01,153 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,322 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,322 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:01,322 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:01,323 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:01,323 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,496 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,496 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:01,496 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:01,497 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:01,497 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,644 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,645 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:01,645 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:01,645 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:01,645 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,845 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:01,845 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:01,846 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:01,846 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:01,846 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:01,846 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:01,846 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:01,846 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:01,847 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:02,168 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:02,168 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:02,168 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:02,168 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:02,169 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:02,222 - tensor_defense - INFO - Processing batch 10/16
2025-04-22 11:31:03,537 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:03,537 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:03,538 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:03,538 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:03,723 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:03,723 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:03,723 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:03,724 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:03,724 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:03,893 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:03,893 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:03,893 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:03,894 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:03,894 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,070 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,071 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:04,071 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:04,071 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:04,071 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,356 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,356 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:04,356 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:04,356 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:04,356 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,540 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,541 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:04,541 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:04,541 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:04,541 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,733 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,734 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:04,734 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:04,734 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:04,734 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,906 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:04,907 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:04,907 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:04,907 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:04,907 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:05,112 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:05,113 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:05,113 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:05,113 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:05,113 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:05,113 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:05,113 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:05,114 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:05,114 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:05,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:05,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:05,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:05,450 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:05,450 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:05,472 - tensor_defense - INFO - Processing batch 11/16
2025-04-22 11:31:06,809 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:06,809 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:06,809 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:06,809 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:06,994 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:06,995 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:06,995 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:06,995 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:06,995 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,166 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,167 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:07,167 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:07,167 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:07,167 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,338 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,338 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:07,339 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:07,339 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:07,339 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,621 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,621 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:07,622 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:07,622 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:07,622 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,788 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,788 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:07,788 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:07,788 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:07,788 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,977 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:07,978 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:07,978 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:07,978 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:07,978 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,157 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,158 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:08,158 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:08,158 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:08,158 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,367 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,367 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:08,367 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:08,367 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:08,367 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:08,368 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:08,368 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:08,368 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:08,368 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,698 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,698 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,698 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,698 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:08,699 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:08,735 - tensor_defense - INFO - Processing batch 12/16
2025-04-22 11:31:10,145 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:10,146 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:10,146 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:10,146 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:10,346 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:10,347 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:10,347 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:10,347 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:10,347 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:10,527 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:10,528 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:10,528 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:10,528 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:10,528 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:10,702 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:10,702 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:10,703 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:10,703 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:10,703 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:10,993 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:10,993 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:10,993 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:10,994 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:10,994 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,170 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,170 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:11,171 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:11,171 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:11,171 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,355 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,355 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:11,355 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:11,356 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:11,356 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,511 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,512 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:11,512 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:11,512 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:11,512 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,712 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:11,713 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:11,713 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:11,713 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:11,713 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:11,714 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:11,714 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:11,714 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:11,714 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:12,040 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:12,041 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:12,041 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:12,041 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:12,041 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:12,094 - tensor_defense - INFO - Processing batch 13/16
2025-04-22 11:31:13,411 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:13,411 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:13,411 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:13,411 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:13,608 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:13,608 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:13,609 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:13,609 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:13,609 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:13,789 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:13,790 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:13,790 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:13,790 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:13,790 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:13,961 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:13,961 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:13,961 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:13,962 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:13,962 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,245 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,246 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:14,246 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:14,246 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:14,246 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,428 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,428 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:14,429 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:14,429 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:14,429 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,609 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,609 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:14,609 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:14,610 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:14,610 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,790 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:14,790 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:14,791 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:14,791 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:14,791 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:15,003 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:15,003 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:15,003 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:15,004 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:15,004 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:15,004 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:15,004 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:15,004 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:15,004 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:15,332 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:15,333 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:15,333 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:15,333 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:15,333 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:15,368 - tensor_defense - INFO - Processing batch 14/16
2025-04-22 11:31:16,767 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:16,767 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:16,767 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:16,767 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:16,954 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:16,954 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:16,954 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:16,955 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:16,955 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,132 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,132 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:17,132 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:17,132 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:17,132 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,308 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,308 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:17,308 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:17,309 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:17,309 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,594 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,594 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:17,594 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:17,594 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:17,594 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,770 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,770 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:17,770 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:17,771 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:17,771 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,947 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:17,947 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:17,948 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:17,948 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:17,948 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,122 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,122 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:18,122 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:18,122 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:18,122 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,323 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,323 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:18,324 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:18,324 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:18,324 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:18,324 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:18,324 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:18,324 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:18,324 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,642 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,642 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,643 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,643 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:18,643 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:18,659 - tensor_defense - INFO - Processing batch 15/16
2025-04-22 11:31:20,012 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:20,012 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:20,012 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:20,013 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:20,208 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:20,209 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:20,209 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:20,209 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:20,209 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:20,380 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:20,381 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:20,381 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:20,381 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:20,381 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:20,567 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:20,567 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:20,567 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:20,567 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:20,568 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:20,865 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:20,865 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:20,865 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:20,865 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:20,866 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,045 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,045 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:21,045 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:21,046 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:21,046 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,228 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,229 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:21,229 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:21,229 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:21,229 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,402 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,403 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:21,403 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:21,403 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:21,403 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,612 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,612 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:21,612 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:21,612 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:21,613 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:21,613 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:21,613 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:21,613 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:21,613 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,934 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,935 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,935 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,935 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:21,935 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:21,975 - tensor_defense - INFO - Processing batch 16/16
2025-04-22 11:31:22,963 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:22,963 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:22,963 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:22,963 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:23,141 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,141 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:31:23,141 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:31:23,141 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:23,142 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,309 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,310 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:31:23,310 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:31:23,310 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:23,310 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,482 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,482 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:23,482 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:23,483 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:23,483 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,758 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,759 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:23,759 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:23,759 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:31:23,759 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,930 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:23,930 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:23,930 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:23,930 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:31:23,930 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,094 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,094 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:24,095 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:24,095 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:31:24,095 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,247 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,247 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:24,247 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:24,248 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:31:24,248 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,443 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,443 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:31:24,443 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:31:24,443 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:24,443 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:31:24,444 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:31:24,444 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:31:24,444 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:31:24,444 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,755 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,755 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,755 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:24,755 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:31:24,756 - tensor_defense - INFO - All hooks removed
2025-04-22 11:31:25,694 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:31:25,694 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:31:25,695 - tensor_defense - INFO - 
clean:
2025-04-22 11:31:25,695 - tensor_defense - INFO -   Recall@1: 0.1907
2025-04-22 11:31:25,695 - tensor_defense - INFO -   Recall@5: 0.7507
2025-04-22 11:31:25,695 - tensor_defense - INFO -   Recall@10: 0.9141
2025-04-22 11:31:25,695 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:31:25,695 - tensor_defense - INFO -   Recall@1: 0.0098
2025-04-22 11:31:25,695 - tensor_defense - INFO -   Recall@5: 0.0812
2025-04-22 11:31:25,695 - tensor_defense - INFO -   Recall@10: 0.1849
2025-04-22 11:31:25,696 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:31:25,696 - tensor_defense - INFO -   Recall@1: 0.0137
2025-04-22 11:31:25,696 - tensor_defense - INFO -   Recall@5: 0.1096
2025-04-22 11:31:25,696 - tensor_defense - INFO -   Recall@10: 0.2083
2025-04-22 11:31:25,696 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:31:25,696 - tensor_defense - INFO -   Recall@1: 0.0078
2025-04-22 11:31:25,696 - tensor_defense - INFO -   Recall@5: 0.1017
2025-04-22 11:31:25,696 - tensor_defense - INFO -   Recall@10: 0.1927
2025-04-22 11:31:25,697 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:31:25,697 - tensor_defense - INFO -   Recall@1: 0.0117
2025-04-22 11:31:25,697 - tensor_defense - INFO -   Recall@5: 0.0988
2025-04-22 11:31:25,697 - tensor_defense - INFO -   Recall@10: 0.2025
2025-04-22 11:31:25,697 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:31:25,697 - tensor_defense - INFO -   Recall@1: 0.0117
2025-04-22 11:31:25,697 - tensor_defense - INFO -   Recall@5: 0.1076
2025-04-22 11:31:25,697 - tensor_defense - INFO -   Recall@10: 0.1986
2025-04-22 11:31:25,697 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:31:25,697 - tensor_defense - INFO -   Recall@1: 0.0137
2025-04-22 11:31:25,698 - tensor_defense - INFO -   Recall@5: 0.1135
2025-04-22 11:31:25,698 - tensor_defense - INFO -   Recall@10: 0.2172
2025-04-22 11:31:25,698 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:31:25,698 - tensor_defense - INFO -   Recall@1: 0.0117
2025-04-22 11:31:25,698 - tensor_defense - INFO -   Recall@5: 0.1017
2025-04-22 11:31:25,698 - tensor_defense - INFO -   Recall@10: 0.1966
2025-04-22 11:31:25,698 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:31:25,698 - tensor_defense - INFO -   Recall@1: 0.0117
2025-04-22 11:31:25,698 - tensor_defense - INFO -   Recall@5: 0.1115
2025-04-22 11:31:25,699 - tensor_defense - INFO -   Recall@10: 0.2122
2025-04-22 11:31:25,699 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:31:25,699 - tensor_defense - INFO -   Recall@1: 0.0137
2025-04-22 11:31:25,699 - tensor_defense - INFO -   Recall@5: 0.0959
2025-04-22 11:31:25,699 - tensor_defense - INFO -   Recall@10: 0.1966
2025-04-22 11:31:25,699 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:31:25,699 - tensor_defense - INFO -   Recall@1: 0.0206
2025-04-22 11:31:25,699 - tensor_defense - INFO -   Recall@5: 0.1262
2025-04-22 11:31:25,700 - tensor_defense - INFO -   Recall@10: 0.2299
2025-04-22 11:31:25,700 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:31:27,747 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:31:27,747 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:31:27,753 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:31:27,767 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:33:25,976 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:33:25,976 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:33:25,988 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:33:25,992 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:33:27,613 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:33:27,613 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: validation, max_samples: 20
2025-04-22 11:33:27,613 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:33:28,275 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:33:28,275 - tensor_defense - INFO - Dataset type: <class 'datasets.dataset_dict.DatasetDict'>
2025-04-22 11:33:28,275 - tensor_defense - INFO - Dataset string representation: DatasetDict({
    train: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 82783
    })
    validation: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 40504
    })
})
2025-04-22 11:33:28,276 - tensor_defense - INFO - Is COCO dataset: True
2025-04-22 11:33:28,318 - tensor_defense - INFO - Created 20 image-caption pairs from 20 images
2025-04-22 11:33:28,318 - tensor_defense - INFO - Initialized dataset with 20 samples
2025-04-22 11:33:28,319 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:33:28,319 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:33:28,319 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:33:28,319 - tensor_defense - INFO - Processing batches...
2025-04-22 11:33:33,478 - tensor_defense - INFO - Processing batch 1/1
2025-04-22 11:33:35,131 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:33:35,528 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:33:35,929 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:33:36,335 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:33:36,758 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:33:36,759 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:33:36,855 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:33:36,856 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:33:36,856 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:33:37,106 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,107 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:33:37,107 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:33:37,107 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:33:37,107 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,264 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,264 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:33:37,264 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:33:37,264 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:33:37,264 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,426 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,426 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:33:37,426 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:33:37,427 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:33:37,427 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,723 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,723 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:33:37,723 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:33:37,723 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:33:37,723 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,902 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:37,902 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:33:37,902 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:33:37,903 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:33:37,903 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,078 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,079 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:33:38,079 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:33:38,079 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:33:38,079 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,228 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,228 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:33:38,228 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:33:38,228 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:33:38,229 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,442 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,442 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:33:38,442 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:33:38,442 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:33:38,443 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:33:38,443 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:33:38,443 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:33:38,443 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:33:38,443 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,761 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,762 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,762 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:38,762 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:33:38,762 - tensor_defense - INFO - All hooks removed
2025-04-22 11:33:39,705 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:33:39,705 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:33:39,705 - tensor_defense - INFO - 
clean:
2025-04-22 11:33:39,706 - tensor_defense - INFO -   Recall@1: 0.8000
2025-04-22 11:33:39,706 - tensor_defense - INFO -   Recall@5: 0.9000
2025-04-22 11:33:39,706 - tensor_defense - INFO -   Recall@10: 1.0000
2025-04-22 11:33:39,706 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:33:39,706 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,706 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:33:39,706 - tensor_defense - INFO -   Recall@10: 0.1500
2025-04-22 11:33:39,706 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:33:39,707 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,707 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:33:39,707 - tensor_defense - INFO -   Recall@10: 0.2500
2025-04-22 11:33:39,707 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:33:39,707 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,707 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:33:39,707 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:33:39,707 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:33:39,707 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:33:39,708 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:33:39,708 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@10: 0.2500
2025-04-22 11:33:39,708 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:33:39,708 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:33:39,709 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:33:39,709 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:33:39,709 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@1: 0.1000
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:33:39,709 - tensor_defense - INFO -   Recall@10: 0.3000
2025-04-22 11:33:39,709 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:33:41,657 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:33:41,657 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:33:41,664 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:33:41,678 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:34:13,309 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:34:13,310 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:34:13,321 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:34:13,323 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:34:14,930 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:34:14,930 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: validation, max_samples: 20
2025-04-22 11:34:14,930 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:34:15,591 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:34:15,592 - tensor_defense - INFO - Dataset type: <class 'datasets.dataset_dict.DatasetDict'>
2025-04-22 11:34:15,592 - tensor_defense - INFO - Dataset string representation: DatasetDict({
    train: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 82783
    })
    validation: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 40504
    })
})
2025-04-22 11:34:15,592 - tensor_defense - INFO - Is COCO dataset: True
2025-04-22 11:34:15,635 - tensor_defense - INFO - Created 20 image-caption pairs from 20 images
2025-04-22 11:34:15,635 - tensor_defense - INFO - Initialized dataset with 20 samples
2025-04-22 11:34:15,636 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:34:15,636 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:34:15,636 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:34:15,636 - tensor_defense - INFO - Processing batches...
2025-04-22 11:34:20,793 - tensor_defense - INFO - Processing batch 1/1
2025-04-22 11:34:22,476 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:34:22,864 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:34:23,259 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:34:23,660 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:34:24,088 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:34:24,089 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:34:24,193 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:34:24,193 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:34:24,193 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:34:24,433 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:24,433 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:34:24,433 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:34:24,433 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:34:24,433 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:24,588 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:24,589 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:34:24,589 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:34:24,589 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:34:24,589 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:24,763 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:24,764 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:34:24,764 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:34:24,764 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:34:24,764 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,041 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,042 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:34:25,042 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:34:25,042 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:34:25,042 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,216 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,216 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:34:25,216 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:34:25,216 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:34:25,217 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,386 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,386 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:34:25,387 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:34:25,387 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:34:25,387 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,542 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,542 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:34:25,542 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:34:25,542 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:34:25,542 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,729 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:25,729 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:34:25,729 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:34:25,729 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:34:25,729 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:34:25,730 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:34:25,730 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:34:25,730 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:34:25,730 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:26,040 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:26,040 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:26,040 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:26,041 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:34:26,041 - tensor_defense - INFO - All hooks removed
2025-04-22 11:34:26,931 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:34:26,932 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:34:26,932 - tensor_defense - INFO - 
clean:
2025-04-22 11:34:26,932 - tensor_defense - INFO -   Recall@1: 0.8000
2025-04-22 11:34:26,932 - tensor_defense - INFO -   Recall@5: 0.9000
2025-04-22 11:34:26,932 - tensor_defense - INFO -   Recall@10: 1.0000
2025-04-22 11:34:26,932 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@10: 0.1500
2025-04-22 11:34:26,933 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@10: 0.2500
2025-04-22 11:34:26,933 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:34:26,933 - tensor_defense - INFO -   Recall@10: 0.1500
2025-04-22 11:34:26,934 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:34:26,934 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,934 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:34:26,934 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:34:26,934 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:34:26,934 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,934 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:34:26,934 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:34:26,934 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:34:26,934 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,935 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:34:26,935 - tensor_defense - INFO -   Recall@10: 0.2500
2025-04-22 11:34:26,935 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:34:26,935 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,935 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:34:26,935 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:34:26,935 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:34:26,936 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,936 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:34:26,936 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:34:26,936 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:34:26,936 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,937 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:34:26,937 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:34:26,937 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:34:26,937 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:34:26,937 - tensor_defense - INFO -   Recall@5: 0.2000
2025-04-22 11:34:26,937 - tensor_defense - INFO -   Recall@10: 0.3000
2025-04-22 11:34:26,937 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:34:29,533 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:34:29,534 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:34:29,540 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:34:29,555 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:36:17,034 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:36:17,034 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:36:17,046 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:36:17,049 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:36:18,549 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:36:18,549 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: validation, max_samples: 20
2025-04-22 11:36:18,550 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:36:19,222 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:36:19,222 - tensor_defense - INFO - Dataset type: <class 'datasets.dataset_dict.DatasetDict'>
2025-04-22 11:36:19,222 - tensor_defense - INFO - Dataset string representation: DatasetDict({
    train: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 82783
    })
    validation: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 40504
    })
})
2025-04-22 11:36:19,222 - tensor_defense - INFO - Is COCO dataset: True
2025-04-22 11:36:19,265 - tensor_defense - INFO - Created 20 image-caption pairs from 20 images
2025-04-22 11:36:19,265 - tensor_defense - INFO - Initialized dataset with 20 samples
2025-04-22 11:36:19,266 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:36:19,266 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:36:19,266 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:36:19,266 - tensor_defense - INFO - Processing batches...
2025-04-22 11:36:24,358 - tensor_defense - INFO - Processing batch 1/1
2025-04-22 11:36:26,080 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:36:26,507 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:36:26,907 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:36:27,302 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:36:27,719 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:36:27,719 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:36:27,814 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:36:27,815 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:36:27,815 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:36:28,033 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,033 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:36:28,034 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:36:28,034 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:36:28,034 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,203 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,203 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:36:28,203 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:36:28,204 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:36:28,204 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,368 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,368 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:36:28,368 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:36:28,368 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:36:28,369 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,649 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,649 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:36:28,649 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:36:28,649 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:36:28,650 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,819 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,819 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:36:28,820 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:36:28,820 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:36:28,820 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,985 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:28,985 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:36:28,986 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:36:28,986 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:36:28,986 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,147 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,147 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:36:29,148 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:36:29,148 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:36:29,148 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,338 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,338 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:36:29,339 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:36:29,339 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:36:29,339 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:36:29,339 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:36:29,339 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:36:29,339 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:36:29,339 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,656 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,656 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,656 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:29,656 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:36:29,656 - tensor_defense - INFO - All hooks removed
2025-04-22 11:36:30,575 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:36:30,575 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:36:30,575 - tensor_defense - INFO - 
clean:
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@1: 0.8000
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@5: 0.9000
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@10: 1.0000
2025-04-22 11:36:30,576 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@10: 0.1500
2025-04-22 11:36:30,576 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:36:30,576 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:36:30,577 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:36:30,577 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:36:30,577 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:36:30,577 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:36:30,578 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@10: 0.2500
2025-04-22 11:36:30,578 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:36:30,578 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@5: 0.1000
2025-04-22 11:36:30,578 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:36:30,579 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:36:30,579 - tensor_defense - INFO -   Recall@1: 0.0500
2025-04-22 11:36:30,579 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:36:30,579 - tensor_defense - INFO -   Recall@10: 0.2000
2025-04-22 11:36:30,579 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:36:30,579 - tensor_defense - INFO -   Recall@1: 0.1000
2025-04-22 11:36:30,579 - tensor_defense - INFO -   Recall@5: 0.1500
2025-04-22 11:36:30,579 - tensor_defense - INFO -   Recall@10: 0.3000
2025-04-22 11:36:30,580 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:36:32,516 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:36:32,517 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:36:32,523 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:36:32,536 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:20,599 - tensor_defense - INFO - Running experiment: config
2025-04-22 11:38:20,599 - tensor_defense - INFO - Results will be saved to: results\config
2025-04-22 11:38:20,611 - tensor_defense - INFO - Using device: cuda
2025-04-22 11:38:20,614 - tensor_defense - INFO - Loading model: clip vit-base-patch32
2025-04-22 11:38:22,185 - tensor_defense - INFO - Loaded CLIP model: openai/clip-vit-base-patch32
2025-04-22 11:38:22,185 - tensor_defense - INFO - Loading dataset: shunk031/MSCOCO, split: train, max_samples: 100
2025-04-22 11:38:22,186 - tensor_defense - INFO - Loading COCO dataset: year=2014, task=captions
2025-04-22 11:38:22,906 - tensor_defense - INFO - Successfully loaded COCO dataset
2025-04-22 11:38:22,906 - tensor_defense - INFO - Dataset type: <class 'datasets.dataset_dict.DatasetDict'>
2025-04-22 11:38:22,906 - tensor_defense - INFO - Dataset string representation: DatasetDict({
    train: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 82783
    })
    validation: Dataset({
        features: ['image_id', 'image', 'file_name', 'coco_url', 'height', 'width', 'date_captured', 'flickr_url', 'license_id', 'license', 'annotations'],
        num_rows: 40504
    })
})
2025-04-22 11:38:22,906 - tensor_defense - INFO - Is COCO dataset: True
2025-04-22 11:38:23,119 - tensor_defense - INFO - Created 100 image-caption pairs from 100 images
2025-04-22 11:38:23,119 - tensor_defense - INFO - Initialized dataset with 100 samples
2025-04-22 11:38:23,120 - tensor_defense - INFO - Configuring PGD attack: epsilon=0.0313725, steps=10, step_size=0.0235294
2025-04-22 11:38:23,120 - root - INFO - Initialized PGD attack with epsilon=0.0313725, alpha=0.0235294, steps=10
2025-04-22 11:38:23,120 - root - INFO - Random start: True, Targeted: False
2025-04-22 11:38:23,120 - tensor_defense - INFO - Processing batches...
2025-04-22 11:38:42,489 - tensor_defense - INFO - Processing batch 1/4
2025-04-22 11:38:44,582 - tensor_defense - INFO - Saved sample pair 1/5
2025-04-22 11:38:44,978 - tensor_defense - INFO - Saved sample pair 2/5
2025-04-22 11:38:45,384 - tensor_defense - INFO - Saved sample pair 3/5
2025-04-22 11:38:45,775 - tensor_defense - INFO - Saved sample pair 4/5
2025-04-22 11:38:46,172 - tensor_defense - INFO - Saved sample pair 5/5
2025-04-22 11:38:46,173 - tensor_defense - INFO - Saved 5 sample image pairs to results\config\samples
2025-04-22 11:38:46,290 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:46,290 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:46,290 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:46,513 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:46,513 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:38:46,513 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:38:46,513 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:46,513 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:46,686 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:46,686 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:38:46,687 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:38:46,687 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:46,687 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:46,848 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:46,849 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:46,849 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:46,849 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:46,849 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,134 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,134 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:47,134 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:47,134 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:38:47,135 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,306 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,307 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:47,307 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:47,307 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:38:47,307 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,486 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,486 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:47,487 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:47,487 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:38:47,487 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,623 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,623 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:47,623 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:47,624 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:38:47,624 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,823 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:47,823 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:47,823 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:47,823 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:47,824 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:38:47,824 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:38:47,824 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:47,824 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:38:47,824 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:48,141 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:48,141 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:48,141 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:48,141 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:48,141 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:48,198 - tensor_defense - INFO - Processing batch 2/4
2025-04-22 11:38:49,505 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:49,506 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:49,506 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:49,506 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:49,687 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:49,687 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:38:49,688 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:38:49,688 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:49,688 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:49,858 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:49,859 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:38:49,859 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:38:49,859 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:49,859 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,004 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,004 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:50,005 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:50,005 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:50,005 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,286 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,287 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:50,287 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:50,287 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:38:50,287 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,459 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,459 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:50,460 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:50,460 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:38:50,460 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,630 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,630 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:50,630 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:50,631 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:38:50,631 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,758 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,758 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:50,758 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:50,758 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:38:50,758 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,959 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:50,959 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:50,959 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:50,959 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:50,959 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:38:50,959 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:38:50,959 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:50,959 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:38:50,960 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:51,270 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:51,270 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:51,270 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:51,271 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:51,271 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:51,319 - tensor_defense - INFO - Processing batch 3/4
2025-04-22 11:38:52,575 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:52,575 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:52,575 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:52,576 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:52,752 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:52,753 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:38:52,753 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:38:52,753 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:52,753 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:52,922 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:52,922 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:38:52,923 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:38:52,923 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:52,923 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,086 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,086 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:53,086 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:53,087 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:53,087 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,364 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,364 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:53,364 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:53,364 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:38:53,365 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,545 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,545 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:53,546 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:53,546 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:38:53,546 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,725 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,725 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:53,725 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:53,726 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:38:53,726 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,863 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:53,864 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:53,864 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:53,864 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:38:53,864 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,071 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,071 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:54,072 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:54,072 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:54,072 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:38:54,072 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:38:54,072 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:54,073 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:38:54,073 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,404 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,405 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,405 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,405 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:54,405 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,420 - tensor_defense - INFO - Processing batch 4/4
2025-04-22 11:38:54,840 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:54,841 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:54,841 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:54,841 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:54,991 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:54,992 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 attention output
2025-04-22 11:38:54,992 - tensor_defense - INFO - Initialized cp tensor defense on attention (vision layer -1)
2025-04-22 11:38:54,992 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:54,992 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,048 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,049 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 MLP output
2025-04-22 11:38:55,049 - tensor_defense - INFO - Initialized cp tensor defense on mlp (vision layer -1)
2025-04-22 11:38:55,049 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:55,049 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,200 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,200 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:55,200 - tensor_defense - INFO - Initialized tucker tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:55,201 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:55,201 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,288 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,288 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:55,288 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:55,288 - tensor_defense - INFO - Rank: 64, Alpha: 0.3
2025-04-22 11:38:55,289 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,445 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,446 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:55,446 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:55,446 - tensor_defense - INFO - Rank: 64, Alpha: 0.7
2025-04-22 11:38:55,446 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,598 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,598 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:55,598 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:55,598 - tensor_defense - INFO - Rank: 32, Alpha: 0.5
2025-04-22 11:38:55,598 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,742 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,742 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:55,742 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:55,742 - tensor_defense - INFO - Rank: 128, Alpha: 0.5
2025-04-22 11:38:55,742 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,915 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:55,915 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 11 final norm
2025-04-22 11:38:55,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -1)
2025-04-22 11:38:55,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:55,916 - tensor_defense - INFO - Registered hook on CLIP vision encoder layer 10 final norm
2025-04-22 11:38:55,916 - tensor_defense - INFO - Initialized cp tensor defense on final_norm (vision layer -2)
2025-04-22 11:38:55,916 - tensor_defense - INFO - Rank: 64, Alpha: 0.5
2025-04-22 11:38:55,916 - tensor_defense - INFO - Initialized multi-layer defense with 2 layers
2025-04-22 11:38:55,917 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:56,217 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:56,218 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:56,218 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:56,218 - tensor_defense - INFO - All multi-layer defense hooks removed
2025-04-22 11:38:56,218 - tensor_defense - INFO - All hooks removed
2025-04-22 11:38:57,135 - tensor_defense - INFO - 
Defense Evaluation Results:
2025-04-22 11:38:57,135 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:38:57,136 - tensor_defense - INFO - 
clean:
2025-04-22 11:38:57,136 - tensor_defense - INFO -   Recall@1: 0.7266
2025-04-22 11:38:57,136 - tensor_defense - INFO -   Recall@5: 0.6797
2025-04-22 11:38:57,136 - tensor_defense - INFO -   Recall@10: 0.7266
2025-04-22 11:38:57,136 - tensor_defense - INFO - 
adversarial:
2025-04-22 11:38:57,136 - tensor_defense - INFO -   Recall@1: 0.1641
2025-04-22 11:38:57,136 - tensor_defense - INFO -   Recall@5: 0.1016
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@10: 0.1562
2025-04-22 11:38:57,137 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.5):
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@5: 0.1406
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@10: 0.2109
2025-04-22 11:38:57,137 - tensor_defense - INFO - 
CP Attention (R=64, alpha=0.5):
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@5: 0.1172
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@10: 0.1875
2025-04-22 11:38:57,137 - tensor_defense - INFO - 
CP MLP (R=64, alpha=0.5):
2025-04-22 11:38:57,137 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@5: 0.1094
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@10: 0.2109
2025-04-22 11:38:57,138 - tensor_defense - INFO - 
Tucker Final Norm (R=64, alpha=0.5):
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@5: 0.1328
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@10: 0.2266
2025-04-22 11:38:57,138 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.3):
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@5: 0.1562
2025-04-22 11:38:57,138 - tensor_defense - INFO -   Recall@10: 0.2266
2025-04-22 11:38:57,139 - tensor_defense - INFO - 
CP Final Norm (R=64, alpha=0.7):
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@5: 0.1094
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@10: 0.2109
2025-04-22 11:38:57,139 - tensor_defense - INFO - 
CP Final Norm (R=32, alpha=0.5):
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@5: 0.1328
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@10: 0.2109
2025-04-22 11:38:57,139 - tensor_defense - INFO - 
CP Final Norm (R=128, alpha=0.5):
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@5: 0.1250
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@10: 0.2109
2025-04-22 11:38:57,139 - tensor_defense - INFO - 
CP Multi-Layer (2 Layers):
2025-04-22 11:38:57,139 - tensor_defense - INFO -   Recall@1: 0.1797
2025-04-22 11:38:57,140 - tensor_defense - INFO -   Recall@5: 0.1328
2025-04-22 11:38:57,140 - tensor_defense - INFO -   Recall@10: 0.2422
2025-04-22 11:38:57,140 - tensor_defense - INFO - --------------------------------------------------
2025-04-22 11:38:59,071 - tensor_defense - INFO - All paper figures saved to results\config\figures\figures
2025-04-22 11:38:59,071 - tensor_defense - INFO - All visualization plots saved to results\config\figures\figures
2025-04-22 11:38:59,078 - tensor_defense - INFO - Experiment config completed. Results saved to results\config
2025-04-22 11:38:59,093 - tensor_defense - INFO - All multi-layer defense hooks removed
